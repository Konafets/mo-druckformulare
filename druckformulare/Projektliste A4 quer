00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000020Projektliste A4 quer0000041022000004true000004true00000100000010000036Liste der Projekte im Format A4 quer004226'-----------------------------------------------------------------------------------------'' Formular : Liste der Projekte im Format A4 quer' Historie : 27/10/2016: sts Initialversion' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text         = "Liste der Projekte "' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row       as number = 0' Allgemeine Konstantenconst WHITE as color           = RGBColor(255,255,255)const MAX_POS_HEIGHT as number = 2000' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 6 Spaltendim anzahlSpalten as number = 6dim s1 as number = 0                ' Anfang Spalte Projektnummerdim s2 as number = 300              ' Anfang Spalte Bezeichnungdim s3 as number = 1600             ' Anfang Spalte DatumStartdim s4 as number = 1800             ' Anfang Spalte DatumEndedim s5 as number = 2000             ' Anfang Spalte Statusdim s6 as number = 2250             ' Anfang Spalte Bearbeiterdim s7 as number = LAYOUTWIDTH#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(PROJEKT_Filter, 0, 150, LAYOUTWIDTH, 100)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Projektliste''-----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Projektliste")DrawLine(s1, 0, s7, 0)DrawVerticalLine(s1)DrawText("Nummer", l1, 5, b1, 40)DrawVerticalLine(s2)DrawText("Bezeichnung/Beschreibung", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("Startdatum", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Enddatum", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Status", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Bearbeiter", l6, 5, b6, 40)DrawVerticalLine(s7)'-----------------------------------------------------------------------------------------#BeginTableRowSetArea(MAX_POS_HEIGHT, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s7, 0)DrawVerticalLine(s1)DrawText(PROJEKT_Nummer, l1, 5, b1, 40)DrawVerticalLine(s2)SetTextBold(TRUE)DrawText(PROJEKT_Bezeichnung, l2, 5, b2, 40)SetTextBold(FALSE)DrawText(PROJEKT_Beschreibung, l2, AREA_CURRENTHEIGHT + 10, b2, MAX_POS_HEIGHT - 50)DrawVerticalLine(s3)DrawText(IfThen(GetPlatform = 1, MediumDate(PROJEKT_DatumStart), ShortDate(PROJEKT_DatumStart)), l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)if ( DateToNumber(PROJEKT_DatumEnde) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(PROJEKT_DatumEnde), ShortDate(PROJEKT_DatumEnde)), l4, 5, b4, 40, ALIGN_CENTER)endifDrawVerticalLine(s5)DrawText(PROJEKT_Status, l5, 5, b5, 40)DrawVerticalLine(s6)DrawText(PROJEKT_Bearbeiter, l6, 5, b6, 40)DrawVerticalLine(s7)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s7, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s7, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Projektliste'' -----------------------------------------------------------------------------------------0000012