00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000033Bestellformular universal A4 hoch0000041014000004true000004true00000100000010000135Bestellformular universal, A4 hoch (Anfrage, Bestellung, Wareneingang, Eingangsrechnung, Lieferantengutschrift, Rücksendung und Storno)033406' -----------------------------------------------------------------------------------------'' Formular : Bestellformular universal A4 hoch'' Historie' 14/01/2011: sts Initialversion' 08/03/2012: sts (Ausgabe ohne Positionen möglich, wahlweise Ausgabe Herstellernr statt Artikelnr)' 10/05/2012: sts (Ausgabe Lierung-Nr statt Auftragsnummer im Infoblock)' 29/05/2012: sts (Ausgabe abweichende Lieferanschrift unterhalb der Positionstabelle, Steuersatz mit Nachkommastellen runden)' 30/05/2012: sts (Steuersatz mit Nachkommastellen runden, Konstante für Ausgabeform Druck oder Email)' 25/09/2013: sts (Ausgabe Übertrag auf Folgeseite, Ausgabe Steuersatz mit Nachkommastellen in Spalte Steuer,'                  Neue Auftragsart: Proformarechnung, Storno, Korrekturrechnung)' 18/09/2014: sts (Ausgabe der steuerfreien Nettobeträge)' 04/12/2014: sts (Ausgabe der Artikelbilder, wird über die Konstante "ARTIKEL_BILDER" gesteuert)' 10/02/2015: sts (Anpassung der Ausgabebreite für die Artikelbeschreibung bei Ausgabe ohne Artikelbilder)' 05/02/2016: sts (Ausgabehöhe bei Platzhalter nach den Positionen korrigiert)' 12/02/2016: sts (Ausgabe Zahlungsbedingung bei Gutschrift)' 02/03/2016: sts (Ausgabe Artikelbild: Bildposition bei Artikeln ohne Beschreibung)' 22/07/2016: sts (Konstante FOOTER_HEIGHT geändert, Ausgabe Artikelbilder immer rechtsbündig)' 21/12/2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich, Steuerausweis fehlt bei Lieferantengutschrift)' 17/08/2017: sts (Anzeige Nachkommastellen für Einzelpreis laut REWE-Vorgaben, Bezeichnung Variable für Nachkommastellen der Menge geändert)' 18/05/2018: sts (Optionale Konstante zum Ausblenden der Gesamtnetto- und Gesamtsteuerzeile bei steuerfreien Bestellungen' 18/05/2018: sts (Optionale Konstante zum Ausblenden der Steuerbereiche für die Ausgabe einer Kleinunternehmer-Bestellung)' 12/11/2019: sts (Infoblock: Ausgabe Externe Nummer des Lieferanten)' 12/11/2019: sts (Standardwert TRUE für Konstante zum Ausblenden der Gesamtnetto- und Gesamtsteuerzeile bei steuerfreien Aufträgen)' 26/11/2019: sts (Ausgabe der Anrede nur wenn auch ein Kopftext enthalten ist)' 03/03/2020: sts (Spalte 'Ust' nur bei umsatzsteuerpflicht anzeigen)' 10/03/2020: sts (Ausgabe Sendungsnummer und Lieferart)'' -----------------------------------------------------------------------------------------#BeginDocumentSetDocument(150, 150, 100, 100) ' Seitenränder definieren' Konstanten definieren' Allgemeine Konstantenconst HEADER1_HEIGHT   as number = 360const HEADER2_HEIGHT   as number = 360const FOOTER_HEIGHT    as number = 250const BLACK            as color  = RGBColor(0,0,0)const WHITE            as color  = RGBColor(255,255,255)const LAYOUTLEFT       as number = 100const LAYOUTWIDTH      as number = 1700const MAX_POS_HEIGHT   as number = 2000const FORMATBETRAGNULL as text   = "-#,0.00"const FORMATEPNULL     as text   = "-#,0." + Left("0000", Firma_EinkaufNKEP)const FORMATBETRAGLEER as text   = "#,0.00;-#,0.00;"const FORMATEPLEER     as text   = "#,0." + Left("0000", Firma_EinkaufNKEP) + ";-#,0." + Left("0000", Firma_EinkaufNKEP) + ";"const FORMATBETRAGGANZ as text   = "#,0;-#,0;"const FORMATKILONULL   as text   = "-#,0.000"const FORMATKILOLEER   as text   = "#,0.000;-#,0.000;"const SEP              as text   = " • "' Auftragsartenconst BESTELLART_ANFRAGE        as number = 101const BESTELLART_BESTELLUNG     as number = 102const BESTELLART_WARENEINGANG   as number = 103const BESTELLART_RECHNUNG       as number = 104const BESTELLART_GUTSCHRIFT     as number = 105const BESTELLART_RUECKSENDUNG   as number = 106const BESTELLART_STORNO         as number = 107' Positionsartenconst AUFTRPOS_STAMMARTIKEL       as number = 1const AUFTRPOS_MANUELLARTIKEL     as number = 2const AUFTRPOS_TEXTPOSITION       as number = 3const AUFTRPOS_ZWISCHENSUMME      as number = 4const AUFTRPOS_SEITENUMBRUCH      as number = 5const AUFTRPOS_KOMMENTAR          as number = 6const AUFTRPOS_STAMMARTIKEL_ALT   as number = 7const AUFTRPOS_MANUELLARTIKEL_ALT as number = 8' Ausgabeartenconst AUSGABE_DRUCK               as number = 0const AUSGABE_EMAIL               as number = 1' ********************************************************************************' Über die folgenden Konstanten lässt sich die Darstellung in der Positionstabelle' anpassen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const LINIEN_HORIZONTAL     as boolean = TRUEconst LINIEN_VERTIKAL       as boolean = TRUEconst ARTIKEL_NR            as boolean = TRUEconst HERSTNR_VERWENDEN     as boolean = FALSEconst ZWISCHENSUMMEN        as boolean = TRUEconst UEBERTRAG             as boolean = TRUEconst ARTIKEL_BILD          as boolean = FALSEconst ALT_ZEILENHINTERGRUND as boolean = FALSEconst GESAMT_STEUER         as boolean = Firma_UStPflicht' ********************************************************************************' ********************************************************************************' Steuerinformationen für Kleinunternehmer-Rechnung anzeigen (TRUE = Element sichtbar)const KLEINUNTERNEHMER    as boolean = FALSE' ********************************************************************************' ********************************************************************************'Alle Vorbelege anzeigen einschaltenconst VORBELEG_ALLE       as boolean = TRUE' ********************************************************************************' Variablen definierendim titel                as text = case(BESTELL_Art = BESTELLART_ANFRAGE, "Bestellanfrage", BESTELL_Art = BESTELLART_BESTELLUNG, "Bestellung", BESTELL_Art = BESTELLART_WARENEINGANG, "Wareneingang", BESTELL_Art = BESTELLART_RECHNUNG, "Rechnung", BESTELL_Art = BESTELLART_GUTSCHRIFT, "Gutschrift", BESTELL_Art = BESTELLART_RUECKSENDUNG, "Rücksendung", BESTELL_Art = BESTELLART_STORNO, "Storno", "")dim aw                   as text = " " + BESTELL_WaehrungSymboldim kleinunternehmerText as textdim stNr                 as textdim abZ                  as textdim fz1                  as textdim fz2                  as textdim fz3                  as textdim fz4                  as textdim hoehe                as numberdim links1               as numberdim links2               as numberdim breite               as numberdim zab                  as numberdim steuer               as textdim steuersatz           as textdim altPos               as booleandim firstPos             as booleandim betrag               as textdim bezeichnung          as textdim zwischenSumme        as numberdim anzVorbeleg          as numberdim posContentTop        as numberdim row                  as number = 0' Startwerte (X-Positionen) der Spalten in der Positionstabelle' Wichtig: Alle Koordinatenwerte im Dokument werden in Zehntel-Millimeter angegeben, Start ist oben links (0, 0)dim anzahlSpalten as number = 7dim s1 as number = LAYOUTLEFT               'Anfang Spalte Pos.dim s2 as number = LAYOUTLEFT + 70          'Anfang Spalte Bezeichnung' Spalte Steuer bei Kleinunternehmer ausblendenif ( KLEINUNTERNEHMER or Firma_UStPflicht = False )dim s3 as number = LAYOUTLEFT + 900         'Anfang Spalte Mengedim s4 as number = LAYOUTLEFT + 1050        'Anfang Spalte Einh.dim s5 as number = LAYOUTLEFT + 1200        'Anfang Spalte Steuer (wird ausgeblendet)elsedim s3 as number = LAYOUTLEFT + 750         'Anfang Spalte Mengedim s4 as number = LAYOUTLEFT + 900         'Anfang Spalte Einh.dim s5 as number = LAYOUTLEFT + 1050        'Anfang Spalte Steuerendifdim s6 as number = LAYOUTLEFT + 1200        'Anfang Spalte Einzelpreisdim s7 as number = LAYOUTLEFT + 1450        'Anfang Spalte Gesamtpreisdim s8 as number = LAYOUTLEFT + LAYOUTWIDTH 'Ende Spalte Gesamtpreis' Hier werden die Variablen für die Spaltenbreiten und Innenabstände der Positionstabelle initialisiert#include "TEMPLATE Table"' -----------------------------------------------------------------------------------------' Beginn Briefpapier (Hintergrund)' -----------------------------------------------------------------------------------------#BeginBackground' In diesem Script erfolgt die Definition des Briefpapiers inkl. Logoeinbindung#include "TEMPLATE Briefpapier A4 hoch"' -----------------------------------------------------------------------------------------' Beginn Kopfzeile (Platzhalter für nachfolgende Bereiche)' -----------------------------------------------------------------------------------------#BeginHeaderif ( PAGE_NUMBER = 1 )' Kopfzeile 1. SeiteSetArea(HEADER1_HEIGHT)else' Kopfzeile FolgeseitenSetArea(HEADER2_HEIGHT)endif#include "STYLE Arial 9, normal"' -----------------------------------------------------------------------------------------' Beginn Adress- und Infobereich' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(700, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 90' Adressfenster linksDrawText(BESTELL_Rechnungsanschrift, links1, hoehe, 900, 250)' Infoblock rechtsset hoehe to 80set links1 to 1100set links2 to links1 + 280set breite to LAYOUTLEFT + LAYOUTWIDTH - links2set zab to 40if ( BESTELL_LieferNr <> "" )DrawText("Lieferung-Nr.:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_LieferNr, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifDrawText("Lieferant-Nr.:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_KundenNr, links2, hoehe, breite, 50)set hoehe to hoehe + zabif ( BESTELL_ADR_LieferantExterneNr <> "" )DrawText("Ext. Referenz:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_ADR_LieferantExterneNr, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BESTELL_ADR_UStID <> "" )DrawText("Lieferant-UStID:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_ADR_UStID, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifDrawText("Datum:", links1, hoehe, links2 - links1, 50)DrawText(IfThen(GetPlatform = 1, MediumDate(BESTELL_Datum), ShortDate(BESTELL_Datum)), links2, hoehe, breite, 50)set hoehe to hoehe + zabif ( BESTELL_Art = BESTELLART_RECHNUNG or BESTELL_Art = BESTELLART_GUTSCHRIFT or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG) and DateToNumber(BESTELL_LieferDatum) > 0 )DrawText("Lieferdatum:", links1, hoehe, links2 - links1, 50)DrawText(IfThen(GetPlatform = 1, MediumDate(BESTELL_LieferDatum), ShortDate(BESTELL_LieferDatum)), links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BESTELL_VersandNummer <> "" )if ( BESTELL_Lieferart <> "" )DrawText("Lieferart:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_Lieferart, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifDrawText("Sendungsnummer:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_VersandNummer, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BESTELL_BearbeiterAngeben )DrawText("Rückfragen an:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_Bearbeiter, links2, hoehe, breite, 50)set hoehe to hoehe + zabif ( BESTELL_BearbeiterTelefon <> "" )DrawText("Telefon:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_BearbeiterTelefon, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BESTELL_BearbeiterEmail <> "" )DrawText("E-Mail:", links1, hoehe, links2 - links1, 50)DrawText(BESTELL_BearbeiterEmail, links2, hoehe, breite, 100)set hoehe to hoehe + 2 * zabendifelseif ( Firma_Telefon <> "" )DrawText("Telefon:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Telefon, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( Firma_Email <> "" )DrawText("E-Mail:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Email, links2, hoehe, breite, 100)set hoehe to hoehe + 2 * zabendifendifDrawText("Seite:", links1, hoehe, links2 - links1, 50)DrawText(NumToText(PAGE_NUMBER), links2, hoehe, breite, 50)' -----------------------------------------------------------------------------------------' Beginn Auftragskopf (Anrede, Anschreiben)' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(1500, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"' Auftragstitelset hoehe to 100set links1 to LAYOUTLEFTSetTextSize(11)SetTextBold(true)DrawText(titel + " Nr. " + BESTELL_BestellNr, links1, hoehe, LAYOUTWIDTH, 50)SetTextBold(false)' Vorbelegif ( BESTELL_Vorbeleg <> "" AND BESTELL_VorbelegNr <> "" )set hoehe to AREA_CURRENTHEIGHT + 10SetTextSize(7)set anzVorbeleg to CountFields(BESTELL_VorbelegInfo, Chr(13))if ( (not VORBELEG_ALLE) or anzVorbeleg = 1 )' Nur den ersten Vorbeleg ausgebenDrawText("(Gehört zu " + BESTELL_Vorbeleg + " Nr. " + BESTELL_VorbelegNr + " vom " + DateToText(BESTELL_VorbelegDatum) + ")", links1, hoehe, LAYOUTWIDTH, 50)else' Alle Vorbelege ausgebenDrawText("(Gehört zu: " + ReplaceAll(BESTELL_VorbelegInfo, Chr(13), ", ") + ")", links1, hoehe, LAYOUTWIDTH, 300)endifendifSetTextSize(9)set hoehe to AREA_CURRENTHEIGHT + 80' Betreffif ( BESTELL_Betreff <> "" )DrawText(BESTELL_Betreff, links1, hoehe, LAYOUTWIDTH, 50)set hoehe to hoehe + 80endif' Anrede und Kopftextif ( BESTELL_KopfText <> "" )if ( BESTELL_Anrede <> "" )DrawText(BESTELL_Anrede, links1, hoehe, LAYOUTWIDTH, 50)set hoehe to hoehe + 80endifDrawText(BESTELL_KopfText, links1, hoehe, LAYOUTWIDTH, 1160)set hoehe to hoehe + 80endif' -----------------------------------------------------------------------------------------' Positionstabelle' -----------------------------------------------------------------------------------------#BeginTableHeaderif ( HasTable("Positionen") )if ( PAGE_NUMBER > 1 and UEBERTRAG and BESTELL_Art <> BESTELLART_WARENEINGANG and BESTELL_Art <> BESTELLART_RUECKSENDUNG and (BESTELL_Art <> BESTELLART_STORNO or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG)) )SetArea(130)elseSetArea(80)endif#include "STYLE Arial 7, normal"set hoehe to 40set firstPos to true' Spaltenkopfif ( BESTELL_Art = BESTELLART_WARENEINGANG or BESTELL_Art = BESTELLART_RUECKSENDUNG or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt = BESTELLART_WARENEINGANG) )DrawText("Pos.", l1, hoehe, b1, 40)DrawText("Bezeichnung", l2, hoehe, b2, 40)DrawText("Menge", l3, hoehe, b3, 40, ALIGN_RIGHT)DrawText("Einh.", l4, hoehe, b4, 40)DrawText("Gewicht kg", l7, hoehe, b7, 40, ALIGN_RIGHT)elseDrawText("Pos.", l1, hoehe, b1, 40)DrawText("Bezeichnung", l2, hoehe, b2, 40)DrawText("Menge", l3, hoehe, b3, 40, ALIGN_RIGHT)DrawText("Einh.", l4, hoehe, b4, 40)if ( not KLEINUNTERNEHMER and Firma_UStPflicht )DrawText("VSt", l5, hoehe, b5, 40)endifDrawText("Einzelpreis" + aw, l6, hoehe, b6, 40, ALIGN_RIGHT)DrawText("Gesamtpreis" + aw, l7, hoehe, b7, 40, ALIGN_RIGHT)endifif ( not LINIEN_HORIZONTAL )DrawLine(s1, hoehe + 40, s8, hoehe + 40)endifSetCurrentTable("Positionen")' Übertrag' ---------------------------------------------------------------------if ( PAGE_NUMBER > 1 and UEBERTRAG and BESTELL_Art <> BESTELLART_WARENEINGANG and BESTELL_Art <> BESTELLART_RUECKSENDUNG and (BESTELL_Art <> BESTELLART_STORNO or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG)) )#include "STYLE Arial 8, normal"if ( LINIEN_HORIZONTAL )DrawLine(s1, hoehe + 40, s8, hoehe + 40)endifset hoehe to AREA_CURRENTHEIGHTDrawText("Übertrag:", l5, hoehe + 10, l7 - l5, 40)if ( BESTELL_PreiseBrutto )' BruttopreiseDrawText(Format(zwischenSumme, FORMATBETRAGLEER), l7, hoehe + 10, b7, 40, ALIGN_RIGHT)else' NettopreiseDrawText(Format(zwischenSumme, FORMATBETRAGLEER), l7, hoehe + 10, b7, 40, ALIGN_RIGHT)endifset hoehe to AREA_CURRENTHEIGHT + 10' Tabellenränder links und rechtsif ( LINIEN_VERTIKAL )DrawLine(LAYOUTLEFT, 80, LAYOUTLEFT, hoehe)DrawLine(LAYOUTLEFT + LAYOUTWIDTH, 80, LAYOUTLEFT + LAYOUTWIDTH, hoehe)endifif ( not LINIEN_HORIZONTAL )DrawLine(s1, hoehe, s8, hoehe)endifendifendif' -----------------------------------------------------------------------------------------' Der Bereich 'TabelRow' wird für jede Position einmal wiederholt#BeginTableRowif ( HasTable("Positionen") )SetArea(MAX_POS_HEIGHT, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"set hoehe to 0if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(LAYOUTLEFT, LAYOUTLEFT + LAYOUTWIDTH)endifendif' Tabellenränder links und rechtsif ( LINIEN_VERTIKAL )DrawVerticalLine(LAYOUTLEFT)DrawVerticalLine(LAYOUTLEFT + LAYOUTWIDTH)endif' Bezeichnung für Steuer' ---------------------------------------------------------------------set steuersatz to Format(POS_SteuerProzent, "#.00") + "%"' Inhalt der Position' ---------------------------------------------------------------------set altPos to falseif ( POS_Art = AUFTRPOS_STAMMARTIKEL_ALT or POS_Art = AUFTRPOS_MANUELLARTIKEL_ALT )' Kennzeichen für Alternativpositionset altPos to trueSetTextItalic(true)endifif ( POS_Art = AUFTRPOS_STAMMARTIKEL or POS_Art = AUFTRPOS_MANUELLARTIKEL or altPos )' Obere horizntale Begrenzung bei ALternativpositionen einrückenif ( LINIEN_HORIZONTAL )if ( altPos and not firstPos )DrawLine(s2, hoehe, s5, hoehe)elseDrawLine(s1, hoehe, s8, hoehe)endifendifif ( POS_PosNrManuell <> "" )DrawText(POS_PosNrManuell, l1, hoehe + 10, b1, 40)elseif ( POS_Nummer <> 0 )DrawText(Format(POS_Nummer, "#"), l1, hoehe + 10, b1, 40)endifif ( altPos)DrawText("Alternativposition:", l2, hoehe + 10, b2, 40)set hoehe to hoehe + 40endifif ( ARTIKEL_NR )if ( HERSTNR_VERWENDEN )set bezeichnung to IfThen(POS_HerstellerNr = "", POS_Bezeichnung, POS_HerstellerNr + " / " + POS_Bezeichnung)elseset bezeichnung to IfThen(POS_ArtikelNr = "", POS_Bezeichnung, POS_ArtikelNr + " / " + POS_Bezeichnung)endifelseset bezeichnung to POS_BezeichnungendifSetTextBold(true)DrawText(bezeichnung, l2, hoehe + 10, b2, 80)SetTextBold(false)set breite to IfThen(ARTIKEL_BILD and POS_Bild1 <> 0, 280, 20)set posContentTop to AREA_CURRENTHEIGHT + 10DrawText(POS_Beschreibung, l2, posContentTop, s5 - s2 - breite, MAX_POS_HEIGHT - 50)' Ausgabe von Artikelbilderif ( ARTIKEL_BILD )if ( LINIEN_VERTIKAL )DrawVerticalLine(s5)endifif (POS_Bild1 <> 0)DrawPicture("*" + NumToText(POS_Bild1), s5 - 220, posContentTop, 200, 200)endifendifif ( BESTELL_Art <> BESTELLART_WARENEINGANG and BESTELL_Art <> BESTELLART_RUECKSENDUNG and (BESTELL_Art <> BESTELLART_STORNO or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG)) and POS_Rabatt <> 0 )DrawText("Rabatt %: " + Format(POS_Rabatt, "-#.00"), l5, hoehe + 50, s7 - s5 - 20, 40, ALIGN_RIGHT)endifDrawText(Format(POS_Menge, "-#." + Left("0000", Firma_EinkaufNKMenge)), l3, hoehe + 10, b3, 40, ALIGN_RIGHT)DrawText(POS_Einheit, l4, hoehe + 10, b4, 40)if ( BESTELL_Art = BESTELLART_WARENEINGANG or BESTELL_Art = BESTELLART_RUECKSENDUNG or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt = BESTELLART_WARENEINGANG) )DrawText(Format(POS_GesamtGewicht, FORMATKILOLEER), l7, hoehe + 10, b7, 40, ALIGN_RIGHT)elseif ( not KLEINUNTERNEHMER and Firma_UStPflicht )DrawText(steuersatz, l5, hoehe + 10, b5, 40)endifif ( BESTELL_PreiseBrutto )' BruttopreiseDrawText(Format(POS_EinzelPreisBruttoFW, FORMATEPLEER), l6, hoehe + 10, b6, 40, ALIGN_RIGHT)set betrag to Format(POS_GesamtPreisBruttoFW, FORMATBETRAGLEER)set betrag to IfThen(altPos, "(" + betrag + ")", betrag)DrawText(betrag, l7, hoehe + 10, b7, 40, ALIGN_RIGHT)set zwischenSumme to zwischenSumme + IfThen(altPos, 0, POS_GesamtPreisBruttoFW)else' NettopreiseDrawText(Format(POS_EinzelPreisNettoFW, FORMATEPLEER), l6, hoehe + 10, b6, 40, ALIGN_RIGHT)set betrag to Format(POS_GesamtPreisNettoFW, FORMATBETRAGLEER)set betrag to IfThen(altPos, "(" + betrag + ")", betrag)DrawText(betrag, l7, hoehe + 10, b7, 40, ALIGN_RIGHT)set zwischenSumme to zwischenSumme + IfThen(altPos, 0, POS_GesamtPreisNettoFW)endifendif' ---------------------------------------------------------------------elseif ( POS_Art = AUFTRPOS_TEXTPOSITION )if ( LINIEN_HORIZONTAL and (POS_Bezeichnung <> "" or POS_Beschreibung <> "") )DrawLine(s1, hoehe, s8, hoehe)endifif ( POS_Bezeichnung = "" )if ( POS_Beschreibung <> "" )DrawText(POS_Beschreibung, l2, hoehe + 10, s7 - s2 - 20, MAX_POS_HEIGHT - 50)else' Abstand zur nächsten Zeile vergrößern (weisse Linie als Platzhalter)SetLineColor(WHITE)DrawLine(s1, hoehe + 10, s8, hoehe + 10)SetLineColor(BLACK)endifelseSetTextBold(true)DrawText(POS_Bezeichnung, l2, hoehe + 10, b2, 80)SetTextBold(false)DrawText(POS_Beschreibung, l2, AREA_CURRENTHEIGHT + 10, s7 - s2 - 20, MAX_POS_HEIGHT - 50)endif' ---------------------------------------------------------------------elseif ( BESTELL_Art <> BESTELLART_WARENEINGANG and BESTELL_Art <> BESTELLART_RUECKSENDUNG and (BESTELL_Art <> BESTELLART_STORNO or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG)) and POS_Art = AUFTRPOS_ZWISCHENSUMME )if ( LINIEN_HORIZONTAL )DrawLine(s1, hoehe, s8, hoehe)endifSetTextBold(true)DrawText(IfThen(POS_Bezeichnung = "", "Zwischensumme", POS_Bezeichnung), l2, hoehe + 10, b2, 80)SetTextBold(false)DrawText(POS_Beschreibung, l2, AREA_CURRENTHEIGHT + 10, s7 - s2 - 20, MAX_POS_HEIGHT - 50)if ( BESTELL_PreiseBrutto )' BruttopreiseDrawText(Format(POS_GesamtPreisBruttoFW, FORMATBETRAGLEER), l7, hoehe + 10, b7, 40, ALIGN_RIGHT)else' NettopreiseDrawText(Format(POS_GesamtPreisNettoFW, FORMATBETRAGLEER), l7, hoehe + 10, b7, 40, ALIGN_RIGHT)endifSetTextBold(false)' ---------------------------------------------------------------------elseif ( POS_Art = AUFTRPOS_SEITENUMBRUCH )PageBreak' ---------------------------------------------------------------------elseif ( POS_Art = AUFTRPOS_KOMMENTAR )' Kommentarpositionen werden nicht ausgedrucktendifif ( POS_Art <> AUFTRPOS_KOMMENTAR and POS_Art <> AUFTRPOS_SEITENUMBRUCH )' Abstand zur nächsten Zeile vergrößern (weisse Linie als Platzhalter)set hoehe to IfThen(POS_Art = AUFTRPOS_ZWISCHENSUMME AND (BESTELL_Art = BESTELLART_WARENEINGANG OR BESTELL_Art = BESTELLART_RUECKSENDUNG), 0, AREA_CURRENTHEIGHT + 10)SetLineColor(WHITE)DrawLine(s1, hoehe, s8, hoehe)SetLineColor(BLACK)endifset firstPos to falseendif' -----------------------------------------------------------------------------------------#BeginTableBreakif ( HasTable("Positionen") )if ( BESTELL_Art <> BESTELLART_WARENEINGANG and BESTELL_Art <> BESTELLART_RUECKSENDUNG and (BESTELL_Art <> BESTELLART_STORNO or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG)) and ZWISCHENSUMMEN )' Zwischensumme ausgebenSetArea(50)#include "STYLE Arial 8, normal"DrawLine(s1, 0, s8, 0)DrawText("Zwischensumme:", l5, 10, l7 - l5, 40)DrawText(Format(zwischenSumme, FORMATBETRAGLEER), l7, 10, b7, 40, ALIGN_RIGHT)DrawLine(s1, 50, s8, 50)if ( LINIEN_VERTIKAL )DrawLine(LAYOUTLEFT, 0, LAYOUTLEFT, 50)DrawLine(LAYOUTLEFT + LAYOUTWIDTH, 0, LAYOUTLEFT + LAYOUTWIDTH, 50)endifelse' Abschließende Linie nach der letzten Position auf jeder SeiteSetArea(2)#include "STYLE Arial 8, normal"DrawLine(s1, 0, s8, 0)endifendif' -----------------------------------------------------------------------------------------' Gesamtbeträge am Tabellenende#BeginTableFooterif ( HasTable("Positionen") )SetArea(600, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"' Abschließende Linie nach der letzten Position der Tabelleif ( LINIEN_VERTIKAL )DrawLine(s1, 0, s8, 0)endifset hoehe to 50set links1 to LAYOUTLEFT + 1100set links2 to links1 + 300set breite to LAYOUTLEFT + LAYOUTWIDTH - links2 - 10if ( BESTELL_Art = BESTELLART_WARENEINGANG or BESTELL_Art = BESTELLART_RUECKSENDUNG or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt = BESTELLART_WARENEINGANG) )' Gesamtgewicht für WareneingangSetTextBold(true)DrawText("Gesamtgewicht:", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(BESTELL_Gewicht, FORMATKILONULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHTelse' Gesamtzeile für alle anderen Bestellartenif ( BESTELL_PreiseBrutto )if ( Ges_RabattBetragFW <> 0 )' Gesamt Rabatt vorhandenif ( KLEINUNTERNEHMER or (GESAMT_STEUER = FALSE and Ges_SteuerBetragFW = 0) )DrawText("Zwischensumme" + aw + ":", links1, hoehe + 10, links2 - links1, 40)elseDrawText(Ges_PositionenBruttoBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)endifDrawText(Format(Ges_PositionenBruttoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHTDrawText(Ges_RabattBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_RabattBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHTDrawLine(links1, hoehe + 5, s8, hoehe + 5)set hoehe to AREA_CURRENTHEIGHTendifif ( KLEINUNTERNEHMER or (GESAMT_STEUER = FALSE and Ges_SteuerBetragFW = 0) )'GesamtbetragSetTextBold(true)DrawText("Gesamtbetrag" + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_BruttoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)SetTextBold(false)else' Gesamt BruttoSetTextBold(true)DrawText(Ges_BruttoBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_BruttoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)SetTextBold(false)set hoehe to AREA_CURRENTHEIGHT' Gesamt SteuerDrawText(Ges_SteuerBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_SteuerBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHT'Gesamt NettoDrawText(Ges_NettoBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_NettoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)endifelseif ( Ges_RabattBetragFW <> 0 )' Gesamt Rabatt vorhandenif ( KLEINUNTERNEHMER or (GESAMT_STEUER = FALSE and Ges_SteuerBetragFW = 0) )DrawText("Zwischensumme" + aw + ":", links1, hoehe + 10, links2 - links1, 40)elseDrawText(Ges_PositionenNettoBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)endifDrawText(Format(Ges_PositionenNettoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHTDrawText(Ges_RabattBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_RabattBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHTDrawLine(links1, hoehe + 5, s8, hoehe + 5)set hoehe to AREA_CURRENTHEIGHTendifif ( KLEINUNTERNEHMER or (GESAMT_STEUER = FALSE and Ges_SteuerBetragFW = 0) )'GesamtbetragSetTextBold(true)DrawText("Gesamtbetrag" + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_NettoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)SetTextBold(false)else'Gesamt NettoDrawText(Ges_NettoBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_NettoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHT' Gesamt SteuerDrawText(Ges_SteuerBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_SteuerBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)set hoehe to AREA_CURRENTHEIGHT' Gesamt BruttoSetTextBold(true)DrawText(Ges_BruttoBezeichnung + aw + ":", links1, hoehe + 10, links2 - links1, 40)DrawText(Format(Ges_BruttoBetragFW, FORMATBETRAGNULL), links2, hoehe + 10, breite, 40, ALIGN_RIGHT)SetTextBold(false)endifendif' ---------------------------------------------------------------------' Steuerausweis (für bis zu fünf Steuersätze ausgelegt, beliebig erweiterbar)set hoehe to 50set breite to 1000if ( KLEINUNTERNEHMER )DrawText("Nach § 19 Abs. 1 UStG wird keine Umsatzsteuer berechnet.", LAYOUTLEFT + 10, hoehe + 10, breite, 40)elseif ( Ges_SteuerBetragFW <> 0 )if ( HasField("Ges_NettoSteuer1BetragFW") and HasField("Ges_NettoSteuer1Bezeichnung") )if ( HasField("Ges_Steuer1BetragFW") and HasField("Ges_Steuer1Bezeichnung") )set steuer to Ges_Steuer1Bezeichnung + ": " + Format(Ges_Steuer1BetragFW, FORMATBETRAGNULL) + aw + ", Netto: " + Format(Ges_NettoSteuer1BetragFW, FORMATBETRAGNULL) + awelseset steuer to Ges_NettoSteuer1Bezeichnung + ": " + Format(Ges_NettoSteuer1BetragFW, FORMATBETRAGNULL) + awendifDrawText(steuer, LAYOUTLEFT + 10, hoehe + 10, breite, 40)set hoehe to hoehe + 40endifif ( HasField("Ges_NettoSteuer2BetragFW") and HasField("Ges_NettoSteuer2Bezeichnung") )if ( HasField("Ges_Steuer2BetragFW") and HasField("Ges_Steuer2Bezeichnung") )set steuer to Ges_Steuer2Bezeichnung + ": " + Format(Ges_Steuer2BetragFW, FORMATBETRAGNULL) + aw + ", Netto: " + Format(Ges_NettoSteuer2BetragFW, FORMATBETRAGNULL) + awelseset steuer to Ges_NettoSteuer2Bezeichnung + ": " + Format(Ges_NettoSteuer2BetragFW, FORMATBETRAGNULL) + awendifDrawText(steuer, LAYOUTLEFT + 10, hoehe + 10, breite, 40)set hoehe to hoehe + 40endifif ( HasField("Ges_NettoSteuer3BetragFW") and HasField("Ges_NettoSteuer3Bezeichnung") )if ( HasField("Ges_Steuer3BetragFW") and HasField("Ges_Steuer3Bezeichnung") )set steuer to Ges_Steuer3Bezeichnung + ": " + Format(Ges_Steuer3BetragFW, FORMATBETRAGNULL) + aw + ", Netto: " + Format(Ges_NettoSteuer3BetragFW, FORMATBETRAGNULL) + awelseset steuer to Ges_NettoSteuer3Bezeichnung + ": " + Format(Ges_NettoSteuer3BetragFW, FORMATBETRAGNULL) + awendifDrawText(steuer, LAYOUTLEFT + 10, hoehe + 10, breite, 40)set hoehe to hoehe + 40endifif ( HasField("Ges_NettoSteuer4BetragFW") and HasField("Ges_NettoSteuer4Bezeichnung") )if ( HasField("Ges_Steuer4BetragFW") and HasField("Ges_Steuer4Bezeichnung") )set steuer to Ges_Steuer4Bezeichnung + ": " + Format(Ges_Steuer4BetragFW, FORMATBETRAGNULL) + aw + ", Netto: " + Format(Ges_NettoSteuer4BetragFW, FORMATBETRAGNULL) + awelseset steuer to Ges_NettoSteuer4Bezeichnung + ": " + Format(Ges_NettoSteuer4BetragFW, FORMATBETRAGNULL) + awendifDrawText(steuer, LAYOUTLEFT + 10, hoehe + 10, breite, 40)set hoehe to hoehe + 40endifif ( HasField("Ges_NettoSteuer5BetragFW") and HasField("Ges_NettoSteuer5Bezeichnung") )if ( HasField("Ges_Steuer5BetragFW") and HasField("Ges_Steuer5Bezeichnung") )set steuer to Ges_Steuer5Bezeichnung + ": " + Format(Ges_Steuer5BetragFW, FORMATBETRAGNULL) + aw + ", Netto: " + Format(Ges_NettoSteuer5BetragFW, FORMATBETRAGNULL) + awelseset steuer to Ges_NettoSteuer5Bezeichnung + ": " + Format(Ges_NettoSteuer5BetragFW, FORMATBETRAGNULL) + awendifDrawText(steuer, LAYOUTLEFT + 10, hoehe + 10, breite, 40)set hoehe to hoehe + 40endifendifendifendifSetLineWidth(3)DrawLine(s1, 40, s8, 40)DrawLine(s1, AREA_CURRENTHEIGHT + 20, s8, AREA_CURRENTHEIGHT + 20)if ( LINIEN_VERTIKAL )SetLineWidth(1)DrawLine(LAYOUTLEFT, 40, LAYOUTLEFT, AREA_CURRENTHEIGHT)DrawLine(LAYOUTLEFT + LAYOUTWIDTH, 40, LAYOUTLEFT + LAYOUTWIDTH, AREA_CURRENTHEIGHT)endifendif' -----------------------------------------------------------------------------------------' Fussbereich' -----------------------------------------------------------------------------------------' Zahlungstext#BeginGraphicsTextSetArea(300, AREA_AUTOSIZE)if ( BESTELL_Art <> BESTELLART_WARENEINGANG and BESTELL_Art <> BESTELLART_RUECKSENDUNG and (BESTELL_Art <> BESTELLART_STORNO or (BESTELL_Art = BESTELLART_STORNO and BESTELL_VorbelegArt <> BESTELLART_WARENEINGANG)) and BESTELL_ZahlungsText <> "" )#include "STYLE Arial 9, normal"set hoehe to 50set breite to LAYOUTWIDTHset links1 to LAYOUTLEFTSetTextBold(FALSE)DrawText(BESTELL_ZahlungsText, links1, hoehe, breite, 250)endif' Fusstext#BeginGraphicsTextSetArea(1300, AREA_AUTOSIZE)if ( BESTELL_Fusstext <> "" )#include "STYLE Arial 9, normal"set hoehe to 50set breite to LAYOUTWIDTHset links1 to LAYOUTLEFTDrawText(BESTELL_Fusstext, links1, hoehe, breite, 1250)endif' Abweichende Lieferanschrift#BeginGraphicsTextSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 50set breite to LAYOUTWIDTHset links1 to LAYOUTLEFTif ( BESTELL_LieferanschriftVerwenden and BESTELL_Lieferanschrift <> "" )SetTextBold(true)DrawText("Bitte liefern Sie an:", links1, hoehe, breite, 50)SetTextBold(false)set hoehe to AREA_CURRENTHEIGHT + 20DrawText(BESTELL_Lieferanschrift, links1, hoehe, breite, 250)endif' Grusstext#BeginGraphicsTextSetArea(350, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 50set breite to LAYOUTWIDTHset links1 to LAYOUTLEFTif ( BESTELL_Grussformel <> "" )DrawText(BESTELL_Grussformel, links1, hoehe, breite, 300)elseif ( BESTELL_BearbeiterAngeben AND BESTELL_BearbeiterSignaturText <> "" )DrawText(BESTELL_BearbeiterSignaturText, links1, hoehe, breite, 300)endifendif' -----------------------------------------------------------------------------------------' Beginn Fusszeile (Platzhalter)' -----------------------------------------------------------------------------------------#BeginFooterSetArea(FOOTER_HEIGHT)#include "STYLE Arial 9, normal"0000011