00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000021Vorgangsliste A4 quer0000041021000004true000004true00000100000010000038Vorgangsübersicht ohne Ergebnisausgabe006081'-----------------------------------------------------------------------------------------'' Formular : Liste der Vorgänge im Format A4 quer' Historie : 01/11/2016: sts Initialversion' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Liste der Vorgänge in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row       as number = 0' Allgemeine Konstantenconst WHITE            as color  = RGBColor(255,255,255)const GRAY             as color  = RGBColor(240,240,240)const FORMATBETRAGROW  as text = "#.00;-#.00;\-\,\-\-"const MAX_POS_HEIGHT   as number = 300' Elementartconst KOSTEN_KALKULIERT   as number = 1const KOSTEN_BERECHNET    as number = 2const ERLOESE_KALKULIERT  as number = 3const ERLOESE_BERECHNET   as number = 4const ERGEBNIS            as number = 5' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 9 Spaltendim anzahlSpalten as number = 9dim s1 as number = 0                ' Anfang Spalte Datumdim s2 as number = 180              ' Anfang Spalte Vorgangdim s3 as number = 400              ' Anfang Spalte BelegNrdim s4 as number = 650              ' Anfang Spalte Firmadim s5 as number = 1150             ' Anfang Spalte Betreffdim s6 as number = 1700             ' Anfang Spalte Bearbeiterdim s7 as number = 2000             ' Anfang Spalte Betrag Nettodim s8 as number = 2200             ' Anfang Spalte Betrag Bruttodim s9 as number = 2400             ' Anfang Spalte Bezahlt Bruttodim s10 as number = LAYOUTWIDTH#include "TEMPLATE Table"' Variablen definierendim sumNetto       as numberdim sumBrutto      as numberdim sumBezahlt     as numberdim hoehe          as numberdim breite         as numberdim links1         as numberdim links2         as number'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(PROJEKT_Filter, 0, 150, LAYOUTWIDTH, 100)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"#BeginGraphicsTextSetArea(130)#include "STYLE Arial 9, normal"set hoehe to 80set links1 to 0SetTextBold(true)DrawText("Projekt: " + PROJEKT_Bezeichnung + ", Nr. " + PROJEKT_Nummer, links1, hoehe, LAYOUTWIDTH, 50)SetTextBold(false)'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Vorgaenge''-----------------------------------------------------------------------------------------#BeginTableHeaderif ( HasTable("Vorgaenge") )SetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Vorgaenge")DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawText("Datum", l1, 5, b1, 40)DrawVerticalLine(s2)DrawText("Vorgang", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("BelegNr", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Firma", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Betreff", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Bearbeiter", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("Netto", l7, 5, b7, 40)DrawVerticalLine(s8)DrawText("Brutto", l8, 5, b8, 40)DrawVerticalLine(s9)DrawText("Bezahlt", l9, 5, b9, 40)DrawVerticalLine(s10)endif'-----------------------------------------------------------------------------------------#BeginTableRowif (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif ( HasTable("Vorgaenge") )SetArea(MAX_POS_HEIGHT, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawText(IfThen(GetPlatform = 1, MediumDate(VORGANG_Datum), ShortDate(VORGANG_Datum)), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(VORGANG_Bezeichnung, l2, 5, b2, 40)DrawVerticalLine(s3)DrawText(VORGANG_BelegNr, l3, 5, b3, 40)DrawVerticalLine(s4)DrawText(VORGANG_FirmaMatchcode, l4, 5, b4, 40)DrawVerticalLine(s5)DrawText(VORGANG_Betreff, l5, 5, b5, 40)DrawVerticalLine(s6)DrawText(VORGANG_Bearbeiter, l6, 5, b6, 40)DrawVerticalLine(s7)DrawText(Format(VORGANG_BetragNetto, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)set sumNetto to sumNetto + VORGANG_BetragNettoDrawVerticalLine(s8)DrawText(Format(VORGANG_BetragBrutto, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)set sumBrutto to sumBrutto + VORGANG_BetragBruttoDrawVerticalLine(s9)DrawText(Format(VORGANG_Bezahlt, FORMATBETRAGNULL), l9, 5, b9, 40, ALIGN_RIGHT)set sumBezahlt to sumBezahlt + VORGANG_BezahltDrawVerticalLine(s10)endif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakif ( HasTable("Vorgaenge") )SetArea(10)DrawLine(s1, 0, s10, 0)endif#BeginTableFooterif ( HasTable("Vorgaenge") )SetArea(40)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawVerticalLine(s7)DrawText(Format(sumNetto, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(sumBrutto, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(sumBezahlt, FORMATBETRAGNULL), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawLine(s1, 40, s10, 40)endif' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Vorgaenge'' -----------------------------------------------------------------------------------------0000012