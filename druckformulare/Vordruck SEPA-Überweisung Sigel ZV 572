00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000038Vordruck SEPA-Überweisung Sigel ZV 5720000041010000004true000004true00000110000010000059Formular zum Ausdruck auf Vordruck Überweisung Sigel ZV 510007159'-----------------------------------------------------------------------------------------'' Formular : Vordruck Überweisung Sigel ZV 572'' Unterstütze Vordrucke : Überweisung / Zahlschein Sigel Nr.: ZV 572'' Historie' 05/12/2013: Initialversion' 27/02/2014: sts (Ausgabe Verwendungszweck bei Quittung auf 27 Zeichen beschränken)''-----------------------------------------------------------------------------------------#BeginDocument'-----------------------------------------------------------------------------------------SetDocument(0, 250, 0, 150)                                'Seitenränder definieren'-----------------------------------------------------------------------------------------' Konstanten für die korrekte Positionierung bei der Druckausgabe, Angaben in Zehntelmillimeternconst X as number = -10      ' horizontale Verschiebungconst Y as number = 0      ' vertikale Verschiebung' Ausgabe zu hoch        Erhöhen Sie den Y-Wert um 20, wenn es 2 mm zu hoch ist' Ausgabe zu tief        Vermindern Sie den Y-Wert um 20, wenn es 2 mm zu tief ist' Ausgabe zu weit links  Erhöhen Sie den X-Wert um 20, wenn es 2 mm zu weit links ist' Ausgabe zu weit rechts Vermindern Sie den X-Wert um 20, wenn es 2 mm zu weit rechts ist'-----------------------------------------------------------------------------------------' Konstanten definieren' Allgemeine Konstantenconst HEADER1_HEIGHT   as number = 570const BANKBELEG        as number = 2000const LAYOUTLEFT       as number = 70const LAYOUTWIDTH      as number = 1780const BLACK            as color  = RGBColor(0,0,0)const FORMATBETRAGLEER as text   = "#0.00"const FORMATREFNR      as text   = "#0000000000;"const MSPACE_T         as number = 50                      ' Laufweitenangabe für Monospace Textconst MSPACE_Z         as number = 40                      ' Laufweitenangabe für Monospace Zahlconst MSPACE           as number = 20' Belegarten' UEBERWEISUNG      as number = 1' LASTSCHRIFT       as number = 2' SEPA_UEBERWEISUNG as number = 4' Variablen definierendim hoehe              as numberdim starthoehe         as numberdim breite             as numberdim zh7                as numberdim zh9                as numberdim lf                 as numberdim kontoinhaber       as textdim beguenstigter      as textdim verwendungszweck   as text' Startwerte (X-Positionen) der Spalten in den Belegendim anzahlSpalten as number = 7dim s1 as number = LAYOUTLEFT + Xdim s2 as number = LAYOUTLEFT + X + 550dim s3 as number = LAYOUTLEFT + X + 630dim s4 as number = LAYOUTLEFT + X + 760dim s5 as number = LAYOUTLEFT + X + 950dim s6 as number = LAYOUTLEFT + X + 1340dim s7 as number = LAYOUTLEFT + X + 1470dim s8 as number = LAYOUTLEFT + X + LAYOUTWIDTH' Hier werden die Variablen für die Spaltenbreiten und Innenabstände der Positionstabelle initialisiert#include "TEMPLATE Table"' -----------------------------------------------------------------------------------------' Prüfung Belegart' -----------------------------------------------------------------------------------------if (ZA_TransferArt <> 4)beepmsgBox("Der ausgewählte Zahlungsauftrag ist keine SEPA-Überweisung, die Verarbeitung wird abgebrochen.")exitendif' -----------------------------------------------------------------------------------------' Beginn Kopfbereich (Platzhalter für nachfolgende Bereiche)' -----------------------------------------------------------------------------------------#BeginHeaderSetArea(HEADER1_HEIGHT)' Dummy-Zeichenbefehl (unsichtbar): Ohne Ausgabe wird die Bereichshöhe nicht gesetztDrawLine(0, 0, 0, 0)' -----------------------------------------------------------------------------------------' Beginn Briefpapier (Hintergrund) nur für Testzwecke' -----------------------------------------------------------------------------------------#BeginBackground'DrawPicture("Siegel ZV572.jpg",-90,-250)' -----------------------------------------------------------------------------------------' Beginn Bankbeleg und Kundenbeleg' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(BANKBELEG)#include "STYLE Arial 9, normal"set starthoehe to 100 + Yset hoehe to starthoeheset ZH7 to 30                                                             ' Zeilenhöhe für Quittungset ZH9 to 40                                                             ' Zeilenhöhe für Belegeset lf to 85                                                              ' Zeilenabstand Belegedim i as number = 0doexitloop (i = 2)'DrawText(ZA_EigenkontoBank, s1, hoehe, b1, zh9)set hoehe to hoehe + 130DrawTextMonospace(ZA_FremdkontoInhaber, s1, hoehe, s6 - s1, zh9, MSPACE_T)set hoehe to hoehe + lf + 5DrawTextMonospace(ZA_FremdkontoIban_Digital, s1, hoehe, s6 - s1, zh9, MSPACE_Z)set hoehe to hoehe + lfDrawTextMonospace(ZA_FremdkontoBic_Digital, s1, hoehe, b1, zh9, MSPACE_T)set hoehe to hoehe + lfDrawTextMonospace(Format(ZA_BetragZahlungFW,FORMATBETRAGLEER), s4, hoehe, s6 - s4, zh9, MSPACE_T)set hoehe to hoehe + lfDrawTextMonospace(ZA_Verwendungszweck1, s1, hoehe, s6 - s1 + 50, zh9, MSPACE_T)set hoehe to hoehe + lfDrawTextMonospace(ZA_Verwendungszweck2, s1, hoehe, s6 - s1 + 50, zh9, MSPACE_T)set hoehe to hoehe + lfDrawTextMonospace(ZA_EigenkontoInhaber, s1, hoehe, s6 - s1 + 50, zh9, MSPACE_T)set hoehe to hoehe + lf + 5if (i = 0)DrawTextMonospace(Right(ZA_EigenkontoIban_Digital, Length(ZA_EigenkontoIban_Digital)-2), s1 + 100, hoehe, s6 - s1, zh9, MSPACE_T)elseDrawTextMonospace(ZA_EigenkontoIban_Digital, s1, hoehe, s6 - s1, zh9, MSPACE_T)endifset hoehe to hoehe + 70if ( DateToNumber(ZA_DatumGeplant) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(ZA_DatumGeplant), ShortDate(ZA_DatumGeplant)), s1 + 100, hoehe, 200, zh9)endifset hoehe to starthoehe + 1060set i to i + 1loop' -----------------------------------------------------------------------------------------' Beginn Quittung' -----------------------------------------------------------------------------------------set b7 to b7 + 150set hoehe to starthoehe + 20 + Yset kontoinhaber to ZA_EigenkontoInhaber + CHR(13) + ZA_EigenkontoIbanset beguenstigter to ZA_FremdkontoInhaber + CHR(13) + ZA_FremdkontoIban + CHR(13) + ZA_FremdkontoBicset verwendungszweck to Left(ZA_Verwendungszweck1, 27) + CHR(13) + Left(ZA_Verwendungszweck2, 27)SetTextSize(10)SetTextBold(TRUE)DrawText(ZA_EigenkontoIban_Digital, s7, hoehe, b7, 45, ALIGN_CENTER)SetTextBold(FALSE)SetTextSize(7)set hoehe to hoehe + 125DrawText(kontoinhaber, s7, hoehe, b7, 130)set hoehe to hoehe + 150DrawText(beguenstigter, s7, hoehe, b7, 130)set hoehe to hoehe + 185DrawText(verwendungszweck, s7, hoehe, b7 + 150, 130)set hoehe to hoehe + 185if ( DateToNumber(ZA_DatumGeplant) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(ZA_DatumGeplant), ShortDate(ZA_DatumGeplant)), s7, hoehe, b7, zh7)endifset hoehe to hoehe + 75DrawText(Format(ZA_BetragZahlungFW,FORMATBETRAGLEER), s7, hoehe + 10, b7, zh7)set hoehe to hoehe + 75DrawText(Format(ZA_ReferenzNr, FORMATREFNR), s7, hoehe, b7, zh7)0000011