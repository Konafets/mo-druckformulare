00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000023TEMPLATE Bilanz A4 hoch000002-1000004true000004true00000100000010000076Template zur Realisierung der Bilanz/Einnahmen-Überschuss-Rechnungs-Ausgaben002595' -----------------------------------------------------------------------------------------'' Formular : TEMPLATE Bilanz A4 hoch' Historie : 14/08/2007: Initialversion vs' Geändert : 29/05/2009: sts (Anpassung automatischer Vorjahresvergleich)'            05/06/2018: sts (getrennte Ausgabe für Kontonummer und Kontobezeichnung)'            17/07/2019: sts: Abstand Ausgabe erste Kontozeile zur Untergruppe'' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Bilanz'' -----------------------------------------------------------------------------------------#BeginTableHeaderif(bereich="Bilanz")SetArea(90)#include "STYLE Arial 10, fett"if(BZ_GeArt = BZ_EURechnung)SetCurrentTable("EÜ-Rechnung")elseif(BZ_GeArt = BZ_Bilanz)SetCurrentTable("Bilanz")endifif( head and Mit_Vorjahr )DrawText("Position", l1, 0, b1, 50, ALIGN_CENTER)DrawText("Saldo", l2, 0, b2, 50, ALIGN_CENTER)DrawText("Saldo Vorjahr", l3, 0, b3, 50, ALIGN_CENTER)DrawVerticalLine(s2)DrawVerticalLine(s3)DrawLine(s1, 79, s4, 79)endifendif#BeginTableRowif(bereich="Bilanz")SetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if( Mit_Vorjahr )DrawVerticalLine(s2)DrawVerticalLine(s3)endifif ( BZ_Gruppe )set istGruppe to TRUEendifif(BZ_Gruppe AND BZ_EbeneNr = 1)SetTextBold(true)SetTextSize(10)set ebene to 1DrawText(BZ_Position, l1, 40, b1, 300)elseif(BZ_Gruppe AND BZ_EbeneNr = 2)SetTextSize(10)set ebene to 1DrawText(BZ_Position, l1, 40, b1, 300)elseif(BZ_Gruppe AND BZ_EbeneNr = 3)SetTextBold(true)set ebene to 2DrawText(BZ_Position, l1+delta, 20, b1-delta, 300)elseif(BZ_Gruppe AND BZ_EbeneNr = 4)set ebene to 2DrawText(BZ_Position, l1+delta, 20, b1-delta, 300)elseif(BZ_Konto)SetTextBold(false)SetTextSize(8)set ebene to 3set hoehe to IfThen(istGruppe, 10, 0)DrawText(BZ_KontoNummer, l1+2*delta, hoehe, deltaKto, 40)DrawText(BZ_KontoName, l1+2*delta+deltaKto, hoehe, b1-2*delta-deltaKto, 300)DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, hoehe, b2-3*delta, 40, ALIGN_RIGHT)if( Mit_Vorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, hoehe, b3-4*delta, 40, ALIGN_RIGHT)endifset istGruppe to FALSEendifif(BZ_Gruppe AND Left(BZ_Position, 5) = "Summe")DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, (3-ebene)*20, b2, 50, ALIGN_RIGHT)if( Mit_Vorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, (3-ebene)*20, b3, 50, ALIGN_RIGHT)endifendifif(BZ_EbeneNr=1 AND Left(BZ_Position, 5)="Summe" AND BZ_FolgendeEbeneNr<>-1)PageBreak(true)endifendif#BeginTableFooter0000011