00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000021Buchungsliste A4 quer0000041000000004true000004true00000100000010000031Buchungsliste im Format A4 quer004725' -----------------------------------------------------------------------------------------'' Formular : Buchungsliste im Format A4 quer' Historie : 28/06/2007: Initialversion' Geändert : 16/07/2007: mm Version 1' Geändert : 14/11/2013: sts (Spaltenbreite für Steuersatz angepasst)' Geändert : 21/12/2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'            31/05/2018: sts (Spaltenbreite für Datum angepasst, Ausgabetext für Status)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Buchungsliste in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row       as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 11 Spaltendim anzahlSpalten as number = 11dim s1 as number = 0dim s2 as number = 170dim s3 as number = 350dim s4 as number = 600dim s5 as number = 1150dim s6 as number = 1280dim s7 as number = 1410dim s8 as number = 1640dim s9 as number = 1930dim s10 as number = 2050dim s11 as number = 2480dim s12 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(BU_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Buchungsliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Buchungsliste")DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText("Datum", s1, 5, s2-s1, 40)DrawVerticalLine(s2)DrawText("Beleg", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("Referenz", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Buchungstext", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Konto", l5, 5, s7-s5-20, 40)DrawText("Soll", l5, 38, b5, 40)DrawText("Haben", l6, 38, b6, 40)DrawVerticalLine(s7)DrawText("Betrag", l7, 5, b7, 40)DrawVerticalLine(s8)DrawText("Steuer", l8, 5, b8, 40)DrawVerticalLine(s9)DrawText("Zeilen", l9, 5, b9, 40)DrawVerticalLine(s10)DrawText("Bemerkung", l10, 5, b10, 40)DrawVerticalLine(s11)DrawText("Status", l11, 5, b11, 40)DrawVerticalLine(s12)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText(ShortDate(BU_Belegdatum), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(BU_BelegNr, l2, 5, b2, 300)DrawVerticalLine(s3)DrawText(BU_Referenz, l3, 5, b3, 300)DrawVerticalLine(s4)DrawText(BU_Text, l4, 5, b4, 300)DrawVerticalLine(s5)DrawText(Format(BU_KontoSoll, FORMATKONTO), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(BU_KontoHaben, FORMATKONTO), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(BU_Summe, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(BU_Steuer, l8, 5, b8, 160, ALIGN_CENTER)DrawVerticalLine(s9)DrawText(Format(BU_AnzahlZeilen, "0"), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(BU_Bemerkung, l10, 5, b10, 300)DrawVerticalLine(s11)DrawText(Choose(BU_Status - 1, "NF", "F", "S", "#WERT!"), l11, 5, b11, 40, ALIGN_CENTER)DrawVerticalLine(s12)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s12, 0)#BeginTableFooterSetArea(40)#include "STYLE Arial 7, normal"DrawLine(s1, 0, s12, 0)DrawText("Status: NF = Nicht festgeschrieben, F = Festgeschrieben, S = Storniert", l1, 5, s12 - s1 - 20, 40)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Buchungsliste'' -----------------------------------------------------------------------------------------0000012