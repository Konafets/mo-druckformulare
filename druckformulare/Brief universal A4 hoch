00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000023Brief universal A4 hoch0000041019000004true000004true00000100000010000045Brief universal, A4 hoch (Brief, E-Mail, Fax)007195' -----------------------------------------------------------------------------------------'' Formular : Brief universal im Format A4 hoch'' Historie' 22/07/2016: sts Initialversion' 20/01/2017: sts (Abstand zwischen Anrede und Brieftext verringert)' 23/03/2017: sts (Ausgabe Datum <> 1.1.1904, Ausgabe Betreff ohne Text "Betreff:")' -----------------------------------------------------------------------------------------#BeginDocumentSetDocument(150, 150, 200, 100) ' Seitenränder definieren' Konstanten definieren' Allgemeine Konstantenconst HEADER1_HEIGHT   as number = 360const HEADER2_HEIGHT   as number = 360const FOOTER_HEIGHT    as number = 250const BLACK            as color  = RGBColor(0,0,0)const WHITE            as color  = RGBColor(255,255,255)const LAYOUTLEFT       as number = 100const LAYOUTWIDTH      as number = 1650const SEP              as text   = " • "' Ausgabemediumconst AUSGABE_DRUCK               as number = 0const AUSGABE_EMAIL               as number = 1' Variablen definierendim stNr          as textdim abZ           as textdim fz1           as textdim fz2           as textdim fz3           as textdim fz4           as textdim hoehe         as numberdim links1        as numberdim links2        as numberdim breite        as numberdim zab           as number' -----------------------------------------------------------------------------------------' Beginn Briefpapier (Hintergrund)' -----------------------------------------------------------------------------------------#BeginBackground' In diesem Script erfolgt die Definition des Briefpapiers inkl. Logoeinbindung#include "TEMPLATE Briefpapier A4 hoch"if ( BRIEF_AusgabeFAX and PAGE_NUMBER = 1 )#include "STYLE Arial 9, normal"set hoehe to 100set links1 to LAYOUTLEFTSetTextSize(18)SetTextBold(TRUE)DrawText("FAX", links1, hoehe, LAYOUTWIDTH, 150)endif' -----------------------------------------------------------------------------------------' Beginn Kopfzeile (Platzhalter für nachfolgende Bereiche)' -----------------------------------------------------------------------------------------#BeginHeaderif ( PAGE_NUMBER = 1 )' Kopfzeile 1. SeiteSetArea(HEADER1_HEIGHT)else' Kopfzeile FolgeseitenSetArea(HEADER2_HEIGHT)endif#include "STYLE Arial 9, normal"' -----------------------------------------------------------------------------------------' Beginn Adress- und Infobereich' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(700, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 90set links1 to LAYOUTLEFTset links2 to links1 + 150set breite to links2 - links1' Adressfenster linksif ( BRIEF_AusgabeFAX )set hoehe to 0DrawText("An:", links1, hoehe, breite, 50)DrawText(BRIEF_Anschrift, links2, hoehe, 900 - breite, 250)set hoehe to AREA_CURRENTHEIGHT + 20DrawText("Fax-Nr.:", links1, hoehe, breite, 50)DrawText(BRIEF_FAXNrEmpfaenger, links2, hoehe, 900 - breite, 50)elseDrawText(BRIEF_Anschrift, links1, hoehe, 900, 250)endif' Infoblock rechtsset hoehe to 80set links1 to 1050set links2 to links1 + 280set breite to LAYOUTLEFT + LAYOUTWIDTH - links2set zab to 40if ( BRIEF_AusgabeFAX )set hoehe to 0DrawText("Von:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Name, links2, hoehe, breite, 50)set hoehe to hoehe + zabif ( Firma_Telefax <> "" )DrawText("Fax-Nr.:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Telefax, links2, hoehe, breite, 50)set hoehe to hoehe + zab + 20endifendifif ( BRIEF_BriefNr <> "" )DrawText("Brief-Nr.:", links1, hoehe, links2 - links1, 50)DrawText(BRIEF_BriefNr, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BRIEF_ADR_KundeExterneNr <> "" )DrawText("Ext. Referenz:", links1, hoehe, links2 - links1, 50)DrawText(BRIEF_ADR_KundeExterneNr, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( DateToNumber(BRIEF_Datum) > 0 )DrawText("Datum:", links1, hoehe, links2 - links1, 50)DrawText(IfThen(GetPlatform = 1, MediumDate(BRIEF_Datum), ShortDate(BRIEF_Datum)), links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BRIEF_BearbeiterAngeben )DrawText("Rückfragen an:", links1, hoehe, links2 - links1, 50)DrawText(BRIEF_Bearbeiter, links2, hoehe, breite, 50)set hoehe to hoehe + zabif ( BRIEF_BearbeiterTelefon <> "" )DrawText("Telefon:", links1, hoehe, links2 - links1, 50)DrawText(BRIEF_BearbeiterTelefon, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( BRIEF_BearbeiterEmail <> "" )DrawText("E-Mail:", links1, hoehe, links2 - links1, 50)DrawText(BRIEF_BearbeiterEmail, links2, hoehe, breite, 100)set hoehe to hoehe + 2 * zabendifelseif ( Firma_Telefon <> "" )DrawText("Telefon:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Telefon, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( Firma_Email <> "" )DrawText("E-Mail:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Email, links2, hoehe, breite, 100)set hoehe to hoehe + 2 * zabendifendifDrawText("Seite:", links1, hoehe, links2 - links1, 50)DrawText(NumToText(PAGE_NUMBER), links2, hoehe, breite, 50)' -----------------------------------------------------------------------------------------' Beginn Briefkopf (Betreff, Anrede)' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(1500, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"' Briefbetreffset hoehe to IfThen(PAGE_CURRENTHEIGHT < 900, 900 - PAGE_CURRENTHEIGHT, 50)set links1 to LAYOUTLEFTif ( BRIEF_Betreff <> "" )SetTextBold(true)DrawText(BRIEF_Betreff, links1, hoehe, LAYOUTWIDTH, 50)SetTextBold(false)set hoehe to AREA_CURRENTHEIGHT + 80endif' Anredeif ( BRIEF_Anrede <> "" )DrawText(BRIEF_Anrede, links1, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40endif'-----------------------------------------------------------------------------------------' Beginn Brieftext'-----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(700, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 50set links1 to LAYOUTLEFTDrawText(BRIEF_BriefText, links1, hoehe, LAYOUTWIDTH, 300)' -----------------------------------------------------------------------------------------' Beginn Fussbereich (Grusstext)' -----------------------------------------------------------------------------------------' Grusstext#BeginGraphicsTextSetArea(350, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 100set breite to LAYOUTWIDTHset links1 to LAYOUTLEFTif ( BRIEF_Grussformel <> "" )DrawText(BRIEF_Grussformel, links1, hoehe, breite, 300)elseif ( BRIEF_BearbeiterAngeben AND BRIEF_BearbeiterSignaturText <> "" )DrawText(BRIEF_BearbeiterSignaturText, links1, hoehe, breite, 300)endifendif' -----------------------------------------------------------------------------------------' Beginn Fusszeile (Platzhalter)' -----------------------------------------------------------------------------------------#BeginFooterSetArea(FOOTER_HEIGHT)#include "STYLE Arial 9, normal"0000011