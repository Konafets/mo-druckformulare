00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000033Artikelstückliste A4 hoch einzeln0000043006000004true000004true00000100000010000073Artikelstückliste im Format A4 hoch einzeln mit Bestand und EK-/VK-Preise004696' -----------------------------------------------------------------------------------------'' Formular : Artikelstückliste im Format A4 hoch einzeln' Historie : 25/10/2018: Initialversion' Geändert :'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Artikelstückliste"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row         as number = 0dim hoehe       as numberdim firstPos    as boolean = TRUE' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 6 Spaltendim anzahlSpalten as number = 6dim s1 as number = 0dim s2 as number = 700dim s3 as number = 950dim s4 as number = 1100dim s5 as number = 1250dim s6 as number = 1500dim s7 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(Firma_Name, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Artikelstueckliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)if ( HasTable("Artikelstueckliste") )SetCurrentTable("Artikelstueckliste")DrawLine(s1, 0, s7, 0)DrawVerticalLine(s1)DrawText("Bezeichnung", s1, 5, s2-s1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Art.-Nr.", l2, 5, b2, 160, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Menge", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Bestand", l4, 5, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("EK-Gesamt (Netto)", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("VK-Gesamt (Netto)", l6, 5, b6, 80, ALIGN_CENTER)DrawVerticalLine(s7)elseSetTextSize(14)DrawText("Keine Stücklistenartikel vorhanden", l1, 15, s7 - s1 - 20, 80, ALIGN_CENTER)endif'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if ( HasTable("Artikelstueckliste") )if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s7, 0)if ( SL_StuecklistenZeile )SetTextBold(FALSE)set hoehe to 0DrawText(SL_Bezeichnung, l1, hoehe + 5, b1, 40, ALIGN_LEFT)DrawText(SL_Artikelnummer, l2, hoehe + 5, b2, 300, ALIGN_LEFT)DrawText(Format(SL_Menge / 10000, "#.##"), l3, hoehe + 5, b3, 300, ALIGN_RIGHT)DrawText(Format(SL_Bestand / 10000, "#.##"), l4, hoehe + 5, b4, 160, ALIGN_RIGHT)DrawText(Format(SL_EKGesamtNetto, FORMATBETRAGNULL), l5, hoehe + 5, b5, 160, ALIGN_RIGHT)DrawText(Format(SL_VKGesamtNetto, FORMATBETRAGNULL), l6, hoehe + 5, b6, 80, ALIGN_RIGHT)DrawVerticalLine(s1)DrawVerticalLine(s2)DrawVerticalLine(s3)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)elsePageBreak(not firstPos, TRUE)SetTextBold(TRUE)set hoehe to 20DrawText(SL_Bezeichnung + " (" + SL_Artikelnummer + ")", l1, hoehe + 15, s4 - s1 - 20, 40, ALIGN_LEFT)DrawText(Format(SL_Bestand / 10000, "#.##"), l4, hoehe + 15, b4, 160, ALIGN_RIGHT)DrawText(Format(SL_EKGesamtNetto, FORMATBETRAGNULL), l5, hoehe + 15, b5, 160, ALIGN_RIGHT)DrawText(Format(SL_VKGesamtNetto, FORMATBETRAGNULL), l6, hoehe + 15, b6, 80, ALIGN_RIGHT)DrawLine(s1, hoehe, s7, hoehe)DrawLine(s1, hoehe, s1, hoehe + 50)DrawLine(s4, hoehe, s4, hoehe + 50)DrawLine(s5, hoehe, s5, hoehe + 50)DrawLine(s6, hoehe, s6, hoehe + 50)DrawLine(s7, hoehe, s7, hoehe + 50)endifset firstPos to FALSEendif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s7, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s7, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Artikelstueckliste'' -----------------------------------------------------------------------------------------0000011