00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000025Einkaufsstatistik A4 hoch0000042026000004true000004true00000100000010000035Einkaufsstatistik im Format A4 hoch010450' -----------------------------------------------------------------------------------------'' Formular : Einkaufsstatistik im Format A4 hoch' Historie : 04/08/2008: Initialversion sts' Geändert : 12/09/2008: mm' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'            15/03/2017: Ausgabe von Detailinformationen über Schalter "DETAIL_ANSICHT" möglich'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = IfThen(ES_Periodenvergleich, "Einkaufsstatistik in " + App_GJWaehrung + " mit Vergleichszeitraum", "Einkaufsstatistik in " + App_GJWaehrung + " ohne Vergleichszeitraum")' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' ********************************************************************************' Über die folgenden Konstante können weitere Details zu den Postionen' angezeigt werden (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const DETAIL_ANSICHT as boolean = FALSE' ********************************************************************************' Variablen definierendim row          as number = 0dim posRow       as boolean = TRUEdim sumDetailPos as booleandim firstPos     as booleandim hoehe        as number' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 6 Spaltendim anzahlSpalten as number = 6if( ES_Periodenvergleich )dim s1 as number = 0dim s2 as number = 250dim s3 as number = 850dim s4 as number = 1050dim s5 as number = 1300dim s6 as number = 1500dim s7 as number = LAYOUTWIDTHelsedim s1 as number = 0dim s2 as number = 350dim s3 as number = 650dim s4 as number = 950dim s5 as number = 1100dim s6 as number = 1400dim s7 as number = LAYOUTWIDTHendifdim FORMATPROZENT as text = "-#.00"dim FORMATANZAHL  as text = "#." + Left("0000", Firma_FakturaNKMenge) + ";-#." + Left("0000", Firma_FakturaNKMenge) + ";\-"dim FORMATBETRAG as text = "###,###,##0.00;-###,###,##0.00;\-"#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"SetTextSize(9)DrawText(ES_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'VKStatistik'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("EKStatistik")DrawLine(s1, 0, s7, 0)DrawVerticalLine(s1)if ( not ES_AnzeigeArtikelgruppe )if ( ES_AuswertungsArt = ES_Kundenumsaetze )DrawText("Adress-Nr", s1, 5, b1, 40, ALIGN_CENTER)elseDrawText("Artikel-Nr", s1, 5, b1, 40, ALIGN_CENTER)endifDrawVerticalLine(s2)endifif( ES_Periodenvergleich )if ( ES_AnzeigeArtikelgruppe )DrawText("Warengruppe", s1, 5, s3 - s1, 40, ALIGN_CENTER)elseDrawText(IfThen(ES_AuswertungsArt = ES_Kundenumsaetze, "Matchcode", "Bezeichnung"), s2, 5, b2, 40, ALIGN_CENTER)endifDrawVerticalLine(s3)if ( ES_AuswertungsArt = ES_Artikelumsaetze )DrawText("Umsatz P1", l3, 5, b3, 40, ALIGN_CENTER)DrawText("Umsatz P2", l5, 5, b5, 40, ALIGN_CENTER)elseDrawText("Anzahl P1", l3, 5, b3, 40, ALIGN_CENTER)DrawText("Anzahl P2", l5, 5, b5, 40, ALIGN_CENTER)endifDrawVerticalLine(s4)if ( ES_AuswertungsArt = ES_Artikelumsatzstueck OR ES_AuswertungsArt = ES_Kundenumsaetze )DrawText("Umsatz P1", l4, 5, b4, 40, ALIGN_CENTER)DrawText("Umsatz P2", l6, 5, b6, 40, ALIGN_CENTER)elseDrawText("% von Gesamt", l4, 5, b4, 40, ALIGN_CENTER)DrawText("% von Gesamt", l6, 5, b6, 40, ALIGN_CENTER)endifelseif ( ES_AnzeigeArtikelgruppe )DrawText("Warengruppe", s1, 5, s5 - s1, 40, ALIGN_CENTER)elseDrawText(IfThen(ES_AuswertungsArt = ES_Kundenumsaetze, "Matchcode", "Bezeichnung"), s2, 5, s5 - s2, 40, ALIGN_CENTER)endifif ( ES_AuswertungsArt = ES_Artikelumsaetze )DrawText("Umsatz P1", l5, 5, b5, 40, ALIGN_CENTER)elseDrawText("Anzahl P1", l5, 5, b5, 40, ALIGN_CENTER)endifif ( ES_AuswertungsArt = ES_Artikelumsatzstueck OR ES_AuswertungsArt = ES_Kundenumsaetze )DrawText("Umsatz P1", l6, 5, b6, 40, ALIGN_CENTER)elseDrawText("% von Gesamt", l6, 5, b6, 40, ALIGN_CENTER)endifendifDrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)set firstPos to TRUE'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"set hoehe to 0if ( DETAIL_ANSICHT and ES_Zeilenart = ES_DetailSummenzeile )if ( PAGE_CURRENTHEIGHT > PAGE_HEIGHT - 280 )PageBreak(TRUE)endifendif' Linien und Zeilenhintergrund zeichnen, Textformatierung festlegenif (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))if ( DETAIL_ANSICHT )if ( ES_Zeilenart = ES_DetailSummenzeile or ES_Zeilenart = ES_Summenzeile )set row to 0elseset row to row + 1endifelseif ( ES_Zeilenart = ES_Positionszeile or ES_Zeilenart = ES_Summenzeile )set row to row + 1endifendifif ( Mod(row, 2) = 1 )FillAreaVertical(hoehe, LAYOUTWIDTH)endifendifif ( ES_Zeilenart = ES_Positionszeile )DrawLine(s1, hoehe, s7, hoehe)set posRow to TRUEset sumDetailPos to FALSEif ( DETAIL_ANSICHT )SetTextBold(TRUE)endifif ( not ES_AnzeigeArtikelgruppe )DrawVerticalLine(s2)endifendifif ( DETAIL_ANSICHT and ES_Zeilenart = ES_Detailzeile )SetTextBold(FALSE)if ( posRow or firstPos )DrawLine(s1, hoehe, s7, hoehe)set posRow to FALSEendifendifif ( DETAIL_ANSICHT and ES_Zeilenart = ES_DetailSummenzeile )DrawLine(s1, hoehe, s7, hoehe)DrawLine(s1, hoehe + 40, s1, hoehe + 40)set sumDetailPos to TRUEendifif ( ES_Zeilenart <> ES_DetailSummenzeile )DrawVerticalLine(s1)DrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)if ( ES_Periodenvergleich )DrawVerticalLine(s3)DrawVerticalLine(s4)endifendifif ( ES_Zeilenart = ES_Summenzeile )DrawLine(s1, hoehe, s7, hoehe)SetTextBold(TRUE)endif' Ausgabe der Positionenif ( ES_Periodenvergleich )if ( ES_Zeilenart = ES_Summenzeile )DrawText(ES_Bezeichnung, l1, hoehe + 5, b1, 80)endifif ( ES_Zeilenart = ES_Positionszeile )if ( ES_AnzeigeArtikelgruppe )DrawText(IfThen(ES_AnzeigeArtikelgruppe, ES_Artikelgruppe, ES_Matchcode), l1, hoehe + 5, s4 - s1 - 20, 40)elseDrawText(IfThen(ES_AuswertungsArt = ES_Kundenumsaetze, ES_AdressNr, ES_ArtikelNr), l1, hoehe + 5, b1, 40, ALIGN_CENTER)DrawText(IfThen(ES_AuswertungsArt = ES_Kundenumsaetze, ES_Matchcode, ES_Bezeichnung), l2, hoehe + 5, b2, 80)if ( ES_EAN <> "")DrawLine(s2, AREA_CURRENTHEIGHT + 20, s3, AREA_CURRENTHEIGHT + 20)DrawText("EAN: " + ES_EAN, l2, AREA_CURRENTHEIGHT + 10, b2, 80)endifendifendifif ( DETAIL_ANSICHT and ES_Zeilenart = ES_Detailzeile )DrawText(IfThen(ES_DetailAuswertungsArt = ES_Kundenumsaetze, ES_Matchcode, ES_Bezeichnung), l1, hoehe + 5, s3 - s1 - 20, 40, ALIGN_RIGHT)endifif ( ES_Zeilenart = ES_Positionszeile or ES_Zeilenart = ES_Summenzeile or (DETAIL_ANSICHT and ES_Zeilenart = ES_Detailzeile) )if ( ES_AuswertungsArt = ES_Artikelumsaetze )DrawText(Format(ES_UmsatzP1/100, FORMATBETRAG), l3, hoehe + 5, b3, 40, ALIGN_RIGHT)DrawText(Format(ES_UmsatzP2/100, FORMATBETRAG), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)elseDrawText(Format(ES_AnzahlP1/10000, FORMATANZAHL), l3, hoehe + 5, b3, 40, ALIGN_RIGHT)DrawText(Format(ES_AnzahlP2/10000, FORMATANZAHL), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)endifif ( ES_AuswertungsArt = ES_Artikelumsatzstueck OR ES_AuswertungsArt = ES_Kundenumsaetze )DrawText(Format(ES_UmsatzP1/100, FORMATBETRAG), l4, hoehe + 5, b4, 40, ALIGN_RIGHT)DrawText(Format(ES_UmsatzP2/100, FORMATBETRAG), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)elseDrawText(Format(ES_ProzentP1, FORMATBETRAGLEER), l4, hoehe + 5, b4, 40, ALIGN_RIGHT)DrawText(Format(ES_ProzentP2, FORMATBETRAGLEER), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)endifendifelseif ( ES_Zeilenart = ES_Summenzeile )DrawText(ES_Bezeichnung, l1, hoehe + 5, s5 - s1 - 20, 80)endifif ( ES_Zeilenart = ES_Positionszeile )if ( ES_AnzeigeArtikelgruppe )DrawText(IfThen(ES_AnzeigeArtikelgruppe, ES_Artikelgruppe, ES_Matchcode), l1, hoehe + 5, s6 - s1 - 20, 40)elseDrawText(IfThen(ES_AuswertungsArt = ES_Kundenumsaetze, ES_AdressNr, ES_ArtikelNr), l1, hoehe + 5, b1, 40, ALIGN_CENTER)DrawText(IfThen(ES_AuswertungsArt = ES_Kundenumsaetze, ES_Matchcode, ES_Bezeichnung), l2, hoehe + 5, s5 - s2, 80)if ( ES_EAN <> "")DrawLine(s2, AREA_CURRENTHEIGHT + 20, s5, AREA_CURRENTHEIGHT + 20)DrawText("EAN: " + ES_EAN, l2, AREA_CURRENTHEIGHT + 10, s5 - s2, 80)endifendifendifif ( DETAIL_ANSICHT and ES_Zeilenart = ES_Detailzeile )DrawText(IfThen(ES_DetailAuswertungsArt = ES_Kundenumsaetze, ES_Matchcode, ES_Bezeichnung), l1, hoehe + 5, s5 - s1 - 20, 40, ALIGN_RIGHT)endifif ( ES_Zeilenart = ES_Positionszeile or ES_Zeilenart = ES_Summenzeile or (DETAIL_ANSICHT and ES_Zeilenart = ES_Detailzeile) )if ( ES_AuswertungsArt = ES_Artikelumsaetze)DrawText(Format(ES_UmsatzP1/100, FORMATBETRAG), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)elseDrawText(Format(ES_AnzahlP1/10000, FORMATANZAHL), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)endifif ( ES_AuswertungsArt = ES_Artikelumsatzstueck OR ES_AuswertungsArt = ES_Kundenumsaetze )DrawText(Format(ES_UmsatzP1/100, FORMATBETRAG), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)elseDrawText(Format(ES_ProzentP1, FORMATBETRAGLEER), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)endifendifendifset firstPos to FALSE'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)if ( not sumDetailPos )DrawLine(s1, 0, s7, 0)endif#BeginTableFooterSetArea(10)DrawLine(s1, 0, s7, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'VKStatistik'' -----------------------------------------------------------------------------------------0000011