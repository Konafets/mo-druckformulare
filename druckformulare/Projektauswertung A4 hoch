00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000025Projektauswertung A4 hoch0000041021000004true000004true00000100000010000087Ausführliche Projektauswertung mit Projektinformationen, Vorgangsübersicht und Ergebnis009804'-----------------------------------------------------------------------------------------'' Formular : Projektauswertung im Format A4 hoch' Historie : 01/11/2016: sts Initialversion''-----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Projektauswertung in " + App_GJWaehrung' Allgemeine Konstantenconst WHITE            as color  = RGBColor(255,255,255)const GRAY             as color  = RGBColor(240,240,240)const FORMATBETRAGROW  as text = "#.00;-#.00;\-\,\-\-"const MAX_POS_HEIGHT   as number = 300' Elementartconst KOSTEN_KALKULIERT   as number = 1const KOSTEN_BERECHNET    as number = 2const ERLOESE_KALKULIERT  as number = 3const ERLOESE_BERECHNET   as number = 4const ERGEBNIS            as number = 5' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 7 Spaltendim anzahlSpalten as number = 7dim s1 as number = 0                ' Anfang Spalte Datumdim s2 as number = 180              ' Anfang Spalte Vorgangdim s3 as number = 400              ' Anfang Spalte BelegNrdim s4 as number = 650              ' Anfang Spalte Firmadim s5 as number = 1000             ' Anfang Spalte Betreffdim s6 as number = 1350             ' Anfang Spalte Betrag Bruttodim s7 as number = 1550             ' Anfang Spalte Bezahlt Bruttodim s8 as number = LAYOUTWIDTH#include "TEMPLATE Table"' Variablen definierendim hoehe          as numberdim breite         as numberdim rowHeight      as numberdim links1         as numberdim links2         as number'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(PROJEKT_Filter, 0, 150, LAYOUTWIDTH, 100)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"#BeginGraphicsTextSetArea(600, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 80set breite to 350set links1 to 0set links2 to 800SetTextBold(true)SetTextSize(11)DrawText(PROJEKT_Bezeichnung, links1, hoehe, LAYOUTWIDTH, 50)SetTextSize(9)set hoehe to AREA_CURRENTHEIGHT + 20SetTextBold(true)DrawText("Projektnummer:", links1, hoehe, breite, 40)SetTextBold(false)DrawText(PROJEKT_Nummer, links1 + breite, hoehe, links2 - links1 - breite, 40)set hoehe to AREA_CURRENTHEIGHT + 10SetTextBold(true)DrawText("Beschreibung:", links1, hoehe, breite, 40)SetTextBold(false)DrawText(PROJEKT_Beschreibung, links1 + breite, hoehe, LAYOUTWIDTH - breite, 40)set hoehe to AREA_CURRENTHEIGHT + 20SetTextBold(true)DrawText("Startdatum:", links1, hoehe, breite, 40)SetTextBold(false)DrawText(IfThen(GetPlatform = 1, MediumDate(PROJEKT_DatumStart), ShortDate(PROJEKT_DatumStart)), links1 + breite, hoehe, links2 - links1 - breite, 40)SetTextBold(true)DrawText("Bearbeiter:", links2, hoehe, breite, 40)SetTextBold(false)DrawText(PROJEKT_Bearbeiter, links2 + breite, hoehe, LAYOUTWIDTH - links2 - breite, 40)set hoehe to AREA_CURRENTHEIGHT + 10SetTextBold(true)DrawText("Enddatum:", links1, hoehe, breite, 40)SetTextBold(false)if ( DateToNumber(PROJEKT_DatumEnde) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(PROJEKT_DatumEnde), ShortDate(PROJEKT_DatumEnde)), links1 + breite, hoehe, links2 - links1 - breite, 40)endifSetTextBold(true)DrawText("Status:", links2, hoehe, breite, 40)SetTextBold(false)DrawText(PROJEKT_Status, links2 + breite, hoehe, LAYOUTWIDTH - links2 - breite, 40)#BeginGraphicsTextSetArea(130)#include "STYLE Arial 9, normal"set hoehe to 80set breite to 350set links1 to 0set links2 to links1 + breiteSetTextBold(true)DrawText("Vorgangsübersicht:", links1, hoehe, breite, 50)SetTextBold(false)if ( not HasTable("Vorgaenge") )DrawText("keine Vorgänge vorhanden", links2, hoehe, LAYOUTWIDTH - links2, 50)endif'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Vorgaenge''-----------------------------------------------------------------------------------------#BeginTableHeaderif ( HasTable("Vorgaenge") )SetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Vorgaenge")DrawLine(s1, 0, s8, 0)DrawVerticalLine(s1)DrawText("Datum", l1, 5, b1, 40)DrawVerticalLine(s2)DrawText("Vorgang", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("BelegNr", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Firma", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Betreff", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Betrag", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("Bezahlt", l7, 5, b7, 40)DrawVerticalLine(s8)endif'-----------------------------------------------------------------------------------------#BeginTableRowif ( HasTable("Vorgaenge") )SetArea(MAX_POS_HEIGHT, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"DrawLine(s1, 0, s8, 0)DrawVerticalLine(s1)DrawText(IfThen(GetPlatform = 1, MediumDate(VORGANG_Datum), ShortDate(VORGANG_Datum)), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(VORGANG_Bezeichnung, l2, 5, b2, 40)DrawVerticalLine(s3)DrawText(VORGANG_BelegNr, l3, 5, b3, 40)DrawVerticalLine(s4)DrawText(VORGANG_FirmaMatchcode, l4, 5, b4, 40)DrawVerticalLine(s5)DrawText(VORGANG_Betreff, l5, 5, b5, 40)DrawVerticalLine(s6)DrawText(Format(VORGANG_BetragBrutto, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(VORGANG_Bezahlt, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)endif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakif ( HasTable("Vorgaenge") )SetArea(10)DrawLine(s1, 0, s8, 0)endif#BeginTableFooterif ( HasTable("Vorgaenge") )SetArea(10)DrawLine(s1, 0, s8, 0)endif' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Vorgaenge'' -----------------------------------------------------------------------------------------'-----------------------------------------------------------------------------------------' Beginn der Ergebnisausgabe'-----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(130)set hoehe to 80set links1 to 0SetTextBold(true)SetTextSize(9)DrawText("Ergebnis:", links1, hoehe, LAYOUTWIDTH, 50)'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Ergebnis''-----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Ergebnis")set s3 to 750              ' Anfang Spalte Netto kalkuliertset s4 to 950              ' Anfang Spalte Brutto kalkuliertset s5 to 1150             ' Anfang Spalte Netto berechnetset s6 to 1350             ' Anfang Spalte Brutto berechnetset s7 to 1550             ' Anfang Spalte Bezahlt#include "TEMPLATE Table"DrawLine(s1, 0, s8, 0)DrawVerticalLine(s1)DrawVerticalLine(s3)DrawText("Netto", l3, 5, b3, 40)DrawText("(kalkuliert)", l3, 45, b3, 40)DrawVerticalLine(s4)DrawText("Brutto", l4, 5, b4, 40)DrawText("(kalkuliert)", l4, 45, b4, 40)DrawVerticalLine(s5)DrawText("Netto", l5, 5, b5, 40)DrawText("(berechnet)", l5, 45, b5, 40)DrawVerticalLine(s6)DrawText("Brutto", l6, 5, b6, 40)DrawText("(berechnet)", l6, 45, b6, 40)DrawVerticalLine(s7)DrawText("Bezahlt", l7, 5, b7, 40)DrawVerticalLine(s8)#BeginTableRowSetArea(100, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"SetFillColor(GRAY)if ( ERGEBNIS_Element = KOSTEN_KALKULIERT or ERGEBNIS_Element = ERLOESE_KALKULIERT )FillAreaVertical(s5,s8)DrawText(ERGEBNIS_Bezeichnung + ":", l1, 5, s3 - s1 - 20, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_KalkuliertNetto, FORMATBETRAGROW), l3, 5, b3, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_KalkuliertBrutto, FORMATBETRAGROW), l4, 5, b4, 40, ALIGN_RIGHT)endifif ( ERGEBNIS_Element = KOSTEN_BERECHNET or ERGEBNIS_Element = ERLOESE_BERECHNET )FillAreaVertical(s3,s5)DrawText(ERGEBNIS_Bezeichnung + ":", l1, 5, s3 - s1 - 20, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_BerechnetNetto, FORMATBETRAGROW), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_BerechnetBrutto, FORMATBETRAGROW), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_Bezahlt, FORMATBETRAGROW), l7, 5, b7, 40, ALIGN_RIGHT)endifif ( ERGEBNIS_Element = ERGEBNIS )SetTextBold(true)DrawLine(s1, 0, s8, 0)DrawText(ERGEBNIS_Bezeichnung + ":", l1, 5, s3 - s1 - 20, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_KalkuliertNetto, FORMATBETRAGNULL), l3, 5, b3, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_KalkuliertBrutto, FORMATBETRAGNULL), l4, 5, b4, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_BerechnetNetto, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_BerechnetBrutto, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(ERGEBNIS_Bezahlt, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)endifif ( ERGEBNIS_Element = KOSTEN_KALKULIERT or ERGEBNIS_Element = KOSTEN_BERECHNET )DrawLine(s1, 0, s8, 0)endifDrawVerticalLine(s1)DrawVerticalLine(s3)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)DrawVerticalLine(s8)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s8, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s8, 0)'-----------------------------------------------------------------------------------------' Ende der Tabelle 'Ergebnis''-----------------------------------------------------------------------------------------0000011