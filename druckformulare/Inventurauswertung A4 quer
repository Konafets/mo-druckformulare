00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000026Inventurauswertung A4 quer0000043010000004true000004true00000100000010000048Auswertung der Artikelinventur im Format A4 quer005539' -----------------------------------------------------------------------------------------'' Formular : Inventurauswertung im Format A4 quer' Historie : 17.07.2018: Initialversion, AS'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text    = "Inventurauswertung " + INVENTUR_BELEGNRconst FORMATMENGE as text = "#." + Left("0000", Firma_FakturaNKMenge) + ";-" + "#." + Left("0000", Firma_FakturaNKMenge) + ";"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************const LAYOUTLEFT       as number = 100' Variablen definierendim row           as number = 0dim vorgangText   as Text   = ""dim hoehe         as numberdim breite        as numberdim links1        as numberdim links2        as numberdim zab           as numberdim tab           as numberdim lastEbene     as number = -1' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 9 Spaltendim anzahlSpalten as number = 9dim s1 as number = 0dim s2 as number = 800dim s3 as number = 1100dim s4 as number = 1310dim s5 as number = 1490dim s6 as number = 1670dim s7 as number = 1850dim s8 as number = 2100dim s9 as number = 2350dim s10 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"#BeginGraphicsTextSetArea(150)#include "STYLE Arial 8, fett"set hoehe to 0set zab to 45set links1 to LAYOUTLEFT + 430set links2 to links1 + 280set breite to 800DrawText("Inventur-Nr.:", links1, hoehe, links2 - links1, 50)DrawText(INVENTUR_BELEGNR, links2, hoehe, breite, 50)set hoehe to hoehe + zabDrawText("Bezeichnung:", links1, hoehe, links2 - links1, 50)DrawText(INVENTUR_BEZEICHNUNG, links2, hoehe, breite, 50)set hoehe to 0set links1 to links2 + breite + 20set links2 to links1 + 180set breite to PAGE_WIDTH - links2DrawText("Beginn:", links1, hoehe, links2 - links1, 50)DrawText(MediumDate(INVENTUR_BEGINN), links2, hoehe, breite, 50)set hoehe to hoehe + zabDrawText("Ende:", links1, hoehe, links2 - links1, 50)if ( DateToNumber(INVENTUR_ENDE) > 0 )DrawText(MediumDate(INVENTUR_ENDE), links2, hoehe, breite, 50)endif'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Inventurauswertung'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Inventurauswertung")DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawText("Bezeichnung", l1, 5, b1, 70)DrawVerticalLine(s2)DrawText("Artikelnr", l2, 5, b2, 160, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Status", l3, 5, b3, 50, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Soll", l4, 5, b4, 50, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Ist", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Soll-Ist Diff", l6, 5, b6, 80, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("EK Soll", l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("EK Ist", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("EK Diff", l9, 5, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawVerticalLine(s1)SetTextColor(RGBColor(0, 0, 0))if (ART_EbeneNr = ART_EbeneWarengruppe)SetTextBold(true)set tab to 0set hoehe to 0elseset hoehe to 0SetTextBold(false)DrawVerticalLine(s2)DrawText(ART_ArtikelNr, l2, hoehe + 5, b2, 100)DrawVerticalLine(s3)DrawText(ART_Status, l3, hoehe + 5, b3, 100, ALIGN_CENTER)set tab to 50endifDrawLine(s1, 0, s10, 0)SetLineWidth(1)DrawText(ART_Bezeichnung, l1 + tab, hoehe + 5, b1-tab, 100)DrawVerticalLine(s4)DrawText(ART_SollBestand, l4, hoehe + 5, b4, 160, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(ART_IstBestand, l5, hoehe + 5, b5, 160, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(ART_SollIstDiff, l6, hoehe + 5, b6, 160, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(ART_EKNettoSoll, l7, hoehe + 5, b7, 160, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(ART_EKNettoIst, l8, hoehe + 5, b8, 160, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(ART_EKNettoDiff, l9, hoehe + 5, b9, 160,ALIGN_RIGHT)DrawVerticalLine(s10)set lastEbene to ART_EbeneNr'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s10, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s10, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Inventurauswertung'' -----------------------------------------------------------------------------------------0000012