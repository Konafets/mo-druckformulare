00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000028TEMPLATE Briefpapier A4 hoch000002-1000004true000004true00000100000010000000009645' -----------------------------------------------------------------------------------------' Definition für das (Hintergrund-) Briefpapier im A4-Format:'' Dieses Script wird vom Auftragsformular und vom Mahnungsformular verwendet. Um eigene' Anpassungen vorzunehmen, duplizieren Sie das Script und geben dem Duplikat einen neuen' Namen. Anschließend müssen die Aufrufe '#include "TEMPLATE Briefpapier A4 hoch"' im' Auftragsformular und vom Mahnungsformular entsprechend angepasst werden.' -----------------------------------------------------------------------------------------'' Historie: 08/09/2008: at Initialversion' Geändert: 01/04/2010: sts (Konstanten zum Ein- und Ausblenden von Absenderzeile, Fusszeile, Loch- und Falzmarken,'                       Ausgabe der Fusszeile block- oder zeilenweise)'           05/12/2013: sts (Ausgabeform 3. und 4. Block, Ausgabe Bankverbindung Kontonr./Blz oder IBAN/BIC oder beides)'           22/07/2016: sts (Abfrage der Tabellenbezeichnung für Ausgabe des Mahntitels auf Folgeseiten hinzugefügt,'                       Startposition für Ausgabe der Fusszeilen erhöht, neue Variable 'fuss_topPos')' -----------------------------------------------------------------------------------------'******************************************************************************************' Variablen zum Ein- und Ausblenden bestimmter Elementeif ( not HasVariable("absenderzeile") )dim absenderzeile as booleanendifif ( not HasVariable("fussbereich") )dim fussbereich as booleanendifif ( not HasVariable("fuss_block") )dim fuss_block as booleanendifif ( not HasVariable("linien_marken") )dim linien_marken as booleanendifif ( not HasVariable("linien_fussblock") )dim linien_fussblock as booleanendifif ( not HasVariable("fuss_breite") )dim fuss_breite as numberendifif ( not HasVariable("fuss_topPos") )dim fuss_topPos as numberendif'Elemente ein- oder ausblenden (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)set absenderzeile    to TRUE  'Absenderzeile und Linie über dem Adressfeldset linien_marken    to TRUE  'Loch- und Falzmarkenset fussbereich      to TRUE  'Firmenangaben im Fussbereichset fuss_block       to FALSE 'Fussbereich blockweise ausgebenset linien_fussblock to FALSE 'Linien zwischen den einzelnen Blöcken im Fussbereich'******************************************************************************************if ( HasField("BRIEF_AusgabeFAX") )if ( BRIEF_AusgabeFAX )set absenderzeile to FALSEendifendif#include "STYLE Arial 9, normal"set links1 to LAYOUTLEFTif ( PAGE_NUMBER = 1 )' Kopfbereich 1. Seite' Logo einbinden (optional): Logos sollten im Tiff-Format mit 300 dpi gespeichert werden, die' Konvertierung in eine davon abweichende Druckerauflösung erfolgt automatisch.' Alle im Formular benötigten Grafiken müssen in der Bilderverwaltung unter Vorgaben/Bilder' vorhanden sein.' DrawPicture("logo.tif", 700, 0)' Absenderzeileif ( absenderzeile )set hoehe to 360SetTextSize(7)set abZ to Firma_Name + SEP + Firma_Strasse + SEP + Firma_Plz + " " + Firma_Ortset abZ to IfThen(Firma_FALand <> "Keine Angabe", abZ + SEP + Firma_FALand, abZ)DrawText(abZ, links1, hoehe, 800, 60)DrawLine(links1, hoehe + 60, links1 + 800, hoehe + 60)set hoehe to hoehe + 90endifelse' Kopfbereich Folgeseiten' Logo' DrawPicture("logo.tif", 700, 0)' Auftrags-Nr und Seiten-Nrset hoehe to 200SetTextBold(true)if ( HasTable("Positionen") )' Titel und Seitennummer beim Auftragsformularif (HasField("AUF_AuftragsNr"))DrawText(titel + " Nr. " + AUF_AuftragsNr, links1, hoehe, LAYOUTWIDTH, 40)else' Titel beim BestellformularDrawText(titel + " Nr. " + BESTELL_BestellNr, links1, hoehe, LAYOUTWIDTH, 40)endifelseif ( HasTable("Offene Posten") )' Titel und Seitennummer beim MahnformularDrawText(mahntitel, links1, hoehe, LAYOUTWIDTH, 40)endifSetTextBold(false)set hoehe to hoehe + 40DrawText("Seite " + NumToText(PAGE_NUMBER), links1, hoehe, LAYOUTWIDTH, 40)endif' Falz- und Lochermarkierungen zeichnenif ( linien_marken )SetLineColor(BLACK)SetLineWidth(1)DrawLine(0, 850, 30, 850)DrawLine(0, 1330, 30, 1330)endif' Fussbereichif ( fussbereich )set fuss_topPos to PAGE_HEIGHT - FOOTER_HEIGHT + 70set hoehe to fuss_topPosSetTextSize(7)set stNr to Case(Firma_UStIDNummer <> "", "UStID: " + Firma_UStIDNummer, Firma_FASteuernummer <> "", "Steuer-Nr.: " + Firma_FASteuernummer, "")if ( fuss_block )' 1. Blockset fuss_breite to 475set breite to fuss_breite - 20DrawText(Firma_Name, links1, hoehe, breite, 30)if ( Firma_Zusatz <> "" )set hoehe to hoehe + 30DrawText(Firma_Zusatz, links1, hoehe, breite, 30)endifif ( Firma_Geschaeftsfuehrer <> "" )set hoehe to hoehe + 30DrawText("Geschäftsführer: " + Firma_Geschaeftsfuehrer, links1, hoehe, breite, 30)endifif ( stNr <> "" )set hoehe to hoehe + 30DrawText(stNr, links1, hoehe, breite, 30)endifif ( Firma_RegisterGericht <> "" )set hoehe to hoehe + 30DrawText(Firma_RegisterGericht, links1, hoehe, breite, 30)if ( Firma_RegisterNummer <> "" )set hoehe to hoehe + 30DrawText(Firma_RegisterNummer, links1, hoehe, breite, 30)endifendifif ( linien_fussblock )DrawLine(links1 + fuss_breite - 10, fuss_topPos, links1 + fuss_breite - 10, PAGE_HEIGHT)endif' -----------------------------------------------------------------------------' 2. Blockset links1 to links1 + fuss_breiteset fuss_breite to 375set breite to fuss_breite - 20set hoehe to fuss_topPosDrawText(Firma_Strasse, links1, hoehe, breite, 30)set hoehe to hoehe + 30DrawText(Firma_Plz + " " + Firma_Ort, links1, hoehe, breite, 30)if ( Firma_FALand <> "" )set hoehe to hoehe + 30DrawText(Firma_FALand, links1, hoehe, breite, 30)endifif ( linien_fussblock )DrawLine(links1 + fuss_breite - 10, fuss_topPos, links1 + fuss_breite - 10, PAGE_HEIGHT)endif' -----------------------------------------------------------------------------' 3. Blockset links1 to links1 + fuss_breiteset links2 to links1 + 120set fuss_breite to 425set breite to links1 + fuss_breite - links2 - 20set hoehe to fuss_topPosDrawText("Telefon:", links1, hoehe, links2 - links1, 30)DrawText(Firma_Telefon, links2, hoehe, breite, 30)if ( Firma_Telefax <> "" )set hoehe to hoehe + 30DrawText("Fax:", links1, hoehe, links2 - links1, 30)DrawText(Firma_Telefax, links2, hoehe, breite, 30)endifif ( Firma_Email <> "" )set hoehe to hoehe + 30DrawText("E-Mail:", links1, hoehe, links2 - links1, 30)DrawText(Firma_Email, links2, hoehe, breite, 30)endifif ( Firma_Internet <> "" )set hoehe to hoehe + 30DrawText("Internet:", links1, hoehe, links2 - links1, 30)DrawText(Firma_Internet, links2, hoehe, breite, 30)endifif ( linien_fussblock )DrawLine(links1 + fuss_breite - 10, fuss_topPos, links1 + fuss_breite - 10, PAGE_HEIGHT)endif' -----------------------------------------------------------------------------' 4. Blockset links1 to links1 + fuss_breiteset links2 to links1 + 90set fuss_breite to 475set breite to links1 + fuss_breite - links2 - 20set hoehe to fuss_topPosif ( (Firma_BankKonto <> "" and Firma_BankBlz <> "") or (Firma_BankIBAN <> "" and Firma_BankBIC <> "") )if ( Firma_BankName <> "" )DrawText("Bank:", links1, hoehe, links2 - links1, 30)DrawText(Firma_BankName, links2, hoehe, breite, 30)set hoehe to hoehe + 30endifif (Firma_BankKonto <> "" and Firma_BankBlz <> "")DrawText("Konto:", links1, hoehe, links2 - links1, 30)DrawText(Firma_BankKonto, links2, hoehe, breite, 30)set hoehe to hoehe + 30DrawText("Blz:", links1, hoehe, links2 - links1, 30)DrawText(Firma_BankBlz, links2, hoehe, breite, 30)set hoehe to hoehe + 30endifif ( Firma_BankIBAN <> "" and Firma_BankBIC <> "" )DrawText("IBAN:", links1, hoehe, links2 - links1, 30)DrawText(Firma_BankIBAN, links2, hoehe, breite, 30)set hoehe to hoehe + 30DrawText("BIC:", links1, hoehe, links2 - links1, 30)DrawText(Firma_BankBIC, links2, hoehe, breite, 30)endifendifset links1 to LAYOUTLEFTelseset fz1 to Firma_Nameset fz1 to IfThen(Firma_Zusatz <> "", fz1 + SEP + Firma_Zusatz, fz1)set fz1 to IfThen(stNr <> "", fz1 + SEP + stNr, fz1)DrawText(fz1, links1, hoehe, LAYOUTWIDTH, 30, ALIGN_CENTER)set fz2 to Firma_Strasse + SEP + Firma_Plz + " " + Firma_Ortset fz2 to IfThen(Firma_FALand <> "Keine Angabe", fz2 + SEP + Firma_FALand, fz2)set fz2 to IfThen(Firma_Geschaeftsfuehrer <> "", fz2 + SEP + "Geschäftsführer: " + Firma_Geschaeftsfuehrer, fz2)if ( Firma_RegisterGericht <> "" )set fz2 to fz2 + SEP + Firma_RegisterGerichtset fz2 to IfThen(Firma_RegisterNummer <> "", fz2 + ", " + Firma_RegisterNummer, fz2)endifDrawText(fz2, links1, hoehe + 30, LAYOUTWIDTH, 30, ALIGN_CENTER)set fz3 to "Telefon: " + Firma_Telefonset fz3 to IfThen(Firma_Telefax <> "", fz3 + SEP + "Fax: " + Firma_Telefax, fz3)set fz3 to IfThen(Firma_Email <> "", fz3 + SEP + "E-Mail: " + Firma_Email, fz3)set fz3 to IfThen(Firma_Internet <> "", fz3 + SEP + "Internet: " + Firma_Internet, fz3)DrawText(fz3, links1, hoehe + 60, LAYOUTWIDTH, 30, ALIGN_CENTER)if ( (Firma_BankKonto <> "" and Firma_BankBlz <> "") or (Firma_BankIBAN <> "" and Firma_BankBIC <> "") )set fz4 to IfThen(Firma_BankName <> "", "Bank: " + Firma_BankName, "")set fz4 to IfThen(Firma_BankKonto <> "" and Firma_BankBlz <> "", IfThen(fz4 <> "", fz4 + SEP, "") + "Konto: " + Firma_BankKonto + SEP + "Blz: " + Firma_BankBlz , fz4)set fz4 to IfThen(Firma_BankIBAN <> "" and Firma_BankBIC <> "", IfThen(fz4 <> "", fz4 + SEP, "") + "IBAN: " + Firma_BankIBAN + SEP + "BIC: " + Firma_BankBIC, fz4)DrawText(fz4, links1, hoehe + 90, LAYOUTWIDTH, 30, ALIGN_CENTER)endifendifendif0000011