00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000023BWA vollständig A4 quer0000042009000004true000004true00000100000010000077Betriebswirtschaftliche Auswertung, Kostenstatistik + Bewegungsbilanz A4 quer007406' -----------------------------------------------------------------------------------------'' Formular : BWA vollständig im Format A4 quer' Historie : 1/08/2007: Initialversion vs' Geändert : 14.08.2007: vs'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Betriebswirtschaftliche Auswertung in " + App_GJWaehrungdim BWATeil  as text = "A. Kostenstatistik"' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 11 Spaltendim anzahlSpalten as number = 11dim s1 as number = 0dim s2 as number = 530dim s3 as number = 810dim s4 as number = 1010dim s5 as number = 1190dim s6 as number = 1390dim s7 as number = 1570dim s8 as number = 1860dim s9 as number = 2040dim s10 as number = 2220dim s11 as number = 2400dim s12 as number = LAYOUTWIDTH#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(BWA_Filter, 0, 150, LAYOUTWIDTH, 50)'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Betriebswirtschaftliche Auswertung'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(160)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("BWA")SetTextSize(12)if(BWATeil = "A. Kostenstatistik" )DrawText("A. Kostenstatistik", s1+20, 25, b1, 50, ALIGN_LEFT)endifif(BWATeil = "B. Bewegungsbilanz" )DrawText("B. Bewegungsbilanz", s1+20, 25, b1, 50, ALIGN_LEFT)endifif(BWATeil = "A. Kostenstatistik" )DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)SetTextSize(10)DrawText("Periodenwerte", s2, 25, s7-s2, 50)DrawVerticalLine(s2)DrawText("Kumulierte Werte", s7, 25, s12-s7, 50)SetTextSize(8)DrawText("Saldo", s2, 80, b2, 100)DrawLine(s3,80,s3,160)DrawText("% Ges.- Leistung", s3, 80, b3, 100)DrawLine(s4,80,s4,160)DrawText("% Ges.- Kosten", s4, 80, b4, 100)DrawLine(s5,80,s5,160)DrawText("% Pers.- Kosten", s5, 80, b5, 100)DrawLine(s6,80,s6,160)DrawText("Aufschl.", s6, 80, b6, 100)DrawVerticalLine(s7)DrawText("Saldo", s7, 80, b7, 100)DrawLine(s8,80,s8,160)DrawText("% Ges.- Leistung", s8, 80, b8, 100)DrawLine(s9,80,s9,160)DrawText("% Ges.- Kosten", s9, 80, b9, 100)DrawLine(s10,80,s10,160)DrawText("% Pers.- Kosten", s10, 80, b10, 100)DrawLine(s11,80,s11,160)DrawText("Aufschl.", s11, 80, b11, 100)DrawVerticalLine(s12)endifif(BWATeil = "B. Bewegungsbilanz" )DrawLine(s1, 0, s6, 0)DrawVerticalLine(s1)SetTextSize(10)DrawText("Mittelverwendung", s2, 25, s4-s2, 50)DrawVerticalLine(s2)DrawText("Mittelherkunft", s4, 25, s6-s4, 50)DrawVerticalLine(s4)SetTextSize(8)DrawText("erh. Aktiva", s2, 80, b2, 50)DrawText("mind. Passiva", s2, 115, b2, 100)DrawLine(s3,80,s3,160)DrawText("%", s3, 80, b3, 100)DrawText("erh. Passiva", s4, 80, b4, 100)DrawText("mind. Aktiva", s4, 115, b4, 100)DrawLine(s5,80,s5,160)DrawText("%", s5, 80, b5, 100)DrawVerticalLine(s6)endif#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if( BWA_EbeneNr = 2 AND BWATeil = "A. Kostenstatistik" )DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)SetTextBold(true)DrawText(BWA_Text, l1, 10, b1, 300, ALIGN_LEFT)DrawVerticalLine(s2)DrawText(Format(BWA_SaldoP1, FORMATBETRAGLEER), l2, 5, b2, 40, ALIGN_RIGHT)DrawVerticalLine(s3)DrawText(Format(BWA_GLP1, FORMATBETRAGLEER), l3, 5, b3, 40, ALIGN_RIGHT)DrawVerticalLine(s4)DrawText(Format(BWA_GKP1, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(BWA_PKP1, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(BWA_ASP1, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(BWA_SaldoP2, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(BWA_GLP2, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(BWA_GKP2, FORMATBETRAGLEER), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(BWA_PKP2, FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(Format(BWA_ASP2, FORMATBETRAGLEER), l11, 5, b11, 40, ALIGN_RIGHT)DrawVerticalLine(s12)SetTextBold(false)endifif( BWA_EbeneNr = 2 AND BWATeil = "B. Bewegungsbilanz" )DrawLine(s1, 0, s6, 0)DrawVerticalLine(s1)SetTextBold(true)DrawText(BWA_Text, l1, 10, b1, 300, ALIGN_LEFT)DrawVerticalLine(s2)DrawText(Format(BWA_MVSaldo, FORMATBETRAGLEER), l2, 5, b2, 40, ALIGN_RIGHT)DrawVerticalLine(s3)DrawText(Format(BWA_MVProz, FORMATBETRAGLEER), l3, 5, b3, 40, ALIGN_RIGHT)DrawVerticalLine(s4)DrawText(Format(BWA_MHSaldo, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(BWA_MHProz, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)SetTextBold(false)endifif( BWA_EbeneNr = 3 AND BWATeil = "A. Kostenstatistik" )DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText(BWA_Text, l1+30, 10, b1-30, 300, ALIGN_LEFT)DrawVerticalLine(s2)DrawText(Format(BWA_SaldoP1, FORMATBETRAGLEER), l2, 5, b2-30, 40, ALIGN_RIGHT)DrawVerticalLine(s3)DrawText(Format(BWA_GLP1, FORMATBETRAGLEER), l3, 5, b3-30, 40, ALIGN_RIGHT)DrawVerticalLine(s4)DrawText(Format(BWA_GKP1, FORMATBETRAGLEER), l4, 5, b4-30, 40, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(BWA_PKP1, FORMATBETRAGLEER), l5, 5, b5-30, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(BWA_ASP1, FORMATBETRAGLEER), l6, 5, b6-30, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(BWA_SaldoP2, FORMATBETRAGLEER), l7, 5, b7-30, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(BWA_GLP2, FORMATBETRAGLEER), l8, 5, b8-30, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(BWA_GKP2, FORMATBETRAGLEER), l9, 5, b9-30, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(BWA_PKP2, FORMATBETRAGLEER), l10, 5, b10-30, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(Format(BWA_ASP2, FORMATBETRAGLEER), l11, 5, b11-30, 40, ALIGN_RIGHT)DrawVerticalLine(s12)endifif(BWA_Text = "B. Bewegungsbilanz")set BWATeil to ""endifif( BWA_EbeneNr = 3 AND BWATeil = "B. Bewegungsbilanz" )DrawLine(s1, 0, s6, 0)DrawVerticalLine(s1)DrawText(BWA_Text, l1+30, 10, b1-30, 300, ALIGN_LEFT)DrawVerticalLine(s2)DrawText(Format(BWA_MVSaldo, FORMATBETRAGLEER), l2, 5, b2-30, 40, ALIGN_RIGHT)DrawVerticalLine(s3)DrawText(Format(BWA_MVProz, FORMATBETRAGLEER), l3, 5, b3-30, 40, ALIGN_RIGHT)DrawVerticalLine(s4)DrawText(Format(BWA_MHSaldo, FORMATBETRAGLEER), l4, 5, b4-30, 40, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(BWA_MHProz, FORMATBETRAGLEER), l5, 5, b5-30, 40, ALIGN_RIGHT)DrawVerticalLine(s6)endifif(BWA_Text = "B. Bewegungsbilanz")set BWATeil to BWA_Textset anzahlSpalten to 5set s1 to 0set s2 to 800set s3 to 1250set s4 to 1700set s5 to 2150set s6 to LAYOUTWIDTH#include "TEMPLATE Table"PageBreak(true)endif#BeginTableBreakSetArea(10)DrawLine(s1, 0, s12, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s12, 0)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------0000012