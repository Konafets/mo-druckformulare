00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000049OP-Zahlungen Debitoren A4 quer mit Fremdwährungen0000041005000004true000004true00000100000010000049OP-Zahlungen Debitoren A4 quer mit Fremdwährungen005316' -----------------------------------------------------------------------------------------'' Formular : OP-Zahlungen Debitoren A4 quer mit Fremdwährungen' Historie : 28.08.2007: Initialversion vs' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "OP-Zahlungen Debitoren mit Fremdwährungen"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim summeZahlung      as numberdim summeMinderung    as numberdim summeZahlungFW    as numberdim summeMinderungFW  as numberdim row               as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 11 Spaltendim anzahlSpalten as number = 11dim s1 as number = 0dim s2 as number = 180dim s3 as number = 700dim s4 as number = 830dim s5 as number = 1130dim s6 as number = 1250dim s7 as number = 1400dim s8 as number = 1600dim s9 as number = 1850dim s10 as number = 2100dim s11 as number = 2350dim s12 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(DZ_ReArt_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'OP-Zahlungen Debitoren'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("OP-Zahlungen Debitoren")DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText("Datum", s1, 5, s2-s1, 40)DrawVerticalLine(s2)DrawText("Debitor", l2-5, 5, b2+10, 40)DrawVerticalLine(s3)DrawText("Deb.-Ko.", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Re.-Nr.", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Währung", l5, 5, b5, 300)DrawVerticalLine(s6)DrawText("Kurs", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("Zahlungsart", l7, 5, b7, 40)DrawVerticalLine(s8)DrawText("Gesamt SW", l8, 5, b8, 40)DrawVerticalLine(s9)DrawText("Minderung SW", l9, 5, b9, 40)DrawVerticalLine(s10)DrawText("Gesamt FW", l10, 5, b10, 40)DrawVerticalLine(s11)DrawText("Minderung FW", l11, 5, b11, 40)DrawVerticalLine(s12)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 0 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText(DateToText(DZ_Datum), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(DZ_AdrMatchcode, l2, 5, b2, 300, ALIGN_LEFT)DrawVerticalLine(s3)DrawText(Format(DZ_Personenkonto, FORMATKONTO), l3, 5, b3, 40, ALIGN_RIGHT)DrawVerticalLine(s4)DrawText(DZ_RechnNr, l4, 5, b4, 300, ALIGN_LEFT)DrawVerticalLine(s5)DrawText(DZ_Waehrung, l5, 5, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText(Format(DZ_Kurs, FORMATKURSNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)if(DZ_Zahlungsart = DZ_Zahlart_Keine)DrawText("Keine", l7, 5, b7, 40, ALIGN_CENTER)elseif(DZ_Zahlungsart = DZ_Zahlart_Bar)DrawText("Bar", l7, 5, b7, 40, ALIGN_CENTER)elseif(DZ_Zahlungsart = DZ_Zahlart_Lastschrift)DrawText("Lastschrift", l7, 5, b7, 40, ALIGN_CENTER)elseif(DZ_Zahlungsart = DZ_Zahlart_Kreditkarte)DrawText("Kreditkarte", l7, 5, b7, 40, ALIGN_CENTER)elseif(DZ_Zahlungsart = DZ_Zahlart_Ueberweisung)DrawText("Überweisung", l7, 5, b7, 40, ALIGN_CENTER)elseif(DZ_Zahlungsart = DZ_Zahlart_Scheck)DrawText("Scheck", l7, 5, b7, 40, ALIGN_CENTER)endifDrawVerticalLine(s8)DrawText(Format(DZ_GesamtZahlSW, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(DZ_GesamtMindSW, FORMATBETRAGLEER), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(IfThen(DZ_Waehrung<>App_GJWaehrung, DZ_GesamtZahlFW, 0), FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(Format(IfThen(DZ_Waehrung<>App_GJWaehrung, DZ_GesamtMindFW, 0), FORMATBETRAGLEER), l11, 5, b11, 40, ALIGN_RIGHT)DrawVerticalLine(s12)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s12, 0)#BeginTableFooter#include "STYLE Arial 8, fett"SetArea(42)DrawLine(s1, 0, s12, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'OP-Zahlungen Debitoren'' -----------------------------------------------------------------------------------------0000012