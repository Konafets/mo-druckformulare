00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000039Kostenstellenauswertung einzeln A4 hoch0000042010000004true000004true00000100000010000040Kostenstellenauswertung einzeln  A4 hoch003661' -----------------------------------------------------------------------------------------'' Formular : Kostenstellenauswertung im Format A4 hoch' Historie : 21.08.2007: Initialversion vs' Ge채ndert : 21.05.2012: StS (Textausgabebreite bei Buchungstext ge채ndert)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Kostenstellenauswertung in " + App_GJWaehrung' Templates f체r Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen f체r die Positionen der 4 Spaltendim ksFolgt as boolean = truedim delta as number = 100dim linie as boolean = falsedim hoehe as numberdim AnzahlSpalten as number = 8dim s1 as number = 0dim s2 as number = 50dim s3 as number = 100dim s4 as number = 750dim s5 as number = 900dim s6 as number = 1150dim s7 as number = 1350dim s8 as number = 1550dim s9 as number = LAYOUTWIDTH#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KS_Filter, 0, 150, LAYOUTWIDTH, 50)'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kostenstellen'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)SetCurrentTable("Kostenstellen")'if ( NOT ksFolgt)'   SetTextBold(true)'   SetTextSize(9)'DrawLine(s1, hoehe, s9, hoehe)'endif#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"if(KS_Kostenstelle)SetTextBold(true)SetTextSize(12)if(linie)DrawLine(s1, 0, s9, 0)elseset linie to trueendifDrawText(KS_Text, l1, 20, s6-s1, 300)DrawText(Format(KS_Saldo, User_ListFormat), l7, 20, s9-s7-10, 300, ALIGN_RIGHT)SetTextBold(true)SetTextSize(9)if (ksFolgt)set hoehe to AREA_CURRENTHEIGHT+5DrawLine(s1, hoehe, s9, hoehe)DrawLine(s1, hoehe, s1, hoehe+45)DrawText("Datum", l5, hoehe+5, b5, 40, ALIGN_CENTER)DrawLine(s5, hoehe, s5, hoehe+45)DrawText("Soll", l6, hoehe+5, b6, 40, ALIGN_CENTER)DrawLine(s6, hoehe, s6, hoehe+45)DrawText("Haben", l7, hoehe+5, b7, 40, ALIGN_CENTER)DrawLine(s7, hoehe, s7, hoehe+45)DrawText("Saldo", l8, hoehe+5, b8, 40, ALIGN_CENTER)DrawLine(s8, hoehe, s8, hoehe+45)DrawLine(s9, hoehe, s9, hoehe+45)endifelseif(KS_Konto)SetTextBold(true)DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText(KS_Text, l2, 20, s6-s2, 300, ALIGN_LEFT)DrawVerticalLine(s8)DrawText(Format(KS_Saldo, FORMATBETRAGLEER), l8, 20, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)elseif(KS_Buchung)SetTextBold(false)SetTextSize(8)DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText(KS_Text, s3, 20, s5-s3, 300, ALIGN_LEFT)DrawVerticalLine(s5)DrawText(DateToText(KS_Datum), l5, 20, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText(Format(KS_BetragSoll, FORMATBETRAGLEER), l6, 20, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(KS_BetragHaben, FORMATBETRAGLEER), l7, 20, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawVerticalLine(s9)endifif(KS_EbeneNr = 1)set ksFolgt to trueelseset ksFolgt to falseendifPageBreak(KS_FolgendeEbeneNr=1)if(KS_FolgendeEbeneNr = 1)set ksFolgt to trueset linie to falseendif#BeginTableBreakSetArea(10)DrawLine(s1, 0, s9, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s9, 0)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------0000011