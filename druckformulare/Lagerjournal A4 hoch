00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000020Lagerjournal A4 hoch0000042021000004true000004true00000100000010000053Lagerjournal, Darstellung der Bestände und Bewegungen004677' -----------------------------------------------------------------------------------------'' Formular : Lagerjournal im Format A4 hoch' Historie : 05.01.2010: Initialversion' Geändert : 25.01.2011: sts (Ausgabe Datum mit Uhrzeit)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Lagerjournal"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row       as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 7 Spaltendim anzahlSpalten as number = 7dim s1 as number = 0dim s2 as number = 450dim s8 as number = LAYOUTWIDTHdim s7 as number = s8 - 140dim s6 as number = s7 - 140dim s5 as number = s6 - 140dim s4 as number = s5 - 250dim s3 as number = s4 - 250dim mengenformat as Text = "#." + Left("0000", Firma_FakturaNKMenge)set mengenformat to mengenformat + ";-" + mengenformat + ";"dim vorgangText as Text =""#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(LJ_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Lagerjournal'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Lagerjournal")DrawLine(s1, 0, s8, 0)DrawVerticalLine(s1)DrawText("Artikel" + Chr(13) + "Vorgang", s1, 5, b1, 70)DrawVerticalLine(s2)DrawText("Artikelnr", l2, 5, b2, 160, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Erfassung", l3, 5, b3, 50, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Buchung"  , l4, 5, b4, 50, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Menge", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Bestellt", l6, 5, b6, 80, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Bestand", l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawVerticalLine(s1)SetTextColor(RGBColor(0, 0, 0))if (LJ_EbeneNr = LJ_EbeneArtikel)SetTextBold(true)SetLineWidth(3)DrawLine(s1, 0, s8, 0)SetLineWidth(1)DrawText(LJ_Artikel,   l1, 5, b1, 100)DrawVerticalLine(s2)DrawText(LJ_ArtNummer, l2, 5, b2, 160)DrawLine(s1, AREA_CURRENTHEIGHT, s8, AREA_CURRENTHEIGHT)elseSetTextBold(false)DrawLine(s1, 0, s8, 0)if Length(LJ_VorgangNr) > 0if (LJ_VorgangGeloescht=TRUE)SetTextColor(RGBColor(128, 128, 128))set vorgangText to "("+LJ_VorgangNr+"/gelöscht)"elseset vorgangText to "("+LJ_VorgangNr+")"endifelseset vorgangText to ""endifDrawText(LJ_Vorgang +vorgangText, l1 + 50, 5, l2 + b2, 160)DrawText(MediumDate(LJ_DatumZeit) + " " +TimeToText(LJ_DatumZeit), l3, 5, b3, 40, ALIGN_CENTER)DrawText(MediumDate(LJ_BuchungZeit) + " " +TimeToText(LJ_BuchungZeit), l4, 5, b4, 40, ALIGN_CENTER)endifDrawVerticalLine(s3)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawText(Format(LJ_Menge, mengenformat),    l5, 5, b5, 160, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(LJ_Bestellt, mengenformat), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(LJ_Bestand, mengenformat),  l7, 5, b7, 160, ALIGN_RIGHT)DrawVerticalLine(s8)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s8, 0)#BeginTableFooterSetArea(10)SetLineWidth(3)DrawLine(s1, 0, s8, 0)SetLineWidth(1)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Lagerjournal'' -----------------------------------------------------------------------------------------0000011