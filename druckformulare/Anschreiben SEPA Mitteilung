00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000027Anschreiben SEPA Mitteilung0000041017000004true000004true00000100000010000037Briefform Anschreiben SEPA Mitteilung007850' -----------------------------------------------------------------------------------------'' Formular : Anschreiben SEPA Mitteilung universal im Format A4 hoch'' Historie' 19/11/2013: vs Initialversion' -----------------------------------------------------------------------------------------#BeginDocumentSetDocument(150, 150, 100, 100) ' Seitenränder definieren' Konstanten definieren' Allgemeine Konstantenconst HEADER1_HEIGHT   as number = 360const HEADER2_HEIGHT   as number = 360const FOOTER_HEIGHT    as number = 150const BLACK            as color  = RGBColor(0,0,0)const WHITE            as color  = RGBColor(255,255,255)const LAYOUTLEFT       as number = 100const LAYOUTWIDTH      as number = 1700const MAX_POS_HEIGHT   as number = 2000const SEP              as text   = " • "' Ausgabeartenconst AUSGABE_DRUCK               as number = 0const AUSGABE_EMAIL               as number = 1' Variablen definierendim stNr          as textdim abZ           as textdim fz1           as textdim fz2           as textdim fz3           as textdim fz4           as textdim hoehe         as numberdim links1        as numberdim links2        as numberdim breite        as numberdim zab           as number' -----------------------------------------------------------------------------------------' Beginn Briefpapier (Hintergrund)' -----------------------------------------------------------------------------------------#BeginBackground' In diesem Script erfolgt die Definition des Briefpapiers inkl. Logoeinbindung#include "TEMPLATE Briefpapier A4 hoch"' -----------------------------------------------------------------------------------------' Beginn Kopfzeile (Platzhalter für nachfolgende Bereiche)' -----------------------------------------------------------------------------------------#BeginHeaderif ( PAGE_NUMBER = 1 )' Kopfzeile 1. SeiteSetArea(HEADER1_HEIGHT)else' Kopfzeile FolgeseitenSetArea(HEADER2_HEIGHT)endif#include "STYLE Arial 9, normal"' -----------------------------------------------------------------------------------------' Beginn Adress- und Infobereich' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(700, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 90set zab to 40' Adressfenster linksIf (Adr_Firma1 <> "")DrawText(Adr_Firma1, links1, hoehe, 900, 250)set hoehe to hoehe + 40endifIf (Adr_Firma2 <> "")DrawText(Adr_Firma2, links1, hoehe, 900, 250)set hoehe to hoehe + 40endifIf (Adr_Vorname = "")DrawText(Adr_Nachname, links1, hoehe, 900, 250)set hoehe to hoehe + 40elseDrawText(Adr_Vorname + " " + Adr_Nachname, links1, hoehe, 900, 250)set hoehe to hoehe + 40endifIf (Adr_Strasse <> "" OR  Adr_HausNr <> "")DrawText(Adr_Strasse + " " + Adr_HausNr, links1, hoehe, 900, 250)set hoehe to hoehe + 40endifIf (Adr_PLZ <> "" OR Adr_Ort <> "")DrawText(Adr_PLZ + " " + Adr_Ort, links1, hoehe, 900, 250)set hoehe to hoehe + 40endifIf (Adr_Land <> "")DrawText(Adr_Land, links1, hoehe, 900, 250)set hoehe to hoehe + 40endifDrawText(DateToText(GetCurrentDate), 1380, hoehe, 900, 50)'If (Adr_Land <> "" OR  Adr_Ort <> "")'DrawText(Adr_Land, links1, hoehe, 900, 250)'set hoehe to hoehe + 40'endif' Infoblock rechtsset hoehe to 400set links1 to 1100set links2 to links1 + 280set breite to LAYOUTLEFT + LAYOUTWIDTH - links2if ( Firma_UStIDNummer <> "" )DrawText("UStID:", links1, hoehe, links2 - links1, 50)DrawText(Firma_UStIDNummer, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( Firma_Telefon <> "" )DrawText("Telefon:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Telefon, links2, hoehe, breite, 50)set hoehe to hoehe + zabendifif ( Firma_Email <> "" )DrawText("E-Mail:", links1, hoehe, links2 - links1, 50)DrawText(Firma_Email, links2, hoehe, breite, 100)set hoehe to hoehe + 2 * zabendif'-----------------------------------------------------------------------------------------'Beginn Auftragskopf (Anrede, Anschreiben)'-----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(1500, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 90set links1 to 100SetTextBold(true)DrawText("Wichtige Information zur Umstellung des Lastschriftverfahrens auf SEPA", links1, hoehe, 1500, 50)SetTextBold(false)' Anrede und Kopftextif ( Adr_Anrede <> "" )if ( Adr_Anrede <> "Herr" )DrawText("Sehr geehrte " + Adr_Anrede + " " + Adr_Vorname + " " + Adr_Nachname + ",", links1, hoehe + 120, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40elseDrawText("Sehr geehrter " + Adr_Anrede + " " + Adr_Vorname + " " + Adr_Nachname + ",", links1, hoehe + 120, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40endifelseDrawText("Sehr geehrte Damen und Herren,", links1, hoehe + 120, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40endif'MitteilungDrawText ("Das deutsche Einzugsermächtigungsverfahren wird in Kürze durch das europäische SEPA-Lastschriftverfahren ersetzt (SEPA - Single Euro Payments Area = einheitlicher Zahlungsverkehrsraum).", links1, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40DrawText ("Die Änderungen betreffen den Aufbau der Bankverbindung. Die bisherige Kontonummer und die Bankleitzahl bilden zusammen mit dem Länderkennzeichen die IBAN. Zusätzlich werden mit Hilfe der internationalen BIC (Bank Identifier Code) Banken weltweit eindeutig identifiziert.", links1, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40DrawText ("Bisher konnten wir die Beträge mittels Lastschrift im Einzugsverfahren von dem uns angegebenen Konto einziehen. Die von Ihnen erteilte Einzugsermächtigung wird als SEPA-Lastschriftmandat weitergenutzt und mit den folgenden Angaben eindeutig gekennzeichnet.", links1, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40DrawText ("Mandatsreferenz:", links1, hoehe, LAYOUTWIDTH, 50)DrawText (Mandat_Referenz, links1 + 500, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHTDrawText ("Gläubiger-Identifikationsnummer:", links1, hoehe, LAYOUTWIDTH, 50)DrawText (Firma_GlaeubigerID, links1 + 500, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40DrawText ("Bitte überprüfen Sie die Angaben Ihrer Kontodaten im SEPA-Format auf Richtigkeit.", links1, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 40DrawText ("IBAN:", links1, hoehe, LAYOUTWIDTH, 50)DrawText (Adr_Bank_IBAN, links1 + 500, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHTDrawText ("BIC:", links1, hoehe, LAYOUTWIDTH, 50)DrawText (Adr_Bank_BIC, links1 + 500, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHTDrawText ("Kreditinstitut:", links1, hoehe, LAYOUTWIDTH, 50)DrawText (Adr_Bank_Name, links1 + 500, hoehe, LAYOUTWIDTH, 50)set hoehe to AREA_CURRENTHEIGHT + 80DrawText ("Sollten Sie Fragen zu diesem Schreiben haben, können Sie uns gern kontaktieren.", links1, hoehe, LAYOUTWIDTH, 50)' -----------------------------------------------------------------------------------------' Fussbereich' -----------------------------------------------------------------------------------------' Grusstext#BeginGraphicsTextSetArea(350, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"set hoehe to 80set breite to LAYOUTWIDTHset links1 to LAYOUTLEFTDrawText ("Mit freundlichen Grüßen", links1, hoehe, LAYOUTWIDTH, 50)set hoehe to hoehe + 40If (Firma_Name <> "")DrawText(Firma_Name, links1, hoehe, 900, 250)set hoehe to hoehe + 40endif' -----------------------------------------------------------------------------------------' Beginn Fusszeile (Platzhalter)' -----------------------------------------------------------------------------------------#BeginFooterSetArea(FOOTER_HEIGHT)#include "STYLE Arial 9, normal"0000011