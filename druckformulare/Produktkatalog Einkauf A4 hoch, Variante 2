00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000042Produktkatalog Einkauf A4 hoch, Variante 20000042025000004true000004true00000100000010000125Produktkatalog Einkauf mit maximal 5 Produktbildern unter Berücksichtigung der Artikeloptionen 'In Preisliste' und 'Gesperrt'004210' -----------------------------------------------------------------------------------------'' Formular : Preisliste im Format A4 hoch für Kunden' Historie : 04.12.2014: Initialversion' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst NAME as text = NthField(PL_Filter, "/", 2)const KUNDE as text = NthField(PL_Filter, "/", 3)const ARTIKEL as text = NthField(PL_Filter, "/", 4)const DOCTITEL as text = NAME + " in " + App_GJWaehrungconst HEAD_HEIGHT as number = 150const GREY as color = RGBColor(128, 128, 128)const WHITE as color  = RGBColor(255,255,255)'Variablen definieerendim links1        as number = 0dim links2        as number = 300dim hoehe         as number = 0dim nz            as number = 40   ' neue Zeiledim artNr         as textdim pictureTop    as numberdim pictureWidth1 as number = 750dim pictureWidth2 as number = 350' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 6 Spaltendim anzahlSpalten as number = 6dim s1 as number = 0dim s2 as number = 250dim s3 as number = 850dim s4 as number = 1050dim s5 as number = 1250dim s6 as number = 1500dim s7 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeaderset headline to "Produktkatalog Einkauf in " + App_GJWaehrung#include "TEMPLATE BeginHeader A4"#include "STYLE Arial 10, normal"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Preisliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetCurrentTable("Preisliste")SetArea(70)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(1000, AREA_AUTOSIZE)SetAreaMin(900)#include "STYLE Arial 8, normal"set hoehe to 40' -----------------------------------------------------------------------------------------'           Anfang der Preislistenpositionen' -----------------------------------------------------------------------------------------if (PL_Ebene = PL_EbeneArtikel)                             ' oberste ArtikelebeneSetTextBold(TRUE)DrawLine(s1, hoehe, s7, hoehe)DrawText(PL_Artikelnummer, l1, hoehe + 5, b1, 300, ALIGN_LEFT)set artNr to PL_ArtikelnummerDrawText(PL_ArtikelBezeichnung, l2, hoehe + 5, b2, 300, ALIGN_LEFT)SetTextBold(FALSE)DrawText(PL_ArtikelBeschreibung, l2, AREA_CURRENTHEIGHT + 5, b2, 300, ALIGN_LEFT)DrawText(Format(PL_AbMenge, FORMATBETRAGLEER), l3, hoehe + 5, b3, 40, ALIGN_RIGHT)DrawText("ab", l4, hoehe + 5, b4, 40, ALIGN_RIGHT)DrawText(Format(PL_EKNetto, FORMATBETRAGLEER), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)DrawText(Format(PL_EKBrutto, FORMATBETRAGLEER), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)' Artikelbilderset pictureTop to AREA_CURRENTHEIGHT + 40if (PL_Bild1 <> 0)DrawPicture("*" + NumToText(PL_Bild1), s2, pictureTop, pictureWidth1)endifif (PL_Bild2 <> 0)DrawPicture("*" + NumToText(PL_Bild2), s2 + 800, pictureTop, pictureWidth2)endifif (PL_Bild3 <> 0)DrawPicture("*" + NumToText(PL_Bild3), s2 + 800, pictureTop + 350, pictureWidth2)endifif (PL_Bild4 <> 0)DrawPicture("*" + NumToText(PL_Bild4), s2 + 1200, pictureTop, pictureWidth2)endifif (PL_Bild5 <> 0)DrawPicture("*" + NumToText(PL_Bild5), s2 + 1200, pictureTop + 350, pictureWidth2)endif' Abstand zur nächsten Zeile vergrößern (weisse Linie als Platzhalter)SetLineColor(WHITE)DrawLine(s1, AREA_CURRENTHEIGHT + 10, s7, AREA_CURRENTHEIGHT + 40)endif' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Preisliste'' -----------------------------------------------------------------------------------------'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(0)'DrawLine(s1, 0, s7, 0)#BeginTableFooterSetArea(0)'DrawLine(s1, 0, s7, 0)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"0000011