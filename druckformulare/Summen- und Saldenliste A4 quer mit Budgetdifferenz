00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000051Summen- und Saldenliste A4 quer mit Budgetdifferenz0000042002000004true000004true00000100000010000061Summen- und Saldenliste A4 quer mit Budgetvergleich zum Saldo009423' -----------------------------------------------------------------------------------------'' Formular : Summen- und Saldenliste im Format A4 quer mit Budgetdifferenz zum Saldo' Historie : 24/07/2007: Initialversion vs' Geändert : 02/10/2008: hb (Summenberechnung korrigiert)' Geändert : 27/08/2013: sts (Ausgabe Gesamt-Saldo für jede Klasse)' Geändert : 27/08/2013: sts (Summensaldo und Differenz korrigiert, Berücksichtigung der EB-Werte)' Geändert : 17/09/2013: hb  (Budgetsumme und -differenz in der Klassensumme erweitert)'                        Achtung: Klassensumme Differenz bezieht sich nur auf budgetierte Konten!' Geändert : 21/12/2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)' Geändert : 18/06/2018: sts (Summenausgabe "0,00" bei Saldo Null)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Summen- und Saldenliste in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row           as number = 0dim ebAktiva      as numberdim ebPassiva     as numberdim perSoll       as numberdim perHaben      as numberdim kumSoll       as numberdim kumHaben      as numberdim klasse        as numberdim hoehe         as numberdim sumAktiva     as numberdim sumPassiva    as numberdim sumSoll       as numberdim sumHaben      as numberdim sumSollKum    as numberdim sumHabenKum   as numberdim diffBudget    as numberdim sumDiffBudget as numberdim sumBudget     as number' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 11 Spaltendim anzahlSpalten as number = 11dim s1 as number = 0dim s2 as number = 150dim s3 as number = 600dim s4 as number = 830dim s5 as number = 1060dim s6 as number = 1290dim s7 as number = 1520dim s8 as number = 1750dim s9 as number = 1980dim s10 as number = 2210dim s11 as number = 2405dim s12 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(SL_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Summen- und Saldenliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Saldenliste")DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText("Konto", s1, 5, s2-s1-20, 40)DrawVerticalLine(s2)DrawText("Kontobezeichnung", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("Eröffnungsbilanzwerte", l3, 5, s5-s3 - 20, 40)DrawText("Aktiva", l3, 38, b3, 40)DrawText("Passiva", l4, 38, b4, 40)DrawVerticalLine(s5)DrawText("Periodenwerte", l5, 5, s7-s5 - 20, 40)DrawText("Soll", l5, 38, b5, 40)DrawText("Haben", l6, 38, b6, 40)DrawVerticalLine(s7)DrawText("Kumulierte Werte", l7, 5, s9-s7 - 20, 40)DrawText("Soll", l7, 38, b7, 40)DrawText("Haben", l8, 38, b8, 40)DrawVerticalLine(s9)DrawText("Saldo", l9, 5, b9, 40)DrawVerticalLine(s10)DrawText("Budget", l10, 5, b10, 40)DrawVerticalLine(s11)DrawText("Differenz", l11, 5, b11, 80)DrawVerticalLine(s12)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"set hoehe to 0if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s12, 0)'Summenzeileif((klasse<>Floor(SL_Konto / 1000)) and not (ebAktiva=0 and ebPassiva=0 and perSoll=0 and perHaben=0 and kumSoll=0 and kumHaben=0))SetTextBold(true)DrawText("Summe Klasse " + NumToText(klasse), l1, 5, s4-s1-20, 160, ALIGN_LEFT)DrawText(Format(ebAktiva, FORMATBETRAGLEER), l3, 5, b3, 40, ALIGN_RIGHT)DrawText(Format(ebPassiva, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)DrawText(Format(perSoll, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(perHaben, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(kumSoll, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawText(Format(kumHaben, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawText(Format(Round((ebAktiva-ebPassiva+KumSoll-kumHaben)*100)/100, User_ListFormat), l9, 5, b9, 40, ALIGN_RIGHT)DrawText(Format(sumBudget, FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawText(Format(sumDiffBudget, FORMATBETRAGLEER), l11, 5, b11, 40, ALIGN_RIGHT)DrawLine(s1, 80, s12, 80)set hoehe to 80set ebAktiva to 0set ebPassiva to 0set perSoll to 0set perHaben to 0set kumSoll to 0set kumHaben to 0set sumDiffBudget to 0set sumBudget to 0endif'TabellenzeileSetTextBold(false)set klasse to Floor(SL_Konto / 1000)DrawVerticalLine(s1)DrawText(Format(SL_Konto, FORMATKONTO), l1, hoehe+5, b1, 40, ALIGN_RIGHT)DrawText(SL_Bezeichnung, l2, hoehe+5, b2, 160, ALIGN_LEFT)DrawVerticalLine(s3)set ebAktiva to ebAktiva + SL_EBSollDrawText(Format(SL_EBSoll, FORMATBETRAGLEER), l3, hoehe+5, b3, 40, ALIGN_RIGHT)set sumAktiva to sumAktiva + SL_EBSollDrawVerticalLine(s4)set ebPassiva to ebPassiva + SL_EBHabenDrawText(Format(SL_EBHaben, FORMATBETRAGLEER), l4, hoehe+5, b4, 40, ALIGN_RIGHT)set sumPassiva to sumPassiva + SL_EBHabenDrawVerticalLine(s5)set perSoll to perSoll + SL_PeriodeSollDrawText(Format(SL_PeriodeSoll, FORMATBETRAGLEER), l5, hoehe+5, b5, 40, ALIGN_RIGHT)set sumSoll to sumSoll + SL_PeriodeSollDrawVerticalLine(s6)set perHaben to perHaben + SL_PeriodeHabenDrawText(Format(SL_PeriodeHaben, FORMATBETRAGLEER), l6, hoehe+5, b6, 40, ALIGN_RIGHT)set sumHaben to sumHaben + SL_PeriodeHabenDrawVerticalLine(s7)set kumSoll to kumSoll + SL_KumuliertSollDrawText(Format(SL_KumuliertSoll, FORMATBETRAGLEER), l7, hoehe+5, b7, 40, ALIGN_RIGHT)set sumSollKum to sumSollKum + SL_KumuliertSollDrawVerticalLine(s8)set kumHaben to kumHaben + SL_KumuliertHabenDrawText(Format(SL_KumuliertHaben, FORMATBETRAGLEER), l8, hoehe+5, b8, 40, ALIGN_RIGHT)set sumHabenKum to sumHabenKum + SL_KumuliertHabenDrawVerticalLine(s9)DrawText(Format(SL_KumuliertSaldoMitEB, User_ListFormat), l9, hoehe+5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(SL_Budget, FORMATBETRAGLEER), l10, hoehe+5, b10, 40, ALIGN_RIGHT)set sumBudget to sumBudget + SL_BudgetDrawVerticalLine(s11)if(SL_Budget <> 0)set diffBudget to SL_Budget - SL_KumuliertSaldoMitEBset sumDiffBudget to sumDiffBudget + diffBudgetDrawText(Format(diffBudget, FORMATBETRAGLEER), l11, hoehe+5, b11, 40, ALIGN_RIGHT)endifDrawVerticalLine(s12)DrawLine(s2, hoehe, s2, AREA_CURRENTHEIGHT)DrawLine(s11, hoehe, s11, AREA_CURRENTHEIGHT)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s12, 0)#BeginTableFooterSetArea(141)#include "STYLE Arial 8, normal"SetTextBold(true)'-----------------------------------------------------------letzte SummenzeileDrawLine(s1, 0, s12, 0)DrawText("Summe Klasse " + NumToText(klasse), l1, 5, s4-s1-20, 160, ALIGN_LEFT)DrawText(Format(ebAktiva, FORMATBETRAGLEER), l3, 5, b3, 40, ALIGN_RIGHT)DrawText(Format(ebPassiva, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)DrawText(Format(perSoll, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(perHaben, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(kumSoll, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawText(Format(kumHaben, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawText(Format(Round((ebAktiva-ebPassiva+KumSoll-kumHaben)*100)/100, User_ListFormat), l9, 5, b9, 40, ALIGN_RIGHT)DrawLine(s1, 80, s12, 80)DrawText("Summe", s1+10, 95, b2, 40)DrawText(Format(sumAktiva, FORMATBETRAGLEER), l3, 95, b3, 40, ALIGN_RIGHT)DrawText(Format(sumPassiva, FORMATBETRAGLEER), l4, 95, b4, 40, ALIGN_RIGHT)DrawText(Format(sumSoll, FORMATBETRAGLEER), l5, 95, b5, 40, ALIGN_RIGHT)DrawText(Format(sumHaben, FORMATBETRAGLEER), l6, 95, b6, 40, ALIGN_RIGHT)DrawText(Format(sumSollKum, FORMATBETRAGLEER), l7, 95, b7, 40, ALIGN_RIGHT)DrawText(Format(sumHabenKum, FORMATBETRAGLEER), l8, 95, b8, 40, ALIGN_RIGHT)SetTextBold(true)DrawText(Format(Round((sumAktiva-sumPassiva+sumSollKum-sumHabenKum)*100)/100, FORMATBETRAGNULL), l9, 95, b9, 40, ALIGN_RIGHT)DrawLine(s1, 140, s12, 140)' vertikale LinienDrawVerticalLine(s1)DrawVerticalLine(s3)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)DrawVerticalLine(s8)DrawVerticalLine(s9)DrawVerticalLine(s10)DrawVerticalLine(s12)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Summen- und Saldenliste'' -----------------------------------------------------------------------------------------0000012