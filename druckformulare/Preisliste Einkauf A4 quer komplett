00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000035Preisliste Einkauf A4 quer komplett0000042025000004true000004true00000100000010000092Preisliste Einkauf unter Berücksichtigung der Artikeloptionen 'In Preisliste' und 'Gesperrt'006225' -----------------------------------------------------------------------------------------'' Formular : Preisliste Einkauf im Format A4 quer komplett' Historie : 20.01.2011: sts Initialversion' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst FILTERFELDER as number = CountFields(PL_Filter, "/")const DATUM    as text   = NthField(NthField(PL_Filter, "/", 1), ":", 2)const NAME as text   = IfThen(PL_AllePreislisten, "Preisliste Einkauf", NthField(PL_Filter, "/", 2))const KUNDE    as text   = IfThen(PL_AllePreislisten, " <Alle Lieferanten> ", NthField(PL_Filter, "/", 3))const ARTIKEL  as text   = NthField(PL_Filter, "/", 4)const DOCTITEL as text   = NAME + " in " + App_GJWaehrungconst HEAD_HEIGHT  as number = 350const GREY as color  = RGBColor(128, 128, 128)' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************'Variablen definieerendim links1    as number = 0dim links2    as number = 300dim hoehe     as number = 0dim nz        as number = 40   ' neue Zeiledim artNr     as textdim neueSeite as boolean = falsedim row       as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 6 Spaltendim anzahlSpalten as number = 6dim s1 as number = 0dim s2 as number = 350dim s3 as number = 1600dim s4 as number = 1850dim s5 as number = 2100dim s6 as number = 2350dim s7 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"#include "STYLE Arial 10, normal"' Darstellung der FilterkriterienDrawText("Kundenauswahl:", links1, 190, LAYOUTWIDTH, 50)DrawText(KUNDE, links2, 190, LAYOUTWIDTH, 50)DrawText("Artikelauswahl:", links1, 230, LAYOUTWIDTH, 50)DrawText(ARTIKEL, links2, 230, LAYOUTWIDTH, 50)set hoehe to hoehe + nzDrawText("gesperrte Artikel:", Links1, 270, LAYOUTWIDTH, 50)if (PL_GesperrteAnzeigen)DrawText("anzeigen", Links2, 270, LAYOUTWIDTH, 50)elseDrawText("nicht anzeigen", Links2, 270, LAYOUTWIDTH, 50)endifset hoehe to hoehe + (1.5 * nz)' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Preisliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetCurrentTable("Preisliste")SetArea(70)' -----------------------------------------------------------------------------------------'           Anfang der Tabellekopf' -----------------------------------------------------------------------------------------#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)DrawLine(s1, 0, s7, 0)DrawVerticalLine(s1)DrawText("Art.-Nr.", l1, 5, b1, 40)DrawVerticalLine(s2)DrawText("Bezeichnung", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("Stk/Verpackung", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("ab Menge", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Preis Netto", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Preis Brutto", l6, 5, b6, 40)DrawVerticalLine(s7)DrawLine(s1, 70, s7, 70)if (PAGE_NUMBER>1)set neueSeite to trueendif' -----------------------------------------------------------------------------------------'           Ende der Tabellekopf' -----------------------------------------------------------------------------------------'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendif' -----------------------------------------------------------------------------------------'           Anfang der Preislistenpositionen' -----------------------------------------------------------------------------------------if (PL_Ebene = PL_EbeneArtikel)                             ' oberste Artikelebeneset neueSeite to falseSetTextBold(TRUE)DrawLine(s1, 0, s7, 0)DrawText(PL_Artikelnummer, l1, 5, b1, 300, ALIGN_LEFT)set artNr to PL_ArtikelnummerDrawText(PL_ArtikelBezeichnung, l2, 5, b2, 300, ALIGN_LEFT)DrawText(Format(PL_AbMenge, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)elseif (PL_Ebene = PL_EbenePreise)if (neueSeite)DrawText(artNr, l1, 5, b1, 300, ALIGN_LEFT)DrawText("<Fortsetzung>", l2, 5, b2, 300, ALIGN_LEFT)set neueSeite to FALSEendifDrawLine(s3, 0, s7, 0)SetTextBold(FALSE)SetTextColor(GREY)if ( PL_Lieferant <> "" and KUNDE = " <Alle Lieferanten> " or PL_AllePreislisten )if ( PL_AllePreislisten )DrawText(PL_Lieferant + " (" + PL_Preisliste + ")" , l2, 5, b2, 300, ALIGN_RIGHT)elseDrawText(PL_Lieferant  , l2, 5, b2, 300, ALIGN_RIGHT)endifendifSetTextColor(BLACK)DrawText(Format(PL_AbMenge, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)endifDrawText(Format(PL_EKNetto, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(PL_EKBrutto, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s1)DrawVerticalLine(s2)DrawVerticalLine(s3)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Preisliste'' -----------------------------------------------------------------------------------------'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s7, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s7, 0)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"0000012