00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000024TEMPLATE Anlagen A4 hoch000002-1000004true000004true00000100000010000066Template zur Realisierung der Anlagenliste für den Jahresabschluss004534' -----------------------------------------------------------------------------------------'' Formular : TEMPLATE Anlagen A4 hoch' Historie : 14/08/2007: Initialversion vs' Geändert : 29/05/2009: sts ( Anpassung automatischer Vorjahresvergleich )''-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Abschreibungsliste''-----------------------------------------------------------------------------------------dim afa as text' Variablen für die Positionen der 14 Spaltenif(Mit_Anlagen AND HasTable("Abschreibungsliste"))set anzahlSpalten to 9set s1 to 0set s2 to 250set s3 to 430if( Mit_Vorjahr )set s4 to 670elsedim s4 as number = 670endifdim s5 as number = 850dim s6 as number = 1030dim s7 as number = 1210dim s8 as number = 1390dim s9 as number = 1570dim s10 as number = LAYOUTWIDTH#include "TEMPLATE Table"endif#BeginTableHeaderif(Mit_Anlagen AND HasTable("Abschreibungsliste"))SetArea(110)#include "STYLE Arial 7, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Abschreibungsliste")DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawText("Inv.-Nr", l1, 25, b1, 40, ALIGN_CENTER)DrawText("Bezeichnung", l1, 55, b1, 85, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("AHK Hist.", l2, 25, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Afa Beginn", l3, 25, b3, 40, ALIGN_CENTER)DrawText("Art / ND (Mon)", l3, 55, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Buchw. Anfang", l4, 25, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Zugang", l5, 25, b5, 40, ALIGN_CENTER)DrawText("Abgang", l5, 55, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Zuschreib-ung", l6, 25, b6, 70, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Afa Jahr", l7, 25, b7, 40, ALIGN_CENTER)DrawText("Sonder-Afa", l7, 55, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Afa kum.", l8, 25, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("Buchw. Ende", l9, 25, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)endif'---------------------------------------------------------BeginTableRow-----#BeginTableRowif(Mit_Anlagen AND HasTable("Abschreibungsliste"))SetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 7, normal"if (AL_ZeilenArt=AL_SummenZeile)SetTextBold(true)elseif (AL_ZeilenArt=AL_AfaZeile)SetTextBold(false)endifDrawVerticalLine(s1)DrawLine(s1, 0, s10, 0)DrawText(AL_InventarNr, l1, 5, b1, 300)DrawText(AL_Bezeichnung, l1, 35, b1, 300)DrawVerticalLine(s2)DrawText(Format(AL_AHKHistorisch, FORMATBETRAGLEER), l2, 5, b2, 160, ALIGN_RIGHT)DrawVerticalLine(s3)if (AL_ZeilenArt<>AL_SummenZeile)DrawText(IfThen(AL_AfaBeginn <> TextToDate("01.01.1904"), DateToText(AL_AfaBeginn), ""), l3, 5, b3, 40, ALIGN_CENTER)if(AL_AfaMethode = AL_AFAART_KEINE)set afa to "keine"elseif(AL_AfaMethode = AL_AFAART_LINEAR)set afa to "LIN"elseif(AL_AfaMethode = AL_AFAART_DEGRESSIV)if (AL_AfaWechsel)set afa to "D/L"elseset afa to "DEG"endifelseif(AL_AfaMethode = AL_AFAART_GWG)set afa to "GWG"elseif(AL_AfaMethode = AL_AFAART_GWG_SP)set afa to "GWG-SP"elseset afa to "#WERT!"endifif (AL_ZeilenArt=AL_AfaZeile)set afa to afa + " / " + Format(AL_Nutzungsdauer, "0")endifDrawText(afa, l3, 35, b3, 40, ALIGN_CENTER)endifDrawVerticalLine(s4)DrawText(Format(AL_BuchwertAnfang, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(AL_Zugang, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(AL_Abgang, FORMATBETRAGLEER), l5, 35, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(AL_Zuschreibung, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(AL_AfaJahr, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawText(Format(AL_SonderAfa, FORMATBETRAGLEER), l7, 35, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(AL_AfaKum, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(AL_BuchwertEnde, FORMATBETRAGLEER), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)endif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakif(Mit_Anlagen AND HasTable("Abschreibungsliste"))SetArea(10)DrawLine(s1, 0, s10, 0)endif#BeginTableFooterif(Mit_Anlagen AND HasTable("Abschreibungsliste"))SetArea(10)DrawLine(s1, 0, s10, 0)endif' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Abschreibungsliste'' -----------------------------------------------------------------------------------------0000011