00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000049Kontoauszug fortlaufend A4 quer mit Kostenstellen0000042001000004true000004true00000100000010000060Einzelkonten fortlaufend im Format A4 quer mit Kostenstellen007800' -----------------------------------------------------------------------------------------'' Formular : Kontoauszug im Format A4 quer mit Kostenstellen' Historie : 16/08/2007: Initialversion vs' Geändert : 26/08/2008: sts (Verkehrszahlen/Saldo am Ende jeder Seite)' Geändert : 22/06/2010: sts (Korrektur Ausgabe Verkehrszahlen/Saldo bei Seitenumbruch)' Geändert : 09/09/2010: hb  (Ausgabe der Kontennummer in der Saldenzeile))' Geändert : 14.11.2013: sts (Spaltenbreite für Steuersatz angepasst, Kontobezeichnung bei Saldenzeile entfernt)' Geändert : 26.02.2014: sts (Ausgabe für Kontostand "0,00")' Geändert : 27.01.2015: sts (mehrzeilige Ausgabe der Filterinformation)' Geändert : 04.07.2016: sts (Ausgabe Datum mit Jahr)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text      = "Kontoauszug in " + App_GJWaehrung + " mit Kostenstellen"const HEAD_HEIGHT as number = 330' Globale Variablen definierendim sumSoll         as numberdim sumHaben        as numberdim sumSaldo        as numberdim newHeight       as number = 0dim Konto           as textdim FORMATSALDONULL as text = "###,###,###,###.00\ \S;###,###,###,###..00\ \H;0.00"dim row             as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 11 Spaltendim anzahlSpalten as number = 11dim s1 as number = 0dim s2 as number = 190dim s3 as number = 360dim s4 as number = 560dim s5 as number = 980dim s6 as number = 1130dim s7 as number = 1350dim s8 as number = 1570dim s9 as number = 1820dim s10 as number = 2100dim s11 as number = 2350dim s12 as number = LAYOUTWIDTH' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KA_Filter, 0, 150, LAYOUTWIDTH, 150)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Kontoauszug")DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText("Nummer", l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Datum", s2, 5, b2+20, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Beleg", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Buchungstext", l4, 5, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Gegen- konto", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Betrag", l6, 5, s8-s6, 40, ALIGN_CENTER)DrawText("Soll", l6, 45, b6, 40, ALIGN_CENTER)DrawText("Haben", l7, 45, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Saldo", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("Steuer", l9, 5, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)DrawText("Kostenstelle 1", l10, 5, b10, 40, ALIGN_CENTER)DrawVerticalLine(s11)DrawText("Kostenstelle 2", l11, 5, b11, 40, ALIGN_CENTER)DrawVerticalLine(s12)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 0 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif( KA_Zeilenart = KA_Kopfzeile )set konto to NthField(KA_Text, " ", 1)DrawLine(s1, 0, s12, 0)SetTextSize(10)SetTextBold(true)DrawText(KA_Text, l1, 80, s10-s1, 50)SetTextSize(8)DrawLine(s1, 125, s12, 125)endifif( KA_Zeilenart = KA_Eröffnungsbuchung OR KA_Zeilenart = KA_Übertragszeile )DrawLine(s1, 0, s12, 0)SetTextBold(true)DrawVerticalLine(s1)DrawText(KA_Text, l1, 5, s10-s6, 40)DrawVerticalLine(s6)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l8, 5, b8, 40, ALIGN_RIGHT)set sumSaldo to KA_SaldoDrawVerticalLine(s9)DrawVerticalLine(s12)endifif( KA_Zeilenart =  KA_Journalzeile )DrawLine(s1, 0, s12, 0)DrawVerticalLine(s1)DrawText(KA_Nummer, l1, 5, b1, 40, ALIGN_LEFT)DrawText(ShortDate(KA_Datum), l2, 5, b2, 40, ALIGN_CENTER)DrawText(KA_BelegNr, l3, 5, b3, 300, ALIGN_LEFT)DrawText(KA_Text, l4, 5, b4, 300)DrawText(Format(KA_Gegenkonto, FORMATKONTO), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)set sumSoll to sumSoll + KA_BetragSollDrawVerticalLine(s7)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)set sumHaben to sumHaben + KA_BetragHabenDrawVerticalLine(s8)DrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l8, 5, b8, 40, ALIGN_RIGHT)set sumSaldo to KA_SaldoDrawVerticalLine(s9)DrawText(KA_Steuersatz, l9, 5, b9, 160, ALIGN_CENTER)DrawText(KA_Kostenstelle1, l10, 5, b10, 300, ALIGN_LEFT)DrawText(KA_Kostenstelle2, l11, 5, b11, 300, ALIGN_LEFT)DrawLine(s2, 0, s2, AREA_CURRENTHEIGHT)DrawLine(s3, 0, s3, AREA_CURRENTHEIGHT)DrawLine(s4, 0, s4, AREA_CURRENTHEIGHT)DrawLine(s5, 0, s5, AREA_CURRENTHEIGHT)DrawLine(s10, 0, s10, AREA_CURRENTHEIGHT)DrawLine(s11, 0, s11, AREA_CURRENTHEIGHT)DrawVerticalLine(s12)endif'-------------------------------------------------------letzte Summenzeileif (KA_LetzteZeile)DrawLine(s1, AREA_CURRENTHEIGHT-1, s12, AREA_CURRENTHEIGHT-1)SetTextBold(true)set newheight to AREA_CURRENTHEIGHT+5DrawText("Verkehrszahlen/Saldo Konto: " + konto, l1, newheight, s6-s1-20, 160, ALIGN_LEFT)DrawText(Format(sumSoll, FORMATBETRAGNULL), l6, newheight, b6, 40, ALIGN_RIGHT)DrawText(Format(sumHaben, FORMATBETRAGNULL), l7, newheight, b7, 40, ALIGN_RIGHT)DrawText(Format(KA_Saldo, FORMATSALDONULL), l8, newheight, b8, 40, ALIGN_RIGHT)SetTextBold(false)endifif (KA_FolgendeZeilenart=KA_Kopfzeile)set sumSoll to 0set sumHaben to 0set sumSaldo to 0endif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(41)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s12, 0)if( HasVariable("KA_Zeilenart") )if( (NOT KA_Zeilenart = KA_Kopfzeile) and (NOT KA_Zeilenart = KA_Summenzeile) )DrawLine(s1, 40, s12, 40)DrawLine(s1, 0, s1, 40)DrawText("Verkehrszahlen/Saldo konto: " + konto, l1, 5, s6-s1-20, 160, ALIGN_LEFT)DrawLine(s6, 0, s6, 40)DrawText(Format(sumSoll, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawText(Format(sumHaben, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawLine(s8, 0, s8, 40)DrawText(Format(sumSaldo, FORMATSALDONULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawLine(s9, 0, s9, 40)DrawLine(s12, 0, s12, 40)endifendif#BeginTableFooterSetArea(10)DrawLine(s1, 0, s12, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------0000012