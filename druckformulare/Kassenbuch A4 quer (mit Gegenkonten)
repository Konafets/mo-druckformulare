00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000036Kassenbuch A4 quer (mit Gegenkonten)0000042008000004true000004true00000100000010000075Kassenbuch im Format A4 quer (für Filteroption 'Alle Gegenkonten' geeignet)008810' -----------------------------------------------------------------------------------------'' Formular : Kassenbuch im Format A4 quer komplett' Historie : 19/07/2007: Initialversion mm' Geändert : 31.10.2009: hb: Darstellung Splittbuchungen und Kostenstellen im Querformat'            10.04.2013: sts: Ausgabe Splittbuchungstext (kann über die Konstante SPLITT_BUCHUNGSTEXT aktiviert und deaktiviert werden)'            14.11.2013: sts (Spaltenbreite für Steuersatz angepasst)'            21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'            31.05.2018: sts (Datum: Ausgabe mit Jahr, Saldo: Ausgabe "0,00" bei Null-Saldo)'' -----------------------------------------------------------------------------------------#BeginDocument' Abbrechen, falls Auswertung keine Gegenkonten liefertif ( not KB_AlleGegenkonten )beepmsgBox("Dieses Druckformular ist nur für die Filteroption 'Alle Gegenkonten' geeignet!")exitendif' Globale Konstanten definierenconst DOCTITEL as text   = "Kassenbuch in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row           as number = 0dim summeEin      as number = 0dim summeAus      as number = 0dim summeSoll     as number = 0dim summeHaben    as number = 0dim summeSaldo    as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 12 Spaltendim anzahlSpalten as number = 12dim s1  as number = 0              ' Datumdim s2  as number = 170            ' Belegdim s3  as number = 340            ' Textdim s4  as number = 870            ' Kontodim s5  as number = 1030           ' Einnahmedim s6  as number = 1190           ' Ausgabedim s7  as number = 1350           ' Solldim s8  as number = 1560           ' Habendim s9  as number = 1770           ' Steuerdim s10 as number = 2000           ' Kost 1dim s11 as number = 2200           ' Kost 2dim s12 as number = 2400           ' Saldodim s13 as number = LAYOUTWIDTH    ' Tabellenende' ********************************************************************************' Konstanten zur Anpassung der Ausgabe' (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const SPLITT_BUCHUNGSTEXT as boolean = TRUE' ********************************************************************************#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KB_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kassenbuch'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Kassenbuch")DrawLine(s1, 0, s13, 0)DrawVerticalLine(s1)DrawText("Datum", s1, 5, s2-s1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Beleg", l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Buchungstext", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Konto", l4, 5, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Einnahme", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Ausgabe", l6, 5, b6, 40, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Soll", l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Haben", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("Steuer", l9, 5, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)DrawText("Kost 1", l10, 5, b10, 40, ALIGN_CENTER)DrawVerticalLine(s11)DrawText("Kost 2", l11, 5, b11, 40, ALIGN_CENTER)DrawVerticalLine(s12)DrawText("Saldo", l12, 5, b12, 40, ALIGN_CENTER)DrawVerticalLine(s13)DrawLine(s1, 40, s13, 40)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif( (KB_Uebertragszeile = KB_Zeilenart) OR (KB_Summenzeile = KB_Zeilenart) )SetTextBold(TRUE)DrawLine(s1, 0, s13, 0)DrawVerticalLine(s1)DrawVerticalLine(s3)DrawText(KB_Text, l3, 5, b3, 300)if ( KB_Summenzeile = KB_Zeilenart )DrawVerticalLine(s5)DrawText(Format(summeEin, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(summeAus, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(summeSoll, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(summeHaben, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)endifDrawVerticalLine(s12)DrawText(Format(KB_Saldo, FORMATBETRAGNULL), l12, 5, b12, 40, ALIGN_RIGHT)DrawVerticalLine(s13)endifif( KB_Journalzeile = KB_Zeilenart )SetTextBold(FALSE)DrawVerticalLine(s1)if ( SQLDate(KB_Datum) <> "1904-01-01" )DrawLine(s1, 0, s13, 0)DrawText(ShortDate(KB_Datum), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(KB_BelegNr, l2, 5, b2, 80)DrawVerticalLine(s3)DrawText(KB_Text, l3, 5, b3, 300)DrawVerticalLine(s4)DrawText(Format(KB_Konto, FORMATKONTO), l4, 5, b4, 85, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(KB_Einnahme, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(KB_Ausgabe, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(KB_Soll, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(KB_Haben, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawVerticalLine(s10)DrawText(KB_KoSt1, l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(KB_KoSt2, l11, 5, b11, 40, ALIGN_RIGHT)DrawVerticalLine(s12)DrawText(Format(KB_Saldo, FORMATBETRAGNULL), l12, 5, b12, 40, ALIGN_RIGHT)DrawVerticalLine(s13)set summeEin   to summeEin   + KB_Einnahmeset summeAus   to summeAus   + KB_Ausgabeset summeSoll  to summeSoll  + KB_Sollset summeHaben to summeHaben + KB_Habenset summeSaldo to summeSaldoelseDrawVerticalLine(s2)DrawVerticalLine(s3)' Buchungstext der Splittzeilen ausgebenif ( SPLITT_BUCHUNGSTEXT )DrawText(KB_Text, l3 + 50, 5, b3 - 50, 300)endifDrawVerticalLine(s4)DrawText(Format(KB_Konto, FORMATKONTO), l4, 5, b4, 85, ALIGN_RIGHT)DrawVerticalLine(s5)DrawVerticalLine(s7)DrawText(Format(KB_Soll, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(KB_Haben, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(KB_Steuersatz, l9, 5, b9, 160, ALIGN_CENTER)DrawVerticalLine(s10)DrawText(KB_KoSt1, l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(KB_KoSt2, l11, 5, b11, 40, ALIGN_RIGHT)DrawVerticalLine(s12)DrawText(Format(KB_Saldo, FORMATBETRAGLEER), l12, 5, b12, 40, ALIGN_RIGHT)DrawVerticalLine(s13)DrawLine(s4, 0, s12, 0)set summeSoll to summeSoll + KB_Sollset summeHaben to summeHaben + KB_Habenset summeSaldo to KB_Saldoendifendifset summeSaldo to summeSaldo + KB_Saldo'-------------------------------------------------------BeginTableBreak---#BeginTableBreak#include "STYLE Arial 8, fett"SetArea(42)DrawLine(s1, 0, s13, 0)DrawVerticalLine(s1)DrawVerticalLine(s3)DrawText("Zwischensumme:", l3, 5, b3, 40, ALIGN_LEFT)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawText(Format(summeEin, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(summeAus, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(summeSoll, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(summeHaben, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawVerticalLine(s11)DrawText(Format(summeSaldo, FORMATBETRAGNULL), l12, 5, b12, 40, ALIGN_RIGHT)DrawLine(s13, 0, s13, 40)DrawLine(s1, 40, s13, 40)'-------------------------------------------------------BeginTableFooter---#BeginTableFooterSetArea(10)DrawLine(s1, 0, s13, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Kassenbuch'' -----------------------------------------------------------------------------------------0000012