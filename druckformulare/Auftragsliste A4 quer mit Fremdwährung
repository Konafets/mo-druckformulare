00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000038Auftragsliste A4 quer mit Fremdwährung0000041009000004true000004true00000100000010000000005776' -----------------------------------------------------------------------------------------'' Formular : Auftragsliste mit Fremdwährung im Format A4 quer' Historie : 23.04.2008: Initialversion mm' Geändert : 28.10.2010: sts (Ausgabe Lieferdatum <> 1.1.1904)'            23.05.2013: sts (Spaltenbreite für Datum an langes Datumsformat angepasst)'            28.02.2014: sts (Ausgabe Auftragsart in Spalte Art angepasst)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Auftragsliste"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row       as number = 0const AUFTRART_ANGEBOT        as number = 1const AUFTRART_AUFTRAGSBEST   as number = 2const AUFTRART_LIEFERSCHEIN   as number = 3const AUFTRART_RECHNUNG       as number = 4const AUFTRART_ABSCHLAGSRECHN as number = 5const AUFTRART_KORREKTURRECHN as number = 6const AUFTRART_PROFORMA       as number = 7const AUFTRART_STORNO         as number = 8' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 14 Spaltendim anzahlSpalten as number = 14dim s1 as number = 0dim s2 as number = 80dim s3 as number = 160dim s4 as number = 370dim s5 as number = 540dim s6 as number = 710dim s7 as number = 960dim s8 as number = 1170dim s9 as number = 1280dim s10 as number = 1490dim s11 as number = 1700dim s12 as number = 1910dim s13 as number = 2110dim s14 as number = 2310dim s15 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(AUF_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Auftragsliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Auftragsliste")DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText("Art", s1, 5, b1, 40)DrawVerticalLine(s2)DrawText("Ent-", l2, 5, b2, 40)DrawText("wurf", l2, 35, b2, 40)DrawVerticalLine(s3)DrawText("AuftragNr", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Datum", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("L-Datum", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Empfänger", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("Zahlungs-", l7, 5, b7, 40)DrawText("bedingung", l7, 35, b7, 40)DrawVerticalLine(s8)DrawText("Wäh-", l8, 5, b8, 40)DrawText("rung", l8, 35, b8, 40)DrawVerticalLine(s9)DrawText("PosNetto", l9, 5, b9, 40)DrawVerticalLine(s10)DrawText("Rabatt", l10, 5, b10, 40)DrawVerticalLine(s11)DrawText("Netto", l11, 5, b11, 40)DrawVerticalLine(s12)DrawText("Steuer", l12, 5, b12, 40)DrawVerticalLine(s13)DrawText("Brutto", l13, 5, b13, 40)DrawVerticalLine(s14)DrawText("Notiz", l14, 5, b14, 40)DrawVerticalLine(s15)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText(Choose(AUF_Art - 1, "AN", "AB", "LS", "RE", "AR", "KR", "PR", "VS", ""), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(IfThen(AUF_Entwurf, "Ja", ""), l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText(AUF_AuftragsNr, l3, 5, b3, 300)DrawVerticalLine(s4)DrawText(DateToText(AUF_Datum), l4, 5, b4, 300, ALIGN_CENTER)DrawVerticalLine(s5)DrawText(IfThen(DateToNumber(AUF_LieferDatum) > 0, DateToText(AUF_LieferDatum), ""), l5, 5, b5, 300, ALIGN_CENTER)DrawVerticalLine(s6)DrawText(AUF_Matchcode, l6, 5, b6, 300)DrawVerticalLine(s7)DrawText(AUF_Zahlungsbedingung, l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText(AUF_Waehrung, l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText(Format(AUF_PosGesamtPreisNettoFW, FORMATBETRAGNULL), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(AUF_GesamtRabattFW, FORMATBETRAGNULL), l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(Format(AUF_GesamtPreisNettoFW, FORMATBETRAGNULL), l11, 5, b11, 80, ALIGN_RIGHT)DrawVerticalLine(s12)DrawText(Format(AUF_GesamtSteuerFW, FORMATBETRAGNULL), l12, 5, b12, 300, ALIGN_RIGHT)DrawVerticalLine(s13)DrawText(Format(AUF_GesamtPreisBruttoFW, FORMATBETRAGNULL), l13, 5, b13, 40, ALIGN_RIGHT)DrawVerticalLine(s14)DrawText(AUF_Notizen, l14, 5, b14, 300)DrawVerticalLine(s15)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s15, 0)#BeginTableFooter#include "STYLE Arial 8, fett"SetArea(10)DrawLine(s1, 0, s15, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Auftagsliste'' -----------------------------------------------------------------------------------------0000012