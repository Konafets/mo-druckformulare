00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000018Briefliste A4 Quer0000041020000004true000004true00000100000010000034Liste der Briefe im Format A4 Quer004310'-----------------------------------------------------------------------------------------'' Formular : Liste der Briefe im Format A4 quer' Historie : 22/07/2016: sts Initialversion' Geändert : 21/12/2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'            23/03/2017: sts (Ausgabe Datum <> 1.1.1904)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Liste der Briefe "' ********************************************************************************' Über die folgenden Konstanten lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row       as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 8 Spaltendim anzahlSpalten as number = 8dim s1 as number = 0                ' Anfang Spalte Vorlagedim s2 as number = 80               ' Anfang Spalte Serienbriefdim s3 as number = 200              ' Anfang Spalte BriefNr/Vorlagenamedim s4 as number = 600              ' Anfang Spalte Datumdim s5 as number = 770              ' Anfang Spalte Empfängerdim s6 as number = 1400             ' Anfang Spalte Betreffdim s7 as number = 1850             ' Anfang Spalte E-Maildim s8 as number = 2300             ' Anfang Spalte FaxNrdim s9 as number = LAYOUTWIDTH#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(BRIEF_Filter, 0, 150, LAYOUTWIDTH, 50)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Briefliste''-----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Briefliste")DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText("Vor-lage", s1, 5, s2-s1, 80)DrawVerticalLine(s2)DrawText("Serien-brief", s2, 5, s3-s2, 80)DrawVerticalLine(s3)DrawText("BriefNr/Vorlagename", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Datum", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Empfänger", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Betreff", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("E-Mail", l7, 5, b7, 40)DrawVerticalLine(s8)DrawText("FaxNr", l8, 5, b8, 40)DrawVerticalLine(s9)'-----------------------------------------------------------------------------------------#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText(IfThen(BRIEF_Vorlage, "Ja", ""), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(IfThen(BRIEF_Serienbrief, "Ja", ""), l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText(BRIEF_BriefNr, l3, 5, b3, 40)DrawVerticalLine(s4)if ( DateToNumber(BRIEF_Datum) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(BRIEF_Datum), ShortDate(BRIEF_Datum)), l4, 5, b4, 40, ALIGN_CENTER)endifDrawVerticalLine(s5)DrawText(BRIEF_AdrMatchcode, l5, 5, b5, 40)DrawVerticalLine(s6)DrawText(BRIEF_Betreff, l6, 5, b6, 40)DrawVerticalLine(s7)DrawText(BRIEF_EMAIL, l7, 5, b7, 40)DrawVerticalLine(s8)DrawText(BRIEF_FAX, l8, 5, b8, 40)DrawVerticalLine(s9)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s9, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s9, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Briefliste'' -----------------------------------------------------------------------------------------0000012