00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000023Jahresabschluss A4 hoch0000042015000004true000004true00000100000010000077Jahresabschluss mit Debitoren- und Kreditorenübersicht und Abschreibungsliste008084' -----------------------------------------------------------------------------------------'' Formular : Jahresabschluss im Format A4 hoch' Historie : 14.08.2007: Initialversion mm' Geändert : 27.01.2009: hb: Auswertung Datumsformat für Deckblatt eingeführt. Daten im Format tt/mm/jj'                            zeigten auf dem Deckblatt keinen korrekten Zeitraum an''            22.04.2009: sts: automatische Ausgabe der Vorjahressalden'            31.05.2018: sts: Abfrage Filter-Buchungsstatus: 'Festgeschrieben' anstatt 'Verbucht'; Spaltenbreiten geändert'            26.11.2019: sts: Ausgabe Registergericht und Registernummer auf dem Deckblatt'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = ""' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"dim ebene as numberdim kaSum as numberdim kaSumGesamt as numberdim headertext as textdim tabellenname as textdim kontotyp as text = "Debitoren"dim bereich as text = "Bilanz"dim head as boolean = falsedim deltaKto as number = 100dim istGruppe as booleandim hoehe as numberif ( Mit_Vorjahr )' Variablen für die Positionen der 3 Spaltendim delta as number = 50dim anzahlSpalten as number = 3dim s1 as number = 0dim s2 as number = 890dim s3 as number = 1320dim s4 as number = LAYOUTWIDTHelse' Variablen für die Positionen der 2 Spaltendim delta as number = 100dim anzahlSpalten as number = 2dim s1 as number = 10dim s2 as number = 1200dim s3 as number = LAYOUTWIDTHendif#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeaderif (NOT Mit_DeckBlatt)set head to trueendifif(head)if(bereich="Bilanz")if(BZ_GeArt=BZ_EURechnung)set headline to "Einnahme-Überschussrechnung in " + App_GJWaehrungelseset headline to "Bilanz und GuV in " + App_GJWaehrungendifelseif(bereich="Konten")set headline to kontotyp + "aufstellung in " + App_GJWaehrungelseif(bereich="Anlagen")set headline to "Entwicklung des Anlagevermögens in " + App_GJWaehrungendif#include "TEMPLATE BeginHeader A4"DrawText(BZ_Filter, 0, 150, LAYOUTWIDTH, 50)endif#BeginGraphicsTextSetArea(2100, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"if(Mit_DeckBlatt)SetTextSize(18)SetTextBold(true)if(trim(NthField(BZ_Filter, "F-Status:", 2)) <> "Festgeschrieben")DrawText("Vorläufiger", 0, 600, LAYOUTWIDTH, 100, ALIGN_CENTER)endifDrawText("Jahresabschluss", 0, 700, LAYOUTWIDTH, 100, ALIGN_CENTER)SetTextBold(false)SetTextSize(12)DrawText("für die Zeit vom", 0, 800, LAYOUTWIDTH, 100, ALIGN_CENTER)SetTextBold(true)' Auswertung und Behandlung Datums für Deckblattif PatternCount(BZ_Filter, "/") = 1DrawText(NthField(NthField(BZ_Filter, "/", 1),":",2), 0, 900, LAYOUTWIDTH, 100, ALIGN_CENTER)else PatternCount(BZ_Filter, "/") > 1DrawText(NthField(NthField(BZ_Filter, " / ", 1),":",2), 0, 900, LAYOUTWIDTH, 100, ALIGN_CENTER)endif'EndeSetTextBold(false)DrawText("in " + App_GJWaehrung, 0, 1000, LAYOUTWIDTH, 100, ALIGN_CENTER)SetTextSize(14)SetTextBold(true)DrawText(Firma_Name, 0, 1350, LAYOUTWIDTH, 100, ALIGN_CENTER)SetTextBold(false)SetTextSize(12)DrawText(Firma_Strasse, 0, 1450, LAYOUTWIDTH, 100, ALIGN_CENTER)DrawText(Firma_Plz+" "+Firma_Ort, 0, 1550, LAYOUTWIDTH, 100, ALIGN_CENTER)if ( Firma_RegisterGericht <> "" )DrawText(Firma_RegisterGericht, 0, 1750, LAYOUTWIDTH, 100, ALIGN_CENTER)DrawText(Firma_RegisterNummer, 0, 1850, LAYOUTWIDTH, 100, ALIGN_CENTER)endifset head to truePageBreak(true)elseset head to trueendif'========================================================================================' Begin Bilanz/EURechnung'========================================================================================#BeginGraphicsText#include "TEMPLATE Bilanz A4 hoch"'========================================================================================' Begin Kontoauszüge'========================================================================================#BeginGraphicsTextset tabellenname to "Kontoauszug-DebitorenSollsaldo"set headertext   to "Debitoren mit Soll-Saldo"if(Mit_DebKred AND (HasTable(tabellenname) OR HasTable("Kontoauszug-KreditorenSollsaldo")))set bereich to "Konten"PageBreak(true)endif#include "TEMPLATE Debitoren-Kreditoren A4 hoch"#BeginGraphicsTextset tabellenname to "Kontoauszug-KreditorenSollsaldo"set headertext   to "Kreditoren mit Soll-Saldo"if(Mit_DebKred AND HasTable(tabellenname))PageBreak(PAGE_CURRENTHEIGHT+130 > PAGE_HEIGHT - FOOT_HEIGHT )endif#include "TEMPLATE Debitoren-Kreditoren A4 hoch"#BeginGraphicsTextif(Mit_DebKred AND (HasTable("Kontoauszug-DebitorenSollsaldo") OR HasTable("Kontoauszug-KreditorenSollsaldo")))SetArea(60)SetTextBold(true)if( Mit_Vorjahr )DrawLine(s1, 20, s4, 20)elseDrawLine(s1, 20, s3, 20)endifDrawText("Summe gesamt", s1, 25, s2-s1, 300)if( Mit_Vorjahr )DrawText(Format(kaSumGesamt, FORMATBETRAGNULL), s4-300, 25, 280, 50, ALIGN_RIGHT)elseDrawText(Format(kaSumGesamt, FORMATBETRAGNULL), s3-300, 25, 280, 50, ALIGN_RIGHT)endifset kaSumGesamt to 0SetTextBold(false)endif#BeginGraphicsTextset tabellenname to "Kontoauszug-KreditorenHabensaldo"set headertext   to "Kreditoren mit Haben-Saldo"if(Mit_DebKred  AND (HasTable(tabellenname) OR HasTable("Kontoauszug-DebitorenHabensaldo")))set bereich to "Konten"set kontotyp to "Kreditoren"PageBreak(true)endif#include "TEMPLATE Debitoren-Kreditoren A4 hoch"#BeginGraphicsTextset tabellenname to "Kontoauszug-DebitorenHabensaldo"set headertext   to "Debitoren mit Haben-Saldo"if(Mit_DebKred AND HasTable(tabellenname))PageBreak(PAGE_CURRENTHEIGHT+130 > PAGE_HEIGHT - FOOT_HEIGHT )endif#include "TEMPLATE Debitoren-Kreditoren A4 hoch"#BeginGraphicsTextif(Mit_DebKred AND (HasTable("Kontoauszug-KreditorenHabensaldo") OR HasTable("Kontoauszug-DebitorenHabensaldo")))SetArea(60)SetTextBold(true)if( Mit_Vorjahr )DrawLine(s1, 20, s4, 20)elseDrawLine(s1, 20, s3, 20)endifDrawText("Summe gesamt", s1, 25, s2-s1, 300)if( Mit_Vorjahr )DrawText(Format(kaSumGesamt, FORMATBETRAGNULL), s4-300, 25, 280, 50, ALIGN_RIGHT)elseDrawText(Format(kaSumGesamt, FORMATBETRAGNULL), s3-300, 25, 280, 50, ALIGN_RIGHT)endifSetTextBold(false)endif#BeginGraphicsTextif(Mit_Anlagen AND HasTable("Abschreibungsliste"))set bereich to "Anlagen"PageBreak(true)elseset bereich to ""set head to falseendif#include "TEMPLATE Anlagen A4 hoch"#BeginGraphicsTextif(Mit_Anlagen AND HasTable("Abschreibungsliste"))set head to falsePageBreak(Mit_Schluss)endif#BeginGraphicsTextif(Mit_Schluss)SetArea(2100)#include "STYLE Arial 9, normal"SetTextSize(12)SetTextBold(true)DrawText("Schlussbemerkung:", 0, 1000, LAYOUTWIDTH, 100)SetTextBold(false)SetTextSize(10)DrawText("Der vorliegende Jahresabschluss für das Geschäftsjahr vom:", 0, 1080, LAYOUTWIDTH, 100)SetTextBold(true)DrawText(NthField(NthField(BZ_Filter, "/", 1),":",2), 0, 1140, LAYOUTWIDTH, 100, ALIGN_CENTER)SetTextBold(false)DrawText("wurde, ausgehend von der Vorjahresbilanz, aus den Büchern des Unternehmens unter Beachtung der gesetzlichen Vorschriften, nach Grundsätzen der ordnungsgemäßen Buchführung und unter Anwendung zulässiger Bewertungsmethoden aufgestellt.", 0, 1200, LAYOUTWIDTH, 250)DrawText("Alle Finanzkonten sind durch entsprechende Auszüge nachgewiesen.", 0, 1500, LAYOUTWIDTH, 100,)DrawText(Firma_Ort + ",", 0, 1800, LAYOUTWIDTH, 100)DrawText("..............................................", 0, 1950, 450, 100)DrawText("(Datum)", 0, 1980, 400, 100)DrawText(".............................................................................", 900, 1950, 750, 100)DrawText("(Unterschrift)", 900, 1980, 750, 100)endif'-----------------------------------------------------------------------------------------#BeginFooterif(head)#include "TEMPLATE BeginFooter A4"endif'-----------------------------------------------------------------------------------------0000011