00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000031Kontoauszug fortlaufend A4 quer0000042001000004true000004true00000100000010000042Einzelkonten fortlaufend im Format A4 quer007334' -----------------------------------------------------------------------------------------'' Formular : Kontoauszug im Format A4 quer' Historie : 14/08/2007: Initialversion vs' Geändert : 26/08/2008: sts (Verkehrszahlen/Saldo am Ende jeder Seite)' Geändert : 22/06/2010: sts (Korrektur Ausgabe Verkehrszahlen/Saldo bei Seitenumbruch)' Geändert : 09/09/2010: hb  (Ausgabe Kontonummer in Saldenzeile)' Geändert : 25/01/2011: sts (Datum ohne Jahr)' Geändert : 14.11.2013: sts (Spaltenbreite für Steuersatz angepasst, Kontobezeichnung bei Saldenzeile entfernt)' Geändert : 26.02.2014: sts (Ausgabe für Kontostand "0,00")' Geändert : 27.01.2015: sts (mehrzeilige Ausgabe der Filterinformation)' Geändert : 04.07.2016: sts (Ausgabe Datum mit Jahr, Spalte Nummer entfernt)' Geändert : 30.09.2016: hb  (Ausgabe im Querformat, Ausgabe Journalnummer in Spalte 1)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text      = "Kontoauszug in " + App_GJWaehrungconst HEAD_HEIGHT as number = 330' Globale Variablen definierendim sumSoll         as numberdim sumHaben        as numberdim sumSaldo        as numberdim newHeight       as number = 0dim konto           as textdim FORMATSALDONULL as text = "###,###,###,###.00\ \S;###,###,###,###..00\ \H;0.00"dim row             as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 9 Spaltendim anzahlSpalten as number = 9dim s1 as number = 0dim s2 as number = 190dim s3 as number = 390dim s4 as number = 690dim s5 as number = 1800dim s6 as number = 1950dim s7 as number = 2100dim s8 as number = 2250dim s9 as number = 2400dim s10 as number = LAYOUTWIDTH' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KA_Filter, 0, 150, LAYOUTWIDTH, 150)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Kontoauszug")DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawText("Nummer", l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Datum", l2, 5, b2, 40)DrawVerticalLine(s3)DrawText("Beleg", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Buchungstext", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Gegen- konto", l5, 5, b5, 80)DrawVerticalLine(s6)DrawText("Betrag", l6, 5, s8-s6, 40)DrawText("Soll", l6, 45, b6, 40)DrawText("Haben", l7, 45, b7, 40)DrawVerticalLine(s8)DrawText("Steuer", l8, 5, b8, 40)DrawVerticalLine(s9)DrawText("Saldo", l9, 5, b9, 40)DrawVerticalLine(s10)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 0 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif( KA_Zeilenart = KA_Kopfzeile )set konto to NthField(KA_Text, " ", 1)DrawLine(s1, 0, s10, 0)SetTextSize(10)SetTextBold(true)DrawText(KA_Text, l1, 80, s10-s1, 50)SetTextSize(8)set sumSaldo to 0endifif( KA_Zeilenart = KA_Eröffnungsbuchung  OR KA_Zeilenart = KA_Übertragszeile )DrawLine(s1, 0, s10, 0)SetTextBold(true)DrawVerticalLine(s1)DrawText(KA_Text, l1, 5, s10-s5, 40)DrawVerticalLine(s5)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawVerticalLine(s9)DrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l9, 5, b9, 40, ALIGN_RIGHT)set sumSaldo to KA_SaldoDrawVerticalLine(s10)endifif( KA_Zeilenart = KA_Journalzeile )DrawLine(s1, 0, s10, 0)DrawVerticalLine(s1)DrawText(ShortDate(KA_Datum), l2, 5, b2, 35, ALIGN_CENTER)DrawText(KA_BelegNr, l3, 5, b3, 300, ALIGN_LEFT)DrawText(KA_Text, l4, 5, b4, 300)DrawText(Format(KA_Gegenkonto, FORMATKONTO), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)set sumSoll to sumSoll + KA_BetragSollDrawVerticalLine(s7)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)set sumHaben to sumHaben + KA_BetragHabenDrawVerticalLine(s8)DrawText(KA_Steuersatz, l8, 5, b8, 160, ALIGN_CENTER)DrawVerticalLine(s9)DrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l9, 5, b9, 40, ALIGN_RIGHT)set sumSaldo to KA_SaldoDrawLine(s3, 0, s3, AREA_CURRENTHEIGHT)DrawLine(s4, 0, s4, AREA_CURRENTHEIGHT)DrawLine(s5, 0, s5, AREA_CURRENTHEIGHT)DrawLine(s6, 0, s6, AREA_CURRENTHEIGHT)DrawVerticalLine(s10)endif'-------------------------------------------------------letzte Summenzeileif ( KA_LetzteZeile )DrawLine(s1, AREA_CURRENTHEIGHT-1, s10, AREA_CURRENTHEIGHT-1)SetTextBold(true)set newheight to AREA_CURRENTHEIGHT+5DrawText("Verkehrszahlen/Saldo Konto: " + konto, l1, newheight, s6-s1-20, 160, ALIGN_LEFT)DrawText(Format(sumSoll, FORMATBETRAGNULL), l6, newheight, b6, 40, ALIGN_RIGHT)DrawText(Format(sumHaben, FORMATBETRAGNULL), l7, newheight, b7, 40, ALIGN_RIGHT)DrawText(Format(KA_Saldo, FORMATSALDONULL), l9, newheight, b9, 40, ALIGN_RIGHT)SetTextBold(false)endifif ( KA_FolgendeZeilenart = KA_Kopfzeile )set sumSoll to 0set sumHaben to 0set sumSaldo to 0endif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(41)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s10, 0)if( HasVariable("KA_Zeilenart") )if( (NOT KA_Zeilenart = KA_Kopfzeile) and (NOT KA_Zeilenart = KA_Summenzeile) )DrawLine(s1, 0, s1, 40)DrawText("Verkehrszahlen/Saldo Konto: " + konto, l2, 5, s6-s2-20, 50, ALIGN_LEFT)DrawLine(s6, 0, s6, 40)DrawText(Format(sumSoll, FORMATBETRAGNULL), l6, 5, b6, 50, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawText(Format(sumHaben, FORMATBETRAGNULL), l7, 5, b7, 50, ALIGN_RIGHT)DrawLine(s8, 0, s8, 40)DrawLine(s9, 0, s9, 40)DrawText(Format(sumSaldo, FORMATSALDONULL), l9, 5, b9, 50, ALIGN_RIGHT)DrawLine(s10, 0, s10, 40)DrawLine(s1, 40, s10, 40)endifendif#BeginTableFooterSetArea(10)DrawLine(s1, 0, s10, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------0000012