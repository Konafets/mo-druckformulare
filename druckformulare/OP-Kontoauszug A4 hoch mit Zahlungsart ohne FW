00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000046OP-Kontoauszug A4 hoch mit Zahlungsart ohne FW0000042017000004true000004true00000100000010000066OP-Kontoauszug im Format A4 hoch ohne Fremdwährung mit Zahlungsart005944' -----------------------------------------------------------------------------------------'' Formular : OP-Kontoauszug im Format A4 hoch' Historie : 30/07/2008: Initialversion sts' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "OP-Kontoauszug in " + App_GJWaehrung + " ohne Fremdwährung mit Zahlungsart"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 8 Spaltendim anzahlSpalten as number = 8dim s1 as number = 0dim s2 as number = 170dim s3 as number = 380dim s4 as number = 800dim s5 as number = 1000dim s6 as number = 1190dim s7 as number = 1380dim s8 as number = 1560dim s9 as number = LAYOUTWIDTH' Variablen definierendim row            as number = 0dim summeRechnung  as number = 0dim summeZahlung   as number = 0dim summeMinderung as number = 0dim summeSaldo     as number = 0#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(PA_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'OPKontoauszug'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("OPKontoauszug")DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText("Datum", l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Re.-Nr.", l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Text", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Zahlungsart", l4, 5, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Rechnung", l5, 5, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Zahlung", l6, 5, b6, 40, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Minderung", l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Saldo", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawVerticalLine(s1)'---------------------------------------------------------Vortragszeile-----if( PA_Zeilenart = PA_Vortragszeile )DrawLine(s1, 0, s9, 0)SetTextBold(true)DrawText(PA_Text, l1, 5, s4-s1, 50)DrawText(Format(PA_BetragSaldoSW, FORMATBETRAGNULL), l6, 5, s9-s6-20, 40, ALIGN_RIGHT)'---------------------------------------------------------Positionszeilen---elseif( PA_Zeilenart =  PA_Positionszeile )DrawLine(s1, 0, s9, 0)DrawText(DateToText(PA_Datum), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(PA_RechnungsNr, l2, 5, b2, 40, ALIGN_LEFT)DrawVerticalLine(s3)DrawText(PA_Text, l3, 5, b3, 190, ALIGN_LEFT)DrawVerticalLine(s4)DrawText(Choose(PA_Zahlungsart, "keine", "Bar", "Lastschrift", "Kreditkarte", "Überweisung", "Scheck", ""), l4, 5, b4, 40, ALIGN_CENTER)DrawText(Format(PA_BetragRechnungSW, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragZahlungSW, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragMinderungSW, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)elseif( PA_Zeilenart = PA_Summenzeile )DrawLine(s1, 0, s9, 0)SetTextBold(true)DrawText(PA_Text, l1, 5, s4-s1, 50)DrawText(Format(PA_BetragRechnungSW, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragZahlungSW, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragMinderungSW, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)endifendifDrawVerticalLine(s4)DrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)DrawVerticalLine(s8)DrawText(Format(PA_BetragSaldoSW, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)endifDrawVerticalLine(s9)set summeRechnung To summeRechnung + PA_BetragRechnungSWset summeZahlung To summeZahlung + PA_BetragZahlungSWset summeMinderung To summeMinderung + PA_BetragMinderungSWset summeSaldo To PA_BetragSaldoSW'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(42)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s1, 40)DrawLine(s4, 0, s4, 40)DrawLine(s5, 0, s5, 40)DrawLine(s6, 0, s6, 40)DrawLine(s7, 0, s7, 40)DrawLine(s8, 0, s8, 40)DrawLine(s9, 0, s9, 40)DrawLine(s1, 0, s9, 0)DrawLine(s1, 40, s9, 40)SetTextBold(true)DrawText("Zwischensumme:", l1, 5, s4-s1, 50)DrawText(Format(summeRechnung, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(summeZahlung, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(summeMinderung, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawText(Format(summeSaldo, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s9, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'OPKontoauszug'' -----------------------------------------------------------------------------------------0000011