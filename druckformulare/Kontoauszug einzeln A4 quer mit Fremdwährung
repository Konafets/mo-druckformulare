00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000044Kontoauszug einzeln A4 quer mit Fremdwährung0000042001000004true000004true00000100000010000047Einzelkonten im Format A4 quer mit Fremdwährung009863' -----------------------------------------------------------------------------------------'' Formular : Kontoauszug im Format A4 quer mit Fremdwährung' Historie : 16/08/2007: Initialversion vs' Geändert : 26/08/2008: sts (Verkehrszahlen/Saldo am Ende jeder Seite)' Geändert : 09/09/2010: hb  (Ausgabe Kontonummer in Saldenzeile)' Geändert : 14.11.2013: sts (Spaltenbreite für Steuersatz angepasst, Kontobezeichnung bei Saldenzeile entfernt)' Geändert : 26.02.2014: sts (Ausgabe für Kontostand "0,00")' Geändert : 27.01.2015: sts (mehrzeilige Ausgabe der Filterinformation)' Geändert : 04.07.2016: sts (Ausgabe Datum mit Jahr, Einzeilige Ausgabe steuerbar über Konstante)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text      = "Kontoauszug in " + App_GJWaehrung + " mit Fremdwährung"const HEAD_HEIGHT as number = 330const EINZEILIG as boolean  = FALSE' Globale Variablen definierendim sumSoll         as numberdim sumHaben        as numberdim sumSollFW       as numberdim sumHabenFW      as numberdim kontoWaehrung   as textdim sumSaldo        as numberdim sumSaldoFW      as numberdim konto           as textdim FORMATSALDONULL as text = "###,###,###,###.00\ \S;###,###,###,###..00\ \H;0.00"dim row             as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 14 Spaltendim anzahlSpalten as number = 14dim s1 as number = 0dim s2 as number = 190dim s3 as number = 360dim s4 as number = 510dim s5 as number = 820dim s6 as number = 970dim s7 as number = 1170dim s8 as number = 1370dim s9 as number = 1580dim s10 as number = 1780dim s11 as number = 1975dim s12 as number = 2160dim s13 as number = 2360dim s14 as number = 2460dim s15 as number = LAYOUTWIDTH' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KA_Filter, 0, 150, LAYOUTWIDTH, 150)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Kontoauszug")DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText("Nummer", l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Datum", s2, 5, b2+20, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Beleg", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Buchungstext", l4, 5, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Gegen- konto", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Betrag", l6, 5, s8-s6, 40, ALIGN_CENTER)DrawText("Soll", l6, 45, b6, 40, ALIGN_CENTER)DrawText("Haben", l7, 45, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Saldo", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("Steuer", l9, 5, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)DrawText("Betrag (FW)", l10, 5, s12-s10, 40, ALIGN_CENTER)DrawText("Soll (FW)", l10, 45, b10, 40, ALIGN_CENTER)DrawText("Haben (FW)", l11, 45, b11, 40, ALIGN_CENTER)DrawVerticalLine(s12)DrawText("Saldo(FW)", l12, 5, b12, 40, ALIGN_CENTER)DrawVerticalLine(s13)DrawText("Wäh- rung", l13, 5, b13, 80, ALIGN_CENTER)DrawVerticalLine(s14)DrawText("Kurs", l14, 5, b14, 40, ALIGN_CENTER)DrawVerticalLine(s15)'---------------------------------------------------------BeginTableRow-----#BeginTableRowif ( EINZEILIG )SetArea(40)elseSetArea(300, AREA_AUTOSIZE)endif#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 0 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif( KA_Zeilenart = KA_Kopfzeile )set konto to NthField(KA_Text, " ", 1)DrawLine(s1, 0, s15, 0)SetTextSize(10)SetTextBold(true)DrawText(KA_Text, l1, 80, s10-s1, 50)SetTextSize(8)DrawLine(s1, 125, s15, 125)set kontoWaehrung to KA_Währungset sumSoll to 0set sumHaben to 0set sumSollFW to 0set sumHabenFW to 0set sumSaldo to 0set sumSaldoFW to 0endifif( KA_Zeilenart = KA_Eröffnungsbuchung OR KA_Zeilenart = KA_Übertragszeile )DrawLine(s1, 0, s15, 0)SetTextBold(true)DrawVerticalLine(s1)DrawText(KA_Text, l1, 5, s10-s6, 40)DrawVerticalLine(s6)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)set sumSaldo to KA_SaldoDrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawVerticalLine(s10)if( kontoWaehrung <> "" )DrawText(Format(KA_BetragSollFW, FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawText(Format(KA_BetragHabenFW, FORMATBETRAGLEER), l11, 5, b11, 40, ALIGN_RIGHT)DrawText(Format(KA_SaldoFW, User_ListFormat), l12, 5, b12, 40, ALIGN_RIGHT)set sumSaldoFW to KA_SaldoFWendifDrawVerticalLine(s11)DrawVerticalLine(s12)DrawVerticalLine(s13)DrawVerticalLine(s14)DrawVerticalLine(s15)endifif( KA_Zeilenart = KA_Journalzeile )DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText(KA_Nummer, l1, 5, b1, 40, ALIGN_LEFT)DrawVerticalLine(s2)DrawText(ShortDate(KA_Datum), l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText(KA_BelegNr, l3, 5, b3, 300, ALIGN_LEFT)DrawVerticalLine(s4)DrawText(KA_Text, l4, 5, b4, 300)DrawVerticalLine(s5)DrawText(Format(KA_Gegenkonto, FORMATKONTO), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)set sumSoll to sumSoll + KA_BetragSollDrawVerticalLine(s7)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)set sumHaben to sumHaben + KA_BetragHabenDrawVerticalLine(s8)DrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l8, 5, b8, 40, ALIGN_RIGHT)set sumSaldo to KA_SaldoDrawVerticalLine(s9)DrawText(KA_Steuersatz, l9, 5, b9, 160, ALIGN_CENTER)DrawVerticalLine(s10)if( App_GJWaehrung <> KA_Währung )DrawText(Format(IfThen(KA_Währung<>App_GJWaehrung, KA_BetragSollFW, 0), FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawText(Format(IfThen(KA_Währung<>App_GJWaehrung, KA_BetragHabenFW, 0), FORMATBETRAGLEER), l11, 5, b11, 40, ALIGN_RIGHT)DrawText(Format(IfThen(KA_Währung<>App_GJWaehrung, KA_SaldoFW, 0), User_ListFormat), l12, 5, b12, 40, ALIGN_RIGHT)set sumSollFW to sumSollFW + KA_BetragSollFWset sumHabenFW to sumHabenFW + KA_BetragHabenFWset sumSaldoFW to KA_SaldoFWendifDrawVerticalLine(s11)DrawVerticalLine(s12)DrawVerticalLine(s13)DrawText(IfThen(KA_Währung<>App_GJWaehrung, KA_Währung, ""), l13, 5, b13, 160, ALIGN_CENTER)DrawText(IfThen(KA_Währung<>App_GJWaehrung, Format(KA_Kurs, FORMATKURSNULL), ""), l14, 5, b14, 40, ALIGN_RIGHT)DrawVerticalLine(s14)DrawVerticalLine(s15)endifPageBreak(KA_FolgendeZeilenart = KA_Kopfzeile)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(41)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s15, 0)DrawLine(s1, 40, s15, 40)DrawLine(s1, 0, s1, 40)DrawText("Verkehrszahlen/Saldo Konto: " + konto, l1, 5, s6-s1-20, 160, ALIGN_LEFT)DrawLine(s6, 0, s6, 40)DrawText(Format(sumSoll, FORMATBETRAGNULL), l6, 5, b6, 50, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawText(Format(sumHaben, FORMATBETRAGNULL), l7, 5, b7, 50, ALIGN_RIGHT)DrawLine(s8, 0, s8, 40)DrawText(Format(sumSaldo, FORMATSALDONULL), l8, 5, b8, 50, ALIGN_RIGHT)DrawLine(s9, 0, s9, 40)DrawLine(s10, 0, s10, 40)if( kontoWaehrung <> "" )DrawText(Format(sumSollFW, FORMATBETRAGNULL), l10, 5, b10, 50, ALIGN_RIGHT)DrawText(Format(sumHabenFW, FORMATBETRAGNULL), l11, 5, b11, 50, ALIGN_RIGHT)DrawText(Format(sumSaldoFW, FORMATSALDONULL), l12, 5, b12, 50, ALIGN_RIGHT)endifDrawLine(s11, 0, s11, 40)DrawLine(s12, 0, s12, 40)DrawLine(s13, 0, s13, 40)DrawLine(s14, 0, s14, 40)DrawLine(s15, 0, s15, 40)SetTextBold(false)#BeginTableFooterSetArea(41)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText("Verkehrszahlen/Saldo Konto: " + konto, l1, 5, s6-s1-20, 160, ALIGN_LEFT)DrawVerticalLine(s6)DrawText(Format(sumSoll, FORMATBETRAGNULL), l6, 5, b6, 50, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(sumHaben, FORMATBETRAGNULL), l7, 5, b7, 50, ALIGN_RIGHT)DrawVerticalLine(s8)DrawText(Format(sumSaldo, FORMATSALDONULL), l8, 5, b8, 50, ALIGN_RIGHT)DrawVerticalLine(s9)DrawVerticalLine(s10)if( kontoWaehrung <> "" )DrawText(Format(sumSollFW, FORMATBETRAGNULL), l10, 5, b10, 40, ALIGN_RIGHT)DrawText(Format(sumHabenFW, FORMATBETRAGNULL), l11, 5, b11, 40, ALIGN_RIGHT)DrawText(Format(sumSaldoFW, FORMATSALDONULL), l12, 5, b12, 40, ALIGN_RIGHT)endifDrawVerticalLine(s11)DrawVerticalLine(s12)DrawVerticalLine(s13)DrawVerticalLine(s14)DrawVerticalLine(s15)DrawLine(s1, 40, s15, 40)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------0000012