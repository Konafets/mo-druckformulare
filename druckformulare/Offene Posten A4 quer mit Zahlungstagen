00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000039Offene Posten A4 quer mit Zahlungstagen0000042013000004true000004true00000100000010000057Offene Posten A4 quer mit Zahlungstagen und Skontoanzeige006424' -----------------------------------------------------------------------------------------'' Formular : Offene Posten im Format A4 quer' Historie : 05.09.2007: Initialversion vs' Geändert : 02.02.2013: hb Vorzeichenbhandlung für Wert "Tage fällig" korrigiert' Geändert : 23.05.2013: sts (Spaltenbreite für Datum an langes Datumsformat angepasst)' Geändert : 17.10.2013: sts (Ausgabe Skonto-Datum unterdrücken, wenn kein Datum vorhanden ist)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Offene Posten in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row          as number = 0dim summeBrutto  as numberdim summeBezahlt as numberdim summeOffen   as numberdim debitor      as boolean = (Position(OP_Filter, "Debitor", 1, 1) > 0)' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 15 Spaltendim anzahlSpalten as number = 14dim s1 as number = 0dim s2 as number = 70dim s3 as number = 240dim s4 as number = 600dim s5 as number = 720dim s6 as number = 1160dim s7 as number = 1380dim s8 as number = 1550dim s9 as number = 1660dim s10 as number = 1830dim s11 as number = 1920dim s12 as number = 2010dim s13 as number = 2210dim s14 as number = 2410dim s15 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(OP_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Offene Posten'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Offene Posten")DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText("Art", s1, 5, s2-s1, 40)DrawVerticalLine(s2)DrawText("Datum", l2-5, 5, b2+10, 40)DrawVerticalLine(s3)DrawText("Adr.-Typ", s3, 5, s5-s3, 40)DrawText("Bezeichnung", l3, 45, b3, 40)DrawText("Konto", l4, 45, b4, 40)DrawVerticalLine(s5)DrawText("Bu.-Text", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Re.-Nr.", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("Fällig", s7, 5, s9-s7, 40)DrawText("Datum", l7, 45, b7, 40)DrawText("Tage", l8, 45, b8, 40)DrawVerticalLine(s9)DrawText("Skonto", s9, 5, s12-s9, 40)DrawText("Datum", l9, 45, b9, 40)DrawText("Tage", l10, 45, b10, 40)DrawText("%", l11, 45, b11, 40)DrawVerticalLine(s12)DrawText("Brutto", l12, 5, b12, 40)DrawVerticalLine(s13)DrawText("Bezahlt", l13, 5, b13, 40)DrawVerticalLine(s14)DrawText("Offen", l14, 5, b14, 40)DrawVerticalLine(s15)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)if(OP_Art = OP_ReArt_DebiRechnung OR OP_Art = OP_ReArt_KrediRechnung)DrawText("RE", l1, 5, b1, 40, ALIGN_CENTER)elseif(OP_Art = OP_ReArt_DebiGutschrift OR OP_Art = OP_ReArt_KrediGutschrift)DrawText("GS", l1, 5, b1, 40, ALIGN_CENTER)elseDrawText("#WERT!", l1, 5, b1, 120, ALIGN_CENTER)endifDrawVerticalLine(s2)if ( DateToNumber(OP_Datum) > 0 )DrawText(DateToText(OP_Datum), l2, 5, b2, 40, ALIGN_CENTER)endifDrawVerticalLine(s3)DrawText(OP_AdrMatchcode, l3, 5, b3, 300)DrawVerticalLine(s4)DrawText(Format(OP_Personenkonto, FORMATKONTO), l4, 5, b4, 300, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(OP_BuText, l5, 5, b5, 300, ALIGN_LEFT)DrawVerticalLine(s6)DrawText(OP_RechnungsNr, l6, 5, b6, 160, ALIGN_LEFT)DrawVerticalLine(s7)if ( DateToNumber(OP_FaelligNetto) > 0 )DrawText(DateToText(OP_FaelligNetto), l7, 5, b7, 40, ALIGN_CENTER)endifDrawVerticalLine(s8)DrawText(Format(OP_TageFaellig, "+0"), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)if ( DateToNumber(OP_FaelligSkonto) > 0 )DrawText(DateToText(OP_FaelligSkonto), l9, 5, b9, 40, ALIGN_RIGHT)endifDrawVerticalLine(s10)DrawText(Format(OP_TageSkonto, FORMATBETRAGGANZ), l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(Format(OP_ProzentSkonto, "0"), l11, 5, b11, 40, ALIGN_RIGHT)DrawVerticalLine(s12)DrawText(Format(OP_GesamtBruttoSW, FORMATBETRAGLEER), l12, 5, b12, 40, ALIGN_RIGHT)set summeBrutto to summeBrutto + OP_GesamtBruttoSWDrawVerticalLine(s13)DrawText(Format(OP_BezahltSW, FORMATBETRAGLEER), l13, 5, b13, 40, ALIGN_RIGHT)set summeBezahlt to summeBezahlt + OP_BezahltSWDrawVerticalLine(s14)DrawText(Format(OP_OffenSW, FORMATBETRAGLEER), l14, 5, b14, 40, ALIGN_RIGHT)set summeOffen to summeOffen + OP_OffenSWDrawVerticalLine(s15)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s15, 0)#BeginTableFooter#include "STYLE Arial 8, fett"SetArea(42)DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText("Summe", l1, 5, s8 - s6 - 20, 40)DrawVerticalLine(s12)DrawText(Format(Round(summeBrutto*100)/100, FORMATBETRAGLEER), l12, 5, b12, 40, ALIGN_RIGHT)DrawVerticalLine(s13)DrawText(Format(Round(summeBezahlt*100)/100, FORMATBETRAGLEER), l13, 5, b13, 40, ALIGN_RIGHT)DrawVerticalLine(s14)DrawText(Format(Round(summeOffen*100)/100, FORMATBETRAGLEER), l14, 5, b14, 40, ALIGN_RIGHT)DrawVerticalLine(s15)DrawLine(s1, 40, s15, 40)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Offene Posten'' -----------------------------------------------------------------------------------------0000012