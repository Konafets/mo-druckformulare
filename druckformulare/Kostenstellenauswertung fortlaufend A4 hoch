00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000043Kostenstellenauswertung fortlaufend A4 hoch0000042010000004true000004true00000100000010000043Kostenstellenauswertung fortlaufend A4 hoch003574' -----------------------------------------------------------------------------------------'' Formular : Kostenstellenauswertung im Format A4 hoch' Historie : 20.08.2007: Initialversion vs' Geändert : 22.09.2008: hb' -----------------------------------------------------------------------------------------#BeginDocument'-----------------------------------------------------------------------------------------' Glbale Konstantenconst DOCTITEL as Text = "Kostenstellenauswertung in " + App_GJWaehrung#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Position der 8 Spaltendim AnzahlSpalten as number = 8dim s1 as number = 0dim s2 as number = 50dim s3 as number = 100dim s4 as number = 750dim s5 as number = 920dim s6 as number = 1150dim s7 as number = 1350dim s8 as number = 1550dim s9 as number = LAYOUTWIDTHdim ksFolgt as Boolean = true#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KS_Filter, 0, 150, LAYOUTWIDTH, 50)'-----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)SetCurrentTable("Kostenstellen")#include "STYLE Arial 8, fett"DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText("Kostenstelle", l1, 5, s4-s1, 40,ALIGN_LEFT)DrawVerticalLine(s4)DrawText("Datum", l4, 5, b4, 40,ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Beleg", l5, 5, b5, 40,ALIGN_LEFT)DrawVerticalLine(s6)DrawText("Betrag", l6, 5, s8-s6, 40,ALIGN_CENTER)DrawText("Soll", l6, 45, b6, 40,ALIGN_CENTER)DrawLine(s7, 40, s7, 80)DrawText("Haben", l7, 45, b7, 40,ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Saldo", l8, 5, b8, 40,ALIGN_CENTER)DrawVerticalLine(s9)'DrawLine(s1, 40, s9, 40)'-----------------------------------------------------------------------------------------#BeginTableRow'-----------------------------------------------------------------------------------------SetArea(200, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)if(KS_Kostenstelle)SetTextBold(TRUE)DrawText(KS_Text, l1, 5, s8-s1-20, 200,ALIGN_LEFT)DrawVerticalLine(s8)DrawText(Format(KS_Saldo,User_ListFormat), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)SetTextBold(FALSE)'Verzweigung Ebene 2elseif (KS_Konto)DrawText(KS_Text, l2, 5, s4-s2-20, 200,ALIGN_LEFT)DrawVerticalLine(s8)DrawText(Format(KS_Saldo, User_ListFormat), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)'Verzweigung Ebene 3elseif (KS_Buchung)DrawText(KS_Text, l3, 5, b3, 200,ALIGN_LEFT)DrawVerticalLine(s4)DrawText(DateToText(KS_Datum), l4,5, b4, 40, ALIGN_CENTER)DrawVerticalLine(s5)DrawText(KS_BelegNr,l5 , 5, b5, 40)DrawVerticalLine(s6)DrawText(Format(KS_BetragSoll,FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(Format(KS_BetragHaben, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)DrawVerticalLine(s9)endif'msgBox(NumToText(KS_FolgendeEbeneNr))#BeginTableBreakSetArea(10)DrawLine(s1, 0, s9, 0)'-----------------------------------------------------------------------------------------#BeginTableFooter'-----------------------------------------------------------------------------------------SetArea(10)DrawLine(s1, 0, s9, 0)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------0000011