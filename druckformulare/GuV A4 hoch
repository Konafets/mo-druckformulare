00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000011GuV A4 hoch0000042004000004true000004true00000100000010000040GuV im Format A4 hoch inkl. Kontensalden005045' -----------------------------------------------------------------------------------------'' Formular : GuV-Rechnung mit Vorjahresvergleich im Format A4 hoch' Historie : 09.08.2007: Initialversion mm' Geändert : 21.04.2009: sts: automatische Ausgabe Vorjahressalden/Budget'            05.06.2018: sts: Spaltenbreiten geändert, getrennte Ausgabe für Kontonummer und Kontobezeichnung'            17.07.2019: sts: Abstand Ausgabe erste Kontozeile zur Untergruppe'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Gewinn- und Verlustrechnung in " + App_GJWaehrung' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"if ( BZ_MitVorjahr or BZ_MitBudget )' Variablen für die Positionen der 3 Spalten' bei Ausgabe mit Budget oder Vorjahresvergleichdim delta as number = 50dim anzahlSpalten as number = 3dim s1 as number = 0dim s2 as number = 890dim s3 as number = 1320dim s4 as number = LAYOUTWIDTHelse' Variablen für die Positionen der 2 Spalten' bei Ausgabe ohne Budget oder Vorjahresvergleichdim delta as number = 100dim anzahlSpalten as number = 2dim s1 as number = 10dim s2 as number = 1100dim s3 as number = LAYOUTWIDTHendif#include "TEMPLATE Table"dim guv       as boolean = falsedim istGruppe as booleandim deltaKto  as number = 100dim hoehe     as number'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(BZ_Filter, 0, 150, LAYOUTWIDTH, 50)'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Bilanz'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetCurrentTable("Bilanz")if ( BZ_MitVorjahr or BZ_MitBudget )SetArea(90)#include "STYLE Arial 10, fett"DrawText("Position", l1, 0, b1, 300, ALIGN_CENTER)DrawText("Saldo", l2, 0, b2, 50, ALIGN_CENTER)DrawText(IfThen(BZ_MitVorjahr, "Saldo Vorjahr", "Budget"), l3, 0, b3, 50, ALIGN_CENTER)DrawVerticalLine(s2)DrawVerticalLine(s3)DrawLine(s1, 79, s4, 79)endif#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"if ( BZ_MitVorjahr or BZ_MitBudget )DrawVerticalLine(s2)DrawVerticalLine(s3)endifif (BZ_Position = "Gewinn- und Verlustrechnung")set guv to trueendifif ( BZ_Gruppe )set istGruppe to TRUEendifif(BZ_Gruppe AND BZ_EbeneNr = 1 AND guv)SetTextBold(true)SetTextSize(10)DrawText(BZ_Position, l1, 0, b1, 300)DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, 0, b2, 50, ALIGN_RIGHT)if ( BZ_MitVorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, 0, b3, 50, ALIGN_RIGHT)endifif ( BZ_MitBudget )DrawText(Format(BZ_Budget, FORMATBETRAGLEER), l3, 0, b3, 50, ALIGN_RIGHT)endifelseif(BZ_Gruppe AND BZ_EbeneNr = 2 AND guv)SetTextBold(false)SetTextSize(10)DrawText(BZ_Position, l1+delta, 20, b1-1*delta, 300)DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, 20, b2-delta, 50, ALIGN_RIGHT)if ( BZ_MitVorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, 20, b3-delta, 50, ALIGN_RIGHT)endifif ( BZ_MitBudget )DrawText(Format(BZ_Budget, FORMATBETRAGLEER), l3, 20, b3-delta, 50, ALIGN_RIGHT)endifelseif(BZ_Gruppe AND BZ_EbeneNr = 3 AND guv)SetTextBold(true)SetTextSize(8)DrawText(BZ_Position, s1+2*delta, 20, b1-2*delta, 300)DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, 20, b2-2*delta, 40, ALIGN_RIGHT)if ( BZ_MitVorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, 20, b3-2*delta, 40, ALIGN_RIGHT)endifif ( BZ_MitBudget )DrawText(Format(BZ_Budget, FORMATBETRAGLEER), l3, 20, b3-2*delta, 40, ALIGN_RIGHT)endifelseif(BZ_Gruppe AND BZ_EbeneNr = 4 AND guv)SetTextBold(false)SetTextSize(8)DrawText(BZ_Position, s1+3*delta, 20, b1-3*delta, 300)DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, 20, b2-3*delta, 40, ALIGN_RIGHT)if ( BZ_MitVorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, 20, b3-3*delta, 40, ALIGN_RIGHT)endifif ( BZ_MitBudget )DrawText(Format(BZ_Budget, FORMATBETRAGLEER), l3, 20, b3-3*delta, 40, ALIGN_RIGHT)endifelseif(BZ_Konto AND guv)SetTextBold(false)SetTextSize(8)set hoehe to IfThen(istGruppe, 10, 0)DrawText(BZ_KontoNummer, s1+4*delta, hoehe, deltaKto, 40)DrawText(BZ_KontoName, s1+4*delta+deltaKto, hoehe, b1-4*delta-deltaKto, 300)DrawText(Format(BZ_Saldo, FORMATBETRAGLEER), l2, hoehe, b2-4*delta, 40, ALIGN_RIGHT)if ( BZ_MitVorjahr )DrawText(Format(BZ_SaldoVj, FORMATBETRAGLEER), l3, hoehe, b3-4*delta, 40, ALIGN_RIGHT)endifif ( BZ_MitBudget )DrawText(Format(BZ_Budget, FORMATBETRAGLEER), l3, hoehe, b3-4*delta, 40, ALIGN_RIGHT)endifset istGruppe to FALSEendif#BeginTableBreak#BeginTableFooter'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------0000011