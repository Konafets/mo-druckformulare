00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000053Journal A4 quer mit Gegenkonto mit Referenz und Notiz0000042000000004true000004true00000100000010000086Buchungsjournal im Format A4 quer mit Gegenkonto mit Referenz, Notiz und Verbuchtdatum007153' -----------------------------------------------------------------------------------------'' Formular : Journal im Format A4 quer' Historie : 19.07.2007: Initialversion vs' Geändert : 06.10.2009: at & hb Buchungstext -, Datums -,  und Belegnummer - Ausgabe. verändert' Geändert : 14.11.2013: sts (Spaltenbreite für Steuersatz angepasst)' Geändert : 12.03.2015: sts (mehrzeilige Ausgabe der Filterinformation)' Geändert : 18.11.2015: sts (Prüfung ob Buchungsdatum vorhanden ist, Spalte "Storno" entfernt, Spalte "Verbucht am" hinzugefügt)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)' Geändert : 31.05.2018: sts (Statustext geändert, Spaltenbreiten, Summenausgabe "0,00" bei Null)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Journal in " + App_GJWaehrungconst HEAD_HEIGHT as number = 330' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row        as number = 0dim summeSoll  as numberdim summeHaben as numberdim bText      as textdim jText      as text' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 12 Spaltendim anzahlSpalten as number = 12dim s1 as number = 0dim s2 as number = 130dim s3 as number = 300dim s4 as number = 500dim s5 as number = 840dim s6 as number = 980dim s7 as number = 1120dim s8 as number = 1340dim s9 as number = 1560dim s10 as number = 1850dim s11 as number = 2300dim s12 as number = 2430dim s13 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(J_Filter, 0, 150, LAYOUTWIDTH, 150)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Journal'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Journal")DrawLine(s1, 0, s13, 0)DrawVerticalLine(s1)DrawText("Nummer", s1, 5, s2-s1, 40)DrawVerticalLine(s2)DrawText("Datum", l2-5, 5, b2+10, 40)DrawText("BelegNr.", l2-5, 38, b2+10, 40)DrawVerticalLine(s3)DrawText("Referenz", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Text", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Konto", l5, 5, b5, 40)DrawVerticalLine(s6)DrawText("Gegen-", l6, 5, b6, 40)DrawText("konto", l6, 38, b6, 40)DrawVerticalLine(s7)DrawText("Betrag", l7, 5, s9 - s7 - 20, 40)DrawText("Soll", l7, 38, b7, 40)DrawText("Haben", l8, 38, b8, 40)DrawVerticalLine(s9)DrawText("Steuer", l9, 5, b9, 40)DrawVerticalLine(s10)DrawText("Notiz", l10, 5, b10, 40)DrawVerticalLine(s11)DrawText("Status", l11, 5, b11, 40)DrawVerticalLine(s12)DrawText("Verbucht", l12, 5, b12, 40)DrawText("am", l12, 38, b12, 40)DrawVerticalLine(s13)DrawLine(s1, 79, s13, 79)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif(J_NeueBuchung)DrawLine(s1, 0, s13, 0)if ( DateToNumber(J_Datum) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(J_Datum), ShortDate(J_Datum)), l2, 5, b2, 40, ALIGN_LEFT)elseDrawText("Datum fehlt!", l2, 5, b2, 40, ALIGN_LEFT)endifSetTextSize(7)DrawText(J_BelegNr, l2, 38, b2, 300, ALIGN_LEFT)SetTextSize(8)endifDrawVerticalLine(s1)DrawText(J_Nummer, l1, 5, b1, 40, ALIGN_LEFT)DrawVerticalLine(s2)DrawVerticalLine(s3)if(J_NeueBuchung)DrawText(J_Referenz, l3, 5, b3, 300)endifDrawVerticalLine(s4)if ( J_NeueBuchung )set bText to J_Textset jText to bTextelseset jText to ReplaceAll(J_Text, bText, "")set jText to ReplaceAll(jText, "% ()", "% ")endifSetTextSize(7)DrawText(jText, l4, 5, b4, 300)SetTextSize(8)DrawVerticalLine(s5)DrawText(Format(J_Konto, FORMATKONTO), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(J_Gegenkonto, FORMATKONTO), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)set summeSoll to summeSoll + J_BetragSollDrawText(Format(J_BetragSoll, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)DrawVerticalLine(s8)set summeHaben to summeHaben + J_BetragHabenDrawText(Format(J_BetragHaben, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(J_Steuersatz, l9, 5, b9, 80, ALIGN_CENTER)DrawVerticalLine(s10)if(J_NeueBuchung)DrawText(J_Notiz, l10, 5, b10, 300, ALIGN_LEFT)endifDrawVerticalLine(s11)if(J_Status=0)DrawText("ERR", s11+10, 5, s12-s11-20, 40, ALIGN_CENTER)endifif(J_Status=1)DrawText("NF", s11+10, 5, s12-s11-20, 40, ALIGN_CENTER)endifif(J_Status=2)DrawText("F", s11+10, 5, s12-s11-20, 40, ALIGN_CENTER)endifif(J_Status=3)DrawText("S", s11+10, 5, s12-s11-20, 40, ALIGN_CENTER)endifDrawVerticalLine(s12)if ( DateToNumber(J_DatumVerbucht) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(J_DatumVerbucht), ShortDate(J_DatumVerbucht)), l12, 5, b12, 40, ALIGN_LEFT)endifDrawVerticalLine(s13)'-------------------------------------------------------BeginTableBreak---#BeginTableBreak#include "STYLE Arial 8, fett"SetArea(42)DrawLine(s1, 0, s13, 0)DrawLine(s1, 0, s1, 40)DrawText("Zwischensumme:", l1, 5, s7-s1-20, 40, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawText(Format(Round(summeSoll*100)/100, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawLine(s8, 0, s8, 40)DrawText(Format(Round(summeHaben*100)/100, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawLine(s9, 0, s9, 40)DrawLine(s13, 0, s13, 40)DrawLine(s1, 40, s13, 40)#BeginTableFooter#include "STYLE Arial 8, fett"SetArea(80)DrawLine(s1, 0, s13, 0)DrawLine(s1, 0, s1, 40)DrawText("Summe:", l1, 5, s7-s1-20, 40, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawText(Format(Round(summeSoll*100)/100, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawLine(s8, 0, s8, 40)DrawText(Format(Round(summeHaben*100)/100, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawLine(s9, 0, s9, 40)DrawLine(s13, 0, s13, 40)DrawLine(s1, 40, s13, 40)#include "STYLE Arial 7, normal"DrawText("Status: NF = Nicht festgeschrieben, F = Festgeschrieben, S = Storniert, ERR = Fehler", l1, 45, s12 - s1 - 20, 40)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Journal'' -----------------------------------------------------------------------------------------0000012