00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000031Offene Posten Debitoren A4 quer0000041004000004true000004true00000100000010000061Offene Posten Debitoren im Format A4 quer mit Standardwährung005065' -----------------------------------------------------------------------------------------'' Formular : Offene Posten Debitoren im Format A4 quer' Historie : 27.08.2007: Initialversion vs' Geändert : 28.08.2007: vs'            23.05.2013: sts (Spaltenbreite für Datum an langes Datumsformat angepasst)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Offene Posten Debitoren in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim summeOffen    as numberdim summeBezahlt  as numberdim row           as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 10 Spaltendim anzahlSpalten as number = 10dim s1 as number = 0dim s2 as number = 100dim s3 as number = 270dim s4 as number = 650dim s5 as number = 870dim s6 as number = 1450dim s7 as number = 1700dim s8 as number = 1870dim s9 as number = 2110dim s10 as number = 2370dim s11 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(DR_ReArt_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'OP-Debitoren'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("OP-Debitoren")DrawLine(s1, 0, s11, 0)DrawVerticalLine(s1)DrawText("Art", s1, 5, s2-s1, 40)DrawVerticalLine(s2)DrawText("Datum", l2-5, 5, b2+10, 40)DrawVerticalLine(s3)DrawText("Debitor", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Deb.-Konto", l4, 5, b4, 40)DrawVerticalLine(s5)DrawText("Buchungstext", l5, 5, b5, 300)DrawVerticalLine(s6)DrawText("Re.-Nr.", l6, 5, b6, 40)DrawVerticalLine(s7)DrawText("Fällig am", l7, 5, b7, 40)DrawVerticalLine(s8)DrawText("Brutto", l8, 5, b8, 40)DrawVerticalLine(s9)DrawText("Bezahlt", l9, 5, b9, 40)DrawVerticalLine(s10)DrawText("Offen", l10, 5, b10, 40)DrawVerticalLine(s11)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawLine(s1, 0, s11, 0)DrawVerticalLine(s1)if(DR_Art = DR_ReArt_DebiRechnung)DrawText("RE", l1, 5, b1, 40, ALIGN_CENTER)elseif(DR_Art = DR_ReArt_DebiGutschrift)DrawText("GS", l1, 5, b1, 40, ALIGN_CENTER)elseDrawText("#WERT!", l1, 5, b1, 40, ALIGN_CENTER)endifDrawVerticalLine(s2)DrawText(DateToText(DR_Datum), l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText(DR_AdrMatchcode, l3, 5, b3, 300)DrawVerticalLine(s4)DrawText(Format(DR_Personenkonto, FORMATKONTO), l4, 5, b4, 300, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(DR_BuText, l5, 5, b5, 300, ALIGN_LEFT)DrawVerticalLine(s6)DrawText(DR_RechnNr, l6, 5, b6, 70, ALIGN_LEFT)DrawVerticalLine(s7)DrawText(DateToText(DR_FaelligNetto), l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText(Format(DR_GesamtBruttoSW, FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(DR_BezahltSW, FORMATBETRAGLEER), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)set summeBezahlt to summeBezahlt + DR_BezahltSWDrawText(Format(DR_OffenSW, FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)set summeOffen to summeOffen + DR_OffenSW'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s11, 0)#BeginTableFooter#include "STYLE Arial 8, fett"SetArea(42)DrawLine(s1, 0, s11, 0)DrawVerticalLine(s1)DrawText("Summe", l1, 5, s8 - s6 - 20, 40)DrawVerticalLine(s9)DrawText(Format(summeBezahlt, FORMATBETRAGLEER), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(summeOffen, FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawVerticalLine(s11)DrawLine(s1, 40, s11, 40)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'OP-Debitoren'' -----------------------------------------------------------------------------------------0000012