00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000025Verkaufsstatistik A4 quer0000042020000004true000004true00000100000010000035Verkaufsstatistik im Format A4 quer012037' -----------------------------------------------------------------------------------------'' Formular : Verkaufsstatistik im Format A4 hoch' Historie : 04/08/2008: Initialversion sts' Geändert : 21/12/2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'            15/03/2017: Ausgabe von Detailinformationen über Schalter "DETAIL_ANSICHT" möglich'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = IfThen(VS_Periodenvergleich, "Verkaufsstatistik in " + App_GJWaehrung + " mit Vergleichszeitraum", "Verkaufsstatistik in " + App_GJWaehrung + " ohne Vergleichszeitraum")' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' ********************************************************************************' Über die folgenden Konstante können weitere Details zu den Postionen' angezeigt werden (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const DETAIL_ANSICHT as boolean = FALSE' ********************************************************************************' Variablen definierendim row          as number = 0dim posRow       as boolean = TRUEdim sumDetailPos as booleandim firstPos     as booleandim hoehe        as numberdim detailInfo   as text' Variablen für die Positionen der 8 Spaltendim anzahlSpalten as number = 8if( VS_Periodenvergleich )dim s1 as number = 0dim s2 as number = 250dim s3 as number = 650dim s4 as number = 1200dim s5 as number = 1700dim s6 as number = 1900dim s7 as number = 2150dim s8 as number = 2350dim s9 as number = LAYOUTWIDTHelsedim s1 as number = 0dim s2 as number = 250dim s3 as number = 650dim s4 as number = 1300dim s5 as number = 1500dim s6 as number = 1700dim s7 as number = 1900dim s8 as number = 2250dim s9 as number = LAYOUTWIDTHendifdim FORMATPROZENT as text = "-#.00"dim FORMATANZAHL  as text = "#." + Left("0000", Firma_FakturaNKMenge) + ";-#." + Left("0000", Firma_FakturaNKMenge) + ";\-"dim FORMATBETRAG as text = "###,###,##0.00;-###,###,##0.00;\-"#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"SetTextSize(9)DrawText(VS_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'VKStatistik'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("VKStatistik")DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)if ( not VS_AnzeigeArtikelgruppe )if ( VS_AuswertungsArt = VS_Kundenumsaetze )DrawText("Adress-Nr", s1, 5, b1, 40, ALIGN_CENTER)DrawText("Konto", s2, 5, b2, 40, ALIGN_CENTER)elseDrawText("Artikel-Nr", s1, 5, b1, 40, ALIGN_CENTER)DrawText("EAN", s2, 5, b2, 40, ALIGN_CENTER)endifDrawVerticalLine(s2)DrawVerticalLine(s3)endifif ( VS_Periodenvergleich )if ( VS_AnzeigeArtikelgruppe )DrawText("Warengruppe", s1, 5, s5 - s1, 40, ALIGN_CENTER)elseif ( VS_AuswertungsArt <> VS_Kundenumsaetze )DrawText("Matchcode", s3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Bezeichnung", s4, 5, b4, 40, ALIGN_CENTER)elseDrawText("Matchcode", s3, 5, s5 - s3, 40, ALIGN_CENTER)endifendifDrawVerticalLine(s5)if ( VS_AuswertungsArt = VS_Artikelumsaetze )DrawText("Umsatz P1", l5, 5, b5, 40, ALIGN_CENTER)DrawText("Umsatz P2", l7, 5, b7, 40, ALIGN_CENTER)elseDrawText("Anzahl P1", l5, 5, b5, 40, ALIGN_CENTER)DrawText("Anzahl P2", l7, 5, b7, 40, ALIGN_CENTER)endifDrawVerticalLine(s6)if ( VS_AuswertungsArt = VS_Artikelumsatzstueck OR VS_AuswertungsArt = VS_Kundenumsaetze )DrawText("Umsatz P1", l6, 5, b6, 40, ALIGN_CENTER)DrawText("Umsatz P2", l8, 5, b8, 40, ALIGN_CENTER)elseDrawText("% von Gesamt", l6, 5, b6, 40, ALIGN_CENTER)DrawText("% von Gesamt", l8, 5, b8, 40, ALIGN_CENTER)endifelseif ( VS_AnzeigeArtikelgruppe )DrawText("Warengruppe", s1, 5, s7 - s1, 40, ALIGN_CENTER)elseif ( VS_AuswertungsArt <> VS_Kundenumsaetze )DrawText("Matchcode", s3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Bezeichnung", s4, 5, s7 - s4, 40, ALIGN_CENTER)elseDrawText("Matchcode", s3, 5, s7-s3, 40, ALIGN_CENTER)endifendifif ( VS_AuswertungsArt = VS_Artikelumsaetze )DrawText("Umsatz P1", l7, 5, b7, 40, ALIGN_CENTER)elseDrawText("Anzahl P1", l7, 5, b7, 40, ALIGN_CENTER)endifif ( VS_AuswertungsArt = VS_Artikelumsatzstueck OR VS_AuswertungsArt = VS_Kundenumsaetze )DrawText("Umsatz P1", l8, 5, b8, 40, ALIGN_CENTER)elseDrawText("% von Gesamt", l8, 5, b8, 40, ALIGN_CENTER)endifendifDrawVerticalLine(s7)DrawVerticalLine(s8)DrawVerticalLine(s9)set firstPos to TRUE'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"set hoehe to 0if ( DETAIL_ANSICHT and VS_Zeilenart = VS_DetailSummenzeile )if ( PAGE_CURRENTHEIGHT > PAGE_HEIGHT - 220 )PageBreak(TRUE)endifendif' Linien und Zeilenhintergrund zeichnen, Textformatierung festlegenif (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))if ( DETAIL_ANSICHT )if ( VS_Zeilenart = VS_DetailSummenzeile or VS_Zeilenart = VS_Summenzeile )set row to 0elseset row to row + 1endifelseif ( VS_Zeilenart = VS_Positionszeile or VS_Zeilenart = VS_Summenzeile )set row to row + 1endifendifif ( Mod(row, 2) = 1 )FillAreaVertical(hoehe, LAYOUTWIDTH)endifendifif ( VS_Zeilenart = VS_Positionszeile )DrawLine(s1, hoehe, s9, hoehe)set posRow to TRUEset sumDetailPos to FALSEif ( DETAIL_ANSICHT )SetTextBold(TRUE)endifif ( not VS_AnzeigeArtikelgruppe )DrawVerticalLine(s2)DrawVerticalLine(s3)if ( VS_AuswertungsArt <> VS_Kundenumsaetze )DrawVerticalLine(s4)endifendifendifif ( DETAIL_ANSICHT and VS_Zeilenart = VS_Detailzeile )SetTextBold(FALSE)if ( posRow or firstPos )DrawLine(s1, hoehe, s9, hoehe)set posRow to FALSEendifendifif ( DETAIL_ANSICHT and VS_Zeilenart = VS_DetailSummenzeile and not firstPos )DrawLine(s1, hoehe, s9, hoehe)DrawLine(s1, hoehe + 40, s1, hoehe + 40)set sumDetailPos to TRUEendifif ( VS_Zeilenart <> VS_DetailSummenzeile )DrawVerticalLine(s1)DrawVerticalLine(s7)DrawVerticalLine(s8)DrawVerticalLine(s9)if ( VS_Periodenvergleich )DrawVerticalLine(s5)DrawVerticalLine(s6)endifendifif ( VS_Zeilenart = VS_Summenzeile )DrawLine(s1, hoehe, s9, hoehe)SetTextBold(TRUE)endif' Ausgabe der Positionenif ( VS_Periodenvergleich )if ( VS_Zeilenart = VS_Summenzeile )DrawText(VS_Bezeichnung, l1, hoehe + 5, s7 - s1 - 20, 80)endifif ( VS_Zeilenart = VS_Positionszeile )if ( VS_AuswertungsArt = VS_Kundenumsaetze )DrawText(VS_AdressNr, l1, hoehe + 5, b1, 40, ALIGN_CENTER)if ( VS_DebStatus = 1 )DrawText(numToText(VS_DebKonto), l2, hoehe + 5, b2, 40, ALIGN_CENTER)endifDrawText(VS_Matchcode, l3, hoehe + 5, s5 - s3 - 20, 80)elseif ( VS_AnzeigeArtikelgruppe )DrawText(IfThen(VS_AnzeigeArtikelgruppe, VS_Artikelgruppe, VS_Matchcode), l1, hoehe + 5, s5 - s1 - 20, 40)elseDrawText(VS_ArtikelNr, l1, hoehe + 5, b1, 40, ALIGN_CENTER)DrawText(VS_EAN, l2, hoehe + 5, b2, 40, ALIGN_CENTER)DrawText(IfThen(VS_AnzeigeArtikelgruppe, VS_Artikelgruppe, VS_Matchcode), l3, hoehe + 5, b3, 80)DrawText(VS_Bezeichnung, l4, hoehe + 5, b4, 80)endifendifendifif ( DETAIL_ANSICHT and VS_Zeilenart = VS_Detailzeile )if ( VS_DetailAuswertungsArt = VS_Kundenumsaetze )set detailInfo to VS_Matchcode + " (Adr-Nr.: " + VS_AdressNr + ", " + IfThen(VS_DebStatus = 1, "D-Konto: " + NumToText(VS_DebKonto), "") + ")"DrawText(detailInfo, l1, hoehe + 5, s5 - s1 - 20, 40, ALIGN_RIGHT)elseset detailInfo to VS_Bezeichnungif ( VS_ArtikelNr <> "" )set detailInfo to detailInfo + " (Artikel-Nr.: " + VS_ArtikelNr + IfThen(VS_EAN <> "", ", EAN: " + VS_EAN, "") + ")"endifDrawText(detailInfo, l1, hoehe + 5, s5 - s1 - 20, 40, ALIGN_RIGHT)endifendifif ( VS_Zeilenart = VS_Positionszeile or VS_Zeilenart = VS_Summenzeile or (DETAIL_ANSICHT and VS_Zeilenart = VS_Detailzeile) )if ( VS_AuswertungsArt = VS_Artikelumsaetze )DrawText(Format(VS_UmsatzP1/100, FORMATBETRAG), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)DrawText(Format(VS_UmsatzP2/100, FORMATBETRAG), l7, hoehe + 5, b7, 40, ALIGN_RIGHT)elseDrawText(Format(VS_AnzahlP1/10000, FORMATANZAHL), l5, hoehe + 5, b5, 40, ALIGN_RIGHT)DrawText(Format(VS_AnzahlP2/10000, FORMATANZAHL), l7, hoehe + 5, b7, 40, ALIGN_RIGHT)endifif ( VS_AuswertungsArt = VS_Artikelumsatzstueck OR VS_AuswertungsArt = VS_Kundenumsaetze )DrawText(Format(VS_UmsatzP1/100, FORMATBETRAG), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)DrawText(Format(VS_UmsatzP2/100, FORMATBETRAG), l8, hoehe + 5, b8, 40, ALIGN_RIGHT)elseDrawText(Format(VS_ProzentP1, FORMATBETRAGLEER), l6, hoehe + 5, b6, 40, ALIGN_RIGHT)DrawText(Format(VS_ProzentP2, FORMATBETRAGLEER), l8, hoehe + 5, b8, 40, ALIGN_RIGHT)endifendifelseif ( VS_Zeilenart = VS_Summenzeile )DrawText(VS_Bezeichnung, l1, hoehe + 5, s7 - s1 - 20, 80)endifif ( VS_Zeilenart = VS_Positionszeile )if ( VS_AuswertungsArt = VS_Kundenumsaetze )DrawText(VS_AdressNr, l1, hoehe + 5, b1, 40, ALIGN_CENTER)if ( VS_DebStatus = 1 )DrawText(numToText(VS_DebKonto), l2, hoehe + 5, b2, 40, ALIGN_CENTER)endifDrawText(VS_Matchcode, l3, hoehe + 5, s7 - s3 - 20, 80)elseif ( VS_AnzeigeArtikelgruppe )DrawText(IfThen(VS_AnzeigeArtikelgruppe, VS_Artikelgruppe, VS_Matchcode), l1, hoehe + 5, s7 - s1 - 20, 40)elseDrawText(VS_ArtikelNr, l1, hoehe + 5, b1, 40, ALIGN_CENTER)DrawText(VS_EAN, l2, hoehe + 5, b2, 40, ALIGN_CENTER)DrawText(VS_Bezeichnung, l4, hoehe + 5, s7 - s4 - 20, 80)DrawText(VS_Matchcode, l3, hoehe + 5, b3, 80)endifendifendifif ( DETAIL_ANSICHT and VS_Zeilenart = VS_Detailzeile )if ( VS_DetailAuswertungsArt = VS_Kundenumsaetze )set detailInfo to VS_Matchcode + " (Adr-Nr.: " + VS_AdressNr + ", " + IfThen(VS_DebStatus = 1, "D-Konto: " + NumToText(VS_DebKonto), "") + ")"DrawText(detailInfo, l1, hoehe + 5, s7 - s1 - 20, 40, ALIGN_RIGHT)elseset detailInfo to VS_Bezeichnungif ( VS_ArtikelNr <> "" )set detailInfo to detailInfo + " (ArtikelNr.: " + VS_ArtikelNr + IfThen(VS_EAN <> "", ", EAN: " + VS_EAN, "") + ")"endifDrawText(detailInfo, l1, hoehe + 5, s7 - s1 - 20, 40, ALIGN_RIGHT)endifendifif ( VS_Zeilenart = VS_Positionszeile or VS_Zeilenart = VS_Summenzeile or (DETAIL_ANSICHT and VS_Zeilenart = VS_Detailzeile) )if ( VS_AuswertungsArt = VS_Artikelumsaetze )DrawText(Format(VS_UmsatzP1/100, FORMATBETRAG), l7, hoehe + 5, b7, 40, ALIGN_RIGHT)elseDrawText(Format(VS_AnzahlP1/10000, FORMATANZAHL), l7, hoehe + 5, b7, 40, ALIGN_RIGHT)endifif ( VS_AuswertungsArt = VS_Artikelumsatzstueck OR VS_AuswertungsArt = VS_Kundenumsaetze )DrawText(Format(VS_UmsatzP1/100, FORMATBETRAG), l8, hoehe + 5, b8, 40, ALIGN_RIGHT)elseDrawText(Format(VS_ProzentP1, FORMATBETRAGLEER), l8, hoehe + 5, b8, 40, ALIGN_RIGHT)endifendifendifset firstPos to FALSE'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)if ( not sumDetailPos )DrawLine(s1, 0, s9, 0)endif#BeginTableFooterSetArea(10)DrawLine(s1, 0, s9, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'VKStatistik'' -----------------------------------------------------------------------------------------0000012