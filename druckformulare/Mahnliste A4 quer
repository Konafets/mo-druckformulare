00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000017Mahnliste A4 quer0000042019000004true000004true00000100000010000000005032' -----------------------------------------------------------------------------------------'' Formular : Mahnliste im Format A4 quer' Historie : 09/09/2008: Initialversion mm' Geändert : 23.05.2013: sts (Spaltenbreite für Datum an langes Datumsformat angepasst)' Geändert : 22.05.2014: Unterdrückung der Datumsausgabe "01.01.1904" bei leerem Datum in der Spalte "Gemahnt" hb' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Mahnliste" + " in " + FILTER_Waehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Variablen definierendim row  as number = 0dim d    as date' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 6 Spaltendim anzahlSpalten as number = 12dim s1 as number = 0dim s2 as number = 100dim s3 as number = 270dim s4 as number = 440dim s5 as number = 705dim s6 as number = 860dim s7 as number = 1165dim s8 as number = 1735dim s9 as number = 1935dim s10 as number = 2070dim s11 as number = 2245dim s12 as number = 2400dim s13 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText("Stand: " + DateToText(d), 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Mahnliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Mahnungen")DrawLine(s1, 0, s13, 0)DrawVerticalLine(s1)DrawText("MS", s1, 5, s2-s1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Fällig", l2, 5, b2, 160, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Gemahnt", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Debitor", l4, 5, b4, 80, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("D-Konto", l5, 5, b5, 80, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Re-Nr.", l6, 5, b6, 40, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Text", l7, 5, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Offen", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("Gebühren", l9, 5, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)DrawText("Zins %", l10, 5, b10, 40, ALIGN_CENTER)DrawVerticalLine(s11)DrawText("Zinsen", l11, 5, b11, 40, ALIGN_CENTER)DrawVerticalLine(s12)DrawText("Gesamt", l12, 5, b12, 40, ALIGN_CENTER)DrawVerticalLine(s13)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawVerticalLine(s1)DrawLine(s1, 0, s13, 0)DrawText(NumToText(MA_Mahnstufe), l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText(DateToText(MA_Faellig), l2, 5, b2, 160, ALIGN_CENTER)DrawVerticalLine(s3)if ( DateToNumber(MA_Gemahnt) > 0 )DrawText(DateToText(MA_Gemahnt), l3, 5, b3, 160, ALIGN_CENTER)endifDrawVerticalLine(s4)DrawText(MA_AdrMatchcode, l4, 5, b4, 160)DrawVerticalLine(s5)DrawText(NumToText(MA_DebiKonto), l5, 5, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText(MA_RechnungsNr, l6, 5, b6, 160)DrawVerticalLine(s7)DrawText(MA_BuText, l7, 5, b7, 160)DrawVerticalLine(s8)DrawText(Format(MA_BetragOffen, FORMATBETRAGNULL), l8, 5, b8, 160, ALIGN_RIGHT)DrawVerticalLine(s9)DrawText(Format(MA_BetragGebuehren, FORMATBETRAGLEER), l9, 5, b9, 160, ALIGN_RIGHT)DrawVerticalLine(s10)DrawText(Format(MA_Zinssatz, FORMATBETRAGLEER), l10, 5, b10, 160, ALIGN_RIGHT)DrawVerticalLine(s11)DrawText(Format(MA_BetragZinsen, FORMATBETRAGLEER), l11, 5, b11, 160, ALIGN_RIGHT)DrawVerticalLine(s12)DrawText(Format(MA_BetragGesamt, FORMATBETRAGNULL), l12, 5, b12, 160, ALIGN_RIGHT)DrawVerticalLine(s13)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s13, 0)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s13, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Mahnliste'' -----------------------------------------------------------------------------------------0000012