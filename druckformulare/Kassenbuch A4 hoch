00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000018Kassenbuch A4 hoch0000042008000004true000004true00000100000010000081Kassenbuch im Format A4 hoch (nicht für Filteroption 'Alle Gegenkonten' geeignet)005521' -----------------------------------------------------------------------------------------'' Formular : Kassenbuch im Format A4 hoch' Historie : 19/07/2007: Initialversion mm' Geändert : 14.11.2013: sts (Spaltenbreite für Steuersatz angepasst)'            04.07.2016: sts (Ausgabe Datum mit Jahr)'            21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'            18.06.2018: sts (Ausgabe "0,00" bei Null-Saldo)'' -----------------------------------------------------------------------------------------#BeginDocument' Abbrechen, falls Auswertung Gegenkonten liefertif ( KB_AlleGegenkonten )beepmsgBox("Dieses Druckformular ist nur bei nicht gesetzter Filteroption 'Alle Gegenkonten' geeignet!")exitendif' Globale Konstanten definierenconst DOCTITEL as text = "Kassenbuch in " + App_GJWaehrung' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 8 Spaltendim anzahlSpalten as number = 8dim s1 as number = 0dim s2 as number = 170dim s3 as number = 340dim s4 as number = 770dim s5 as number = 910dim s6 as number = 1090dim s7 as number = 1270dim s8 as number = 1550dim s9 as number = LAYOUTWIDTH' Variablen definierendim row        as number = 0dim summeEin   as number = 0dim summeAus   as number = 0dim summeSaldo as number = 0#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KB_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kassenbuch'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Kassenbuch")DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText("Datum", s1, 5, s2-s1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Beleg", l2, 5, b2, 160, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Buchungstext", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("Gegen- konto", l4, 5, b4, 80, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Einnahme", l5, 5, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("Ausgabe", l6, 5, b6, 40, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Steuer", s7, 5, b7+20, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Saldo", l8, 5, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif( (KB_Uebertragszeile = KB_Zeilenart) OR (KB_Summenzeile = KB_Zeilenart) )SetTextBold(TRUE)endifif( KB_Journalzeile = KB_Zeilenart )SetTextBold(FALSE)endifDrawVerticalLine(s1)DrawLine(s1, 0, s9, 0)if( KB_Journalzeile = KB_Zeilenart )DrawText(ShortDate(KB_Datum), l1, 5, b1, 40, ALIGN_CENTER)DrawText(Format(KB_Gegenkonto, FORMATKONTO), l4, 5, b4, 40, ALIGN_RIGHT)endifDrawVerticalLine(s2)DrawText(KB_BelegNr, l2, 5, b2, 80)DrawVerticalLine(s3)DrawText(KB_Text, l3, 5, b3, 300)DrawVerticalLine(s4)DrawVerticalLine(s5)DrawText(Format(KB_Einnahme, IfThen(KB_Zeilenart = KB_Summenzeile, FORMATBETRAGNULL, FORMATBETRAGLEER)), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(KB_Ausgabe, IfThen(KB_Zeilenart = KB_Summenzeile, FORMATBETRAGNULL, FORMATBETRAGLEER)), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawText(KB_BuSteuersatz, s7, 5, b7+20, 160, ALIGN_CENTER)DrawVerticalLine(s8)DrawText(Format(KB_Saldo, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)set summeEin to summeEin + KB_Einnahmeset summeAus to summeAus + KB_Ausgabeset summeSaldo to KB_Saldo'-------------------------------------------------------BeginTableBreak---#BeginTableBreak#include "STYLE Arial 8, fett"SetArea(42)DrawLine(s1, 0, s9, 0)DrawLine(s1, 0, s1, 40)DrawLine(s2, 0, s2, 40)DrawLine(s3, 0, s3, 40)DrawLine(s4, 0, s4, 40)DrawLine(s5, 0, s5, 40)DrawText("Zwischensumme:", l3, 5, b3, 40, ALIGN_LEFT)DrawLine(s6, 0, s6, 40)DrawText(Format(summeEin, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawText(Format(summeAus, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawLine(s8, 0, s8, 40)DrawText(Format(summeSaldo, FORMATBETRAGNULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawLine(s9, 0, s9, 40)DrawLine(s1, 40, s9, 40)'-------------------------------------------------------BeginTableFooter---#BeginTableFooterSetArea(10)DrawLine(s1, 0, s9, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Kassenbuch'' -----------------------------------------------------------------------------------------0000011