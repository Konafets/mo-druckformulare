00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000034Abschreibungsliste A4 quer einzeln0000042011000004true000004true00000100000010000018Abschreibungsliste010469' -----------------------------------------------------------------------------------------'' Formular : Abschreibungsliste im Format A4 quer einzeln' Historie : 14/05/2018: Initialversion sts' Geändert :'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Abschreibungsliste in " + App_GJWaehrung' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer AL"' allgemeine Variablendim newHeight as number = 0dim newHeight2 as number = 0dim sumAKH as number = 0dim sumBwA as number = 0dim sumZu as number = 0dim sumAb as number = 0dim sumZuS as number = 0dim sumAJ as number = 0dim sumSA as number = 0dim sumAK as number = 0dim sumBwE as number = 0dim breite as numberdim hoehe as numberdim gruppeName as text' Variablen für die Positionen der 14 Spaltendim anzahlSpalten as number = 14dim s1 as number = 0dim s2 as number = 450dim s3 as number = 630dim s4 as number = 800dim s5 as number = 950dim s6 as number = 1080dim s7 as number = 1180dim s8 as number = 1360dim s9 as number = 1550dim s10 as number = 1720dim s11 as number = 1920dim s12 as number = 2080dim s13 as number = 2280dim s14 as number = 2440dim s15 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(ANL_Filter, 0, 150, LAYOUTWIDTH, 50)' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Abschreibungsliste'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(85)#include "STYLE Arial 7, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Abschreibungsliste")DrawLine(s1, 0, s15, 0)DrawVerticalLine(s1)DrawText("Bezeichnung", l1, 25, b1, 85, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Inv.-Nr.", l2, 25, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Hist. AHK", l3, 25, b3, 85, ALIGN_CENTER)DrawVerticalLine(s4)DrawText("AfA-Beginn", l4, 25, b4, 85, ALIGN_CENTER)DrawVerticalLine(s5)DrawText("Art", l5, 25, b5, 40, ALIGN_CENTER)DrawVerticalLine(s6)DrawText("ND (Mon)", l6, 25, b6, 85, ALIGN_CENTER)DrawVerticalLine(s7)DrawText("Buchw. Anfang", l7, 25, b7, 85, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Zugang", l8, 25, b8, 40, ALIGN_CENTER)DrawVerticalLine(s9)DrawText("Abgang", l9, 25, b9, 40, ALIGN_CENTER)DrawVerticalLine(s10)DrawText("Zuschreibung", l10, 25, b10, 40, ALIGN_CENTER)DrawVerticalLine(s11)DrawText("Afa Jahr", l11, 25, b11, 40, ALIGN_CENTER)DrawVerticalLine(s12)DrawText("Sonder-Afa", l12, 25, b12, 40, ALIGN_CENTER)DrawVerticalLine(s13)DrawText("Afa kum.", l13, 25, b13, 40, ALIGN_CENTER)DrawVerticalLine(s14)DrawText("Buchw. Ende", l14, 25, b14, 40, ALIGN_CENTER)DrawVerticalLine(s15)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 7, normal"set hoehe to 0if (AL_EbeneNr=1)set breite to s3-s1-20set hoehe to 40SetTextBold(TRUE)DrawLine(s1, 0, s15, 0)set gruppeName to AL_Bezeichnungset sumAKH to AL_AHKHistorischset sumZu to AL_Zugangset sumBwA to AL_BuchwertAnfangset sumAb to AL_Abgangset sumZuS to AL_Zuschreibungset sumAJ to AL_AfaJahrset sumSA to AL_SonderAfaset sumAK to AL_AfaKumset sumBwE to AL_BuchwertEndeelseif (AL_EbeneNr=2)set breite to s3-s1-20SetTextBold(TRUE)DrawLine(s1, hoehe, s15, hoehe)elseif (AL_EbeneNr=3)set breite to b1SetTextBold(FALSE)DrawLine(s1, hoehe, s15, hoehe)elseif (AL_EbeneNr=4)set sumAKH to AL_AHKHistorischset sumZu to AL_Zugangset sumBwA to AL_BuchwertAnfangset sumAb to AL_Abgangset sumZuS to AL_Zuschreibungset sumAJ to AL_AfaJahrset sumSA to AL_SonderAfaset sumAK to AL_AfaKumset sumBwE to AL_BuchwertEndeendifif (AL_EbeneNr=1 or AL_EbeneNr=2)DrawText(AL_Bezeichnung, l1, hoehe + 5, breite, 300, ALIGN_LEFT)elseDrawText(AL_Bezeichnung, l1 + 50, hoehe + 5, breite - 50, 300, ALIGN_LEFT)DrawText(AL_InventarNr, l2, hoehe + 5, b2, 300, ALIGN_RIGHT)DrawText(IfThen(AL_AfaBeginn <> TextToDate("01.01.1904"), DateToText(AL_AfaBeginn), ""), l4, hoehe + 5, b4, 40, ALIGN_CENTER)if(AL_AfaMethode = ANL_AFAART_KEINE)DrawText("", l5, hoehe + 5, b5, 40, ALIGN_CENTER)elseif(AL_AfaMethode = ANL_AFAART_LINEAR)DrawText("LIN", l5, hoehe + 5, b5, 40, ALIGN_CENTER)elseif(AL_AfaMethode = ANL_AFAART_DEGRESSIV)if (AL_AfaWechsel)DrawText("D/L", l5, hoehe + 5, b5, 40, ALIGN_CENTER)elseDrawText("DEG", l5, hoehe + 5, b5, 40, ALIGN_CENTER)endifelseif(AL_AfaMethode = ANL_AFAART_GWG)DrawText("GWG", l5, hoehe + 5, b5, 40, ALIGN_CENTER)elseif(AL_AfaMethode = ANL_AFAART_GWG_SP)DrawText("GWG-SP", l5, hoehe + 5, b5, 40, ALIGN_CENTER)elseDrawText("#WERT!", l5, hoehe + 5, b5, 40, ALIGN_CENTER)endifif (AL_EbeneNr=3)DrawText(Format(AL_Nutzungsdauer, "0"), l6, hoehe + 5, b6, 300, ALIGN_RIGHT)endifendifif (AL_EbeneNr=2 or AL_EbeneNr=3)DrawText(Format(AL_AHKHistorisch, FORMATBETRAGLEER), l3, hoehe + 5, b3, 160, ALIGN_RIGHT)DrawText(Format(AL_BuchwertAnfang, FORMATBETRAGLEER), l7, hoehe + 5, b7, 40, ALIGN_RIGHT)DrawText(Format(AL_Zugang, FORMATBETRAGLEER), l8, hoehe + 5, b8, 40, ALIGN_RIGHT)DrawText(Format(AL_Abgang, FORMATBETRAGLEER), l9, hoehe + 5, b9, 40, ALIGN_RIGHT)DrawText(Format(AL_Zuschreibung, FORMATBETRAGLEER), l10, hoehe + 5, b10, 40, ALIGN_RIGHT)DrawText(Format(AL_AfaJahr, FORMATBETRAGLEER), l11, hoehe + 5, b11, 40, ALIGN_RIGHT)DrawText(Format(AL_SonderAfa, FORMATBETRAGLEER), l12, hoehe + 5, b12, 40, ALIGN_RIGHT)DrawText(Format(AL_AfaKum, FORMATBETRAGLEER), l13, hoehe + 5, b13, 40, ALIGN_RIGHT)DrawText(Format(AL_BuchwertEnde, FORMATBETRAGLEER), l14, hoehe + 5, b14, 40, ALIGN_RIGHT)DrawLine(s1, hoehe, s1, AREA_CURRENTHEIGHT)DrawLine(s3, hoehe, s3, AREA_CURRENTHEIGHT)DrawLine(s4, hoehe, s4, AREA_CURRENTHEIGHT)DrawLine(s5, hoehe, s5, AREA_CURRENTHEIGHT)DrawLine(s6, hoehe, s6, AREA_CURRENTHEIGHT)DrawLine(s7, hoehe, s7, AREA_CURRENTHEIGHT)DrawLine(s8, hoehe, s8, AREA_CURRENTHEIGHT)DrawLine(s9, hoehe, s9, AREA_CURRENTHEIGHT)DrawLine(s10, hoehe, s10, AREA_CURRENTHEIGHT)DrawLine(s11, hoehe, s11, AREA_CURRENTHEIGHT)DrawLine(s12, hoehe, s12, AREA_CURRENTHEIGHT)DrawLine(s13, hoehe, s13, AREA_CURRENTHEIGHT)DrawLine(s14, hoehe, s14, AREA_CURRENTHEIGHT)DrawLine(s15, hoehe, s15, AREA_CURRENTHEIGHT)if (AL_EbeneNr=3)DrawLine(s2, hoehe, s2, AREA_CURRENTHEIGHT)DrawLine(s3, hoehe, s3, AREA_CURRENTHEIGHT)DrawLine(s4, hoehe, s4, AREA_CURRENTHEIGHT)DrawLine(s5, hoehe, s5, AREA_CURRENTHEIGHT)endifendifif ( AL_FolgendeEbeneNr = ANL_GRUPPEN_EBENE or AL_FolgendeEbeneNr = ANL_SUMMEN_EBENE )SetTextBold(true)set hoehe to AREA_CURRENTHEIGHTDrawLine(s1, hoehe, s15, hoehe)DrawText("Summe Gruppe " + gruppeName + ":", l1, hoehe+5, s3-s1-20, 40, ALIGN_LEFT)DrawText(Format(sumAKH, FORMATBETRAGLEER), l3, hoehe+5, b3, 40, ALIGN_RIGHT)DrawText(Format(sumBwA, FORMATBETRAGNULL), l7, hoehe+5, b7, 40, ALIGN_RIGHT)DrawText(Format(sumZu, FORMATBETRAGLEER), l8, hoehe+5, b8, 40, ALIGN_RIGHT)DrawText(Format(sumAb, FORMATBETRAGLEER), l9, hoehe+5, b9, 40, ALIGN_RIGHT)DrawText(Format(sumZuS, FORMATBETRAGLEER), l10, hoehe+5, b10, 40, ALIGN_RIGHT)DrawText(Format(sumAJ, FORMATBETRAGLEER), l11, hoehe+5, b11, 40, ALIGN_RIGHT)DrawText(Format(sumSA, FORMATBETRAGLEER), l12, hoehe+5, b12, 40, ALIGN_RIGHT)DrawText(Format(sumAK, FORMATBETRAGLEER), l13, hoehe+5, b13, 40, ALIGN_RIGHT)DrawText(Format(sumBwE, FORMATBETRAGLEER), l14, hoehe+5, b14, 40, ALIGN_RIGHT)DrawLine(s1, hoehe, s1, AREA_CURRENTHEIGHT)DrawLine(s3, hoehe, s3, AREA_CURRENTHEIGHT)DrawLine(s4, hoehe, s4, AREA_CURRENTHEIGHT)DrawLine(s5, hoehe, s5, AREA_CURRENTHEIGHT)DrawLine(s6, hoehe, s6, AREA_CURRENTHEIGHT)DrawLine(s7, hoehe, s7, AREA_CURRENTHEIGHT)DrawLine(s8, hoehe, s8, AREA_CURRENTHEIGHT)DrawLine(s9, hoehe, s9, AREA_CURRENTHEIGHT)DrawLine(s10, hoehe, s10, AREA_CURRENTHEIGHT)DrawLine(s11, hoehe, s11, AREA_CURRENTHEIGHT)DrawLine(s12, hoehe, s12, AREA_CURRENTHEIGHT)DrawLine(s13, hoehe, s13, AREA_CURRENTHEIGHT)DrawLine(s14, hoehe, s14, AREA_CURRENTHEIGHT)DrawLine(s15, hoehe, s15, AREA_CURRENTHEIGHT)pagebreak(AL_FolgendeEbeneNr = ANL_GRUPPEN_EBENE)endif'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(10)DrawLine(s1, 0, s15, 0)#BeginTableFooterSetArea(80, AREA_AUTOSIZE)#include "STYLE Arial 7, normal"set newHeight to 45DrawLine(s1, 0, s15, 0)DrawLine(s1, newHeight, s15, newHeight)SetTextBold(true)DrawText("Gesamtsumme:", l1, newHeight+5, b1, 40, ALIGN_LEFT)DrawText(Format(sumAKH, FORMATBETRAGLEER), l3, newHeight+5, b3, 40, ALIGN_RIGHT)DrawText(Format(sumBwA, FORMATBETRAGNULL), l7, newHeight+5, b7, 40, ALIGN_RIGHT)DrawText(Format(sumZu, FORMATBETRAGLEER), l8, newHeight+5, b8, 40, ALIGN_RIGHT)DrawText(Format(sumAb, FORMATBETRAGLEER), l9, newHeight+5, b9, 40, ALIGN_RIGHT)DrawText(Format(sumZuS, FORMATBETRAGLEER), l10, newHeight+5, b10, 40, ALIGN_RIGHT)DrawText(Format(sumAJ, FORMATBETRAGLEER), l11, newHeight+5, b11, 40, ALIGN_RIGHT)DrawText(Format(sumSA, FORMATBETRAGLEER), l12, newHeight+5, b12, 40, ALIGN_RIGHT)DrawText(Format(sumAK, FORMATBETRAGLEER), l13, newHeight+5, b13, 40, ALIGN_RIGHT)DrawText(Format(sumBwE, FORMATBETRAGLEER), l14, newHeight+5, b14, 40, ALIGN_RIGHT)set newHeight2 to AREA_CURRENTHEIGHT + 5DrawLine(s1, newHeight2, s15, newHeight2)DrawLine(s1, newHeight, s1, newHeight2)DrawLine(s3, newHeight, s3, newHeight2)DrawLine(s4, newHeight, s4, newHeight2)DrawLine(s5, newHeight, s5, newHeight2)DrawLine(s6, newHeight, s6, newHeight2)DrawLine(s7, newHeight, s7, newHeight2)DrawLine(s8, newHeight, s8, newHeight2)DrawLine(s9, newHeight, s9, newHeight2)DrawLine(s10, newHeight, s10, newHeight2)DrawLine(s11, newHeight, s11, newHeight2)DrawLine(s12, newHeight, s12, newHeight2)DrawLine(s13, newHeight, s13, newHeight2)DrawLine(s14, newHeight, s14, newHeight2)DrawLine(s15, newHeight, s15, newHeight2)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Abschreibungsliste'' -----------------------------------------------------------------------------------------'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"0000012