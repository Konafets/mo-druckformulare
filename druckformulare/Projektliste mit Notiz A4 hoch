00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000030Projektliste mit Notiz A4 hoch0000041022000004true000004true00000100000010000048Liste der Projekte im Format A4 hoch mit Notizen003404'-----------------------------------------------------------------------------------------'' Formular : Liste der Projekte im Format A4 hoch mit Notizen' Historie : 27/10/2016: sts Initialversion''-----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Liste der Projekte "' Allgemeine Konstantenconst WHITE as color           = RGBColor(255,255,255)const MAX_POS_HEIGHT as number = 2000' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 5 Spaltendim anzahlSpalten as number = 5dim s1 as number = 0dim s2 as number = 200dim s3 as number = 900dim s4 as number = 910dim s5 as number = 1110dim s6 as number = LAYOUTWIDTH' Globale Variablen definierendim zab           as numberdim hoehe         as numberdim posContentTop as number#include "TEMPLATE Table"'-----------------------------------------------------------------------------------------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(PROJEKT_Filter, 0, 150, LAYOUTWIDTH, 100)'-----------------------------------------------------------------------------------------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'Projektliste''-----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(10)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Projektliste")'-----------------------------------------------------------------------------------------#BeginTableRowSetArea(MAX_POS_HEIGHT, AREA_AUTOSIZE)SetAreaMin(80)#include "STYLE Arial 8, normal"set hoehe to 10set zab to 40SetTextBold(TRUE)DrawText("Projekt: " + PROJEKT_Bezeichnung + ", Nr. " + PROJEKT_Nummer, l1, hoehe, s3 - s1 - 20, 40)SetTextBold(FALSE)set hoehe to hoehe + zabset posContentTop to hoeheDrawLine(s1, hoehe, s6, hoehe)set hoehe to hoehe + 10DrawText("Startdatum:", l1, hoehe, b1, 40)DrawText(IfThen(GetPlatform = 1, MediumDate(PROJEKT_DatumStart), ShortDate(PROJEKT_DatumStart)), l2, hoehe, b2, 40)set hoehe to hoehe + zabDrawText("Enddatum:", l1, hoehe, b1, 40)if ( DateToNumber(PROJEKT_DatumEnde) > 0 )DrawText(IfThen(GetPlatform = 1, MediumDate(PROJEKT_DatumEnde), ShortDate(PROJEKT_DatumEnde)), l2, hoehe, b2, 40)endifset hoehe to posContentTop + 10DrawText("Status:", l4, hoehe, b4, 40)DrawText(PROJEKT_Status, l5, hoehe, b5, 40)set hoehe to hoehe + zabDrawText("Bearbeiter:", l4, hoehe, b4, 40)DrawText(PROJEKT_Bearbeiter, l5, hoehe, b5, 40)set hoehe to hoehe + zabset hoehe to AREA_CURRENTHEIGHT + 15DrawText("Notizen:", l1, hoehe, b1, 40)DrawText(PROJEKT_Notizen, l2, hoehe, s6 - s2 - 20, 40)SetLineColor(WHITE)DrawLine(s1, AREA_CURRENTHEIGHT + 40, s1, AREA_CURRENTHEIGHT + 40)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(1)#include "STYLE Arial 8, normal"#BeginTableFooterSetArea(1)#include "STYLE Arial 8, normal"' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Projektliste'' -----------------------------------------------------------------------------------------0000011