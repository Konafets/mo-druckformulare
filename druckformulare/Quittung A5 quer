00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000016Quittung A5 quer0000041001000004true000004true00000100000010000048Kann auch auf A4 gedruckt und abgetrennt werden.004751' -----------------------------------------------------------------------------------------'' Formular : Quittung A5 quer (Format A4 hoch)' Historie : 04.09.2007: Initialversion mm' Geändert : 11.05.2011: hb Zeilenehöhe für Ort / Datum geändert, Firmenort hinzugefügt' Geändert : 2013/27/08: sts (Breite und Position für Quittungstext)'' -----------------------------------------------------------------------------------------#BeginDocument' -----------------------------------------------------------------------------------------' SeitenränderSetDocument(200, 150, 100, 100, 8)' Konstantenconst DOCTITEL as text = ""const BLACK as color = RGBColor(0, 0, 0)const LAYOUTWIDTH as number = 1750const FORMATBETRAGNULL as text = "-###,###,##0.00"const FORMATBETRAGLEER as text = "###,###,##0.00;-###,###,##0.00;"const FORMATBETRAGGANZ as text = "###,###,##0;-###,###,##0;"const FORMATKONTO as text = "0000;-0000;\<\d\i\v\>"const FORMATKONTOLEER as text = "0000;-0000;"const FORMATKURSNULL as text = "-###,###,##0.000000"const FORMATKURSLEER as text = "###,###,##0.000000;-###,###,##0.000000;"' Variablendim firma as text = Firma_Nameset firma to IfThen(Firma_Strasse <> "", firma + ", " + Firma_Strasse, firma)set firma to IfThen(Firma_Plz <> "", firma + ", " + Firma_Plz, firma)set firma to IfThen(Firma_Ort <> "", IfThen(Firma_Plz <> "", firma + " " + Firma_Ort, firma + ", " + Firma_Ort), firma)dim steuerNr as text = "StNr: " + IfThen(Firma_FASteuernummer <> "", Firma_FASteuernummer, "<Nicht vorhanden>")dim headLine as text = DOCTITELdim creator as text = App_Name + ", Version " + NumToText(App_MajorVersion) + "." + NumToText(App_MinorVersion) + "." + NumToText(App_BugVersion)dim vendor as text = App_CopyRight + ", " + App_Homepage'-----------------------------------------------------------------------------------------dim bg1 as Color = RGBColor(220, 220, 220)dim l as numberdim laenge as numberdim pos as number'-----------------------------------------------------------------------------------------#BeginHeader'-----------------------------------------------------------------------------------------'-----------------------------------------------------------------------------------------#BeginGraphicsText'-----------------------------------------------------------------------------------------SetArea(970)#include "STYLE Arial 8, normal"SetFillColor(bg1)FillRect(700, 0, 1100, 245)FillRect(0, 240, 1800, 120)DrawRect(0, 0, 1800, 960)DrawLine(0, 120, 1800, 120)DrawLine(0, 240, 1800, 240)DrawLine(0, 360, 1800, 360)DrawLine(0, 480, 1800, 480)DrawLine(0, 600, 1800, 600)DrawLine(0, 720, 1800, 720)DrawLine(0, 840, 1800, 840)DrawLine(700, 0, 700, 240)DrawLine(1600, 240, 1600, 360)'------------------fett------------------SetTextBold(true)SetTextSize(18)DrawText("Quittung", 20, 25, 630, 100)SetTextSize(12)DrawText(Q_Summe, 900, 35, 860, 50, ALIGN_RIGHT)DrawText(Q_BelegNr, 100, 155, 550, 50)DrawText(Q_Steuersatz, 820, 155, 350, 50)DrawText(Q_Steuer, 1360, 155, 400, 50, ALIGN_RIGHT)set laenge to Length(Q_SummeWorte)set l to 50if (laenge <= l)DrawText(Q_SummeWorte, 400, 275, 1200, 50)else'Leerzeichen findenset pos to Position(Q_SummeWorte, " ", 1, 1)'wenn Leerzeichenposition kleiner als 50 dort trennenset pos to Case(pos > l, l, pos <= l, pos, l)DrawText(Left(Q_SummeWorte, pos), 400, 250, 1200, 50)DrawText(Middle(Q_SummeWorte, pos+1, l), 400, 300, 1200, 50)endifDrawText(Q_Text, 400, 395, 1380, 50)set laenge to Length(Q_Bemerkung)set l to 70if (laenge <= l)DrawText(Q_Bemerkung, 400, 515, 1380, 50)else'Leerzeichen findenset pos to Position(Q_Bemerkung, " ", l-15, 1)'wenn Leerzeichenposition kleiner als 50 dort trennenset pos to Case(pos > l, l, pos <= l, pos, l)DrawText(Left(Q_Bemerkung, pos), 400, 515, 1380, 50)DrawText(Middle(Q_Bemerkung, pos+1, l), 400, 635, 1000, 50)endifDrawText(Firma_Ort + ", " + DateToText(Q_Datum), 400, 755, 800, 50)'------------nicht fett------------------SetTextBold(false)SetTextSize(8)DrawText("Betrag", 720, 45, 150, 40)DrawText("Nr", 20, 160, 50, 40)DrawText("inkl.", 720, 160, 100, 40)DrawText("MwSt. Betrag", 1170, 160, 190, 40)DrawText("Betrag in Worten", 20, 280, 350, 40)DrawText("Cent wie oben", 1620, 260, 160, 80)DrawText("Quittungstext", 20, 400, 350, 40)DrawText("für", 20, 520, 200, 40)DrawText("dankend erhalten.", 1420, 640, 360, 40, ALIGN_RIGHT)DrawText("Ort / Datum", 20, 760, 350, 40)DrawText("Stempel und Unterschrift des Empfängers", 20, 880, 700, 40)'-----------------------------------------------------------------------------------------#BeginFooter'-----------------------------------------------------------------------------------------0000011