00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000033Vordruck Lastschrift Sigel ZV 5400000041013000004true000004true00000110000010000059Formular zum Ausdruck auf Vordruck Lastschrift Sigel ZV 540006745'-----------------------------------------------------------------------------------------'' Formular : Vordruck Lastschrift Sigel ZV 540'' Unterstütze Vordrucke : Lastschrift Sigel Nr.: ZV 540'' Historie' 14/01/2010: Initialversion' 14/05/2012: sts (Spaltenbreite überarbeite)' 31/01/2014: mm' 27/02/2014: sts (Ausgabe Verwendungszeck in Quittung auf 27 Stellen je Zeile begrenzt)''-----------------------------------------------------------------------------------------#BeginDocument'-----------------------------------------------------------------------------------------SetDocument(0, 250, 0, 150)                                'Seitenränder definieren'-----------------------------------------------------------------------------------------' Konstanten für die korrekte Positionierung bei der Druckausgabe, Angaben in Zehntelmillimeternconst X as number = 0      ' horizontale Verschiebungconst Y as number = 0      ' vertikale Verschiebung' Ausgabe zu hoch        Erhöhen Sie den Y-Wert um 20, wenn es 2 mm zu hoch ist' Ausgabe zu tief        Vermindern Sie den Y-Wert um 20, wenn es 2 mm zu tief ist (darf auch negativ sein z.B. -20)' Ausgabe zu weit links  Erhöhen Sie den X-Wert um 20, wenn es 2 mm zu weit links ist' Ausgabe zu weit rechts Vermindern Sie den X-Wert um 20, wenn es 2 mm zu weit rechts ist (darf auch negativ sein z.B. -20)'-----------------------------------------------------------------------------------------' Konstanten definieren' Allgemeine Konstantenconst HEADER1_HEIGHT   as number = 570const BANKBELEG        as number = 1970const LAYOUTLEFT       as number = 90const LAYOUTWIDTH      as number = 1780const BLACK            as color  = RGBColor(0,0,0)const FORMATBETRAGLEER as text   = "#0.00"const FORMATREFNR      as text   = "#0000000000;"const MSPACE           as number = 50                      ' Laufweitenangabe für Monospace' Belegarten' UEBERWEISUNG     as number = 1' LASTSCHRIFT      as number = 2' Variablen definierendim hoehe              as numberdim starthoehe         as numberdim breite             as numberdim verwzweck1         as textdim verwzweck2         as textdim zh7                as numberdim zh9                as numberdim lf                 as numberdim kontoinhaber       as textdim beguenstigter      as text' Startwerte (X-Positionen) der Spalten in den Belegendim anzahlSpalten as number = 7dim s1 as number = LAYOUTLEFT + Xdim s2 as number = LAYOUTLEFT + X + 550dim s3 as number = LAYOUTLEFT + X + 630dim s4 as number = LAYOUTLEFT + X + 750dim s5 as number = LAYOUTLEFT + X + 950dim s6 as number = LAYOUTLEFT + X + 1340dim s7 as number = LAYOUTLEFT + X + 1460dim s8 as number = LAYOUTLEFT + X + LAYOUTWIDTH' Hier werden die Variablen für die Spaltenbreiten und Innenabstände der Positionstabelle initialisiert#include "TEMPLATE Table"' -----------------------------------------------------------------------------------------' Prüfung Belegart' -----------------------------------------------------------------------------------------if (ZA_TransferArt <> 2)beepmsgBox("Der ausgewählte Zahlungsauftrag ist keine Lastschrift, die Verarbeitung wird abgebrochen.")exitendif' -----------------------------------------------------------------------------------------' Beginn Kopfbereich (Platzhalter für nachfolgende Bereiche)' -----------------------------------------------------------------------------------------#BeginHeaderSetArea(HEADER1_HEIGHT)' Dummy-Zeichenbefehl (unsichtbar): Ohne Ausgabe wird die Bereichshöhe nicht gesetztDrawLine(0, 0, 0, 0)' -----------------------------------------------------------------------------------------' Beginn Briefpapier (Hintergrund) nur für Testzwecke' -----------------------------------------------------------------------------------------#BeginBackground'DrawPicture("Lastschrift.tif", 0, -250)' -----------------------------------------------------------------------------------------' Beginn Bankbeleg und Kundenbeleg' -----------------------------------------------------------------------------------------#BeginGraphicsTextSetArea(BANKBELEG)#include "STYLE Arial 9, normal"set starthoehe to 110 + Yset hoehe to starthoeheset ZH7 to 30                                                             ' Zeilenhöhe für Quittungset ZH9 to 40                                                             ' Zeilenhöhe für Belegeset lf to 85                                                              ' Zeilenabstand Belegeset verwzweck1 to Left(ZA_Verwendungszweck1, 27)set verwzweck2 to Middle(ZA_Verwendungszweck1, 28, 27)dim i as number = 0doexitloop (i = 2)set hoehe to hoehe + 130DrawTextMonospace(ZA_FremdkontoInhaber, s1, hoehe, s6 - s1, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(ZA_FremdkontoNummer, s1, hoehe, b1, zh9, MSPACE)DrawTextMonospace(ZA_FremdkontoBlz, s5, hoehe, b5, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(ZA_FremdkontoBank, s1, hoehe, s6 - s1, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(Format(ZA_BetragZahlungFW,FORMATBETRAGLEER), s4, hoehe, s6 - s4, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(verwzweck1, s1, hoehe, s6 - s1 + 50, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(verwzweck2, s1, hoehe, s6 - s1 + 50, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(ZA_EigenkontoInhaber, s1, hoehe, s6 - s1 + 50, zh9, MSPACE)set hoehe to hoehe + lfDrawTextMonospace(ZA_EigenkontoNummer, s1, hoehe, b1, zh9, MSPACE)set hoehe to starthoehe + 1060set i to i + 1loop' -----------------------------------------------------------------------------------------' Beginn Quittung' -----------------------------------------------------------------------------------------set hoehe to starthoehe + 15set kontoinhaber to ZA_EigenkontoInhaber + ", " + ZA_EigenkontoBank + ", BLZ: " + ZA_EigenkontoBlzset beguenstigter to ZA_FremdkontoInhaber + ", " + ZA_FremdkontoBank + ", BLZ: " + ZA_FremdkontoBlz + ", Kto.: " + ZA_FremdkontoNummerSetTextSize(10)SetTextBold(TRUE)DrawText(ZA_EigenkontoNummer, s7, hoehe, b7, 45, ALIGN_CENTER)SetTextBold(FALSE)SetTextSize(7)set hoehe to hoehe + 125DrawText(kontoinhaber, s7, hoehe, b7, 130)set hoehe to hoehe + 150DrawText(beguenstigter, s7, hoehe, b7, 130)set hoehe to hoehe + 185DrawText(Left(ZA_Verwendungszweck1, 54), s7, hoehe, b7 + 150, 130)set hoehe to hoehe + 185DrawText(IfThen(GetPlatform = 1, MediumDate(ZA_DatumGeplant), ShortDate(ZA_DatumGeplant)), s7, hoehe, b7, zh7)set hoehe to hoehe + 75DrawText(Format(ZA_BetragZahlungFW,FORMATBETRAGLEER), s7, hoehe + 10, b7, zh7)set hoehe to hoehe + 75DrawText(Format(ZA_ReferenzNr, FORMATREFNR), s7, hoehe, b7, zh7)0000011