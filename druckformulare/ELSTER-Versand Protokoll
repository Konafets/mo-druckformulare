00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000024ELSTER-Versand Protokoll0000042028000004true000004true00000100000010000059Zusammenfassung der Bericht-, Sende- und Empfangsprotokolle004194' -----------------------------------------------------------------------------------------'' Formular : Steuerprotokoll im Format A4 hoch' Historie : 19.02.2008: Initialversion mm' Geändert : 19.01.2015: ELSTER-Versand Protokoll' Geändert : 26.03.2015: #Pagebreak as mm'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "Protokoll ELSTER-Versand"' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"dim bereich as number = 0dim typ as text' Variablen für die Positionen der 3 Spaltendim anzahlSpalten as number = 3dim s1 as number = 0dim s2 as number = 250dim s3 as number = 500dim s4 as number = LAYOUTWIDTH#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Protokoll-Uebersicht'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetCurrentTable("Protokoll-Uebersicht")SetArea(60)#include "STYLE Arial 8, fett"DrawText("Übersicht", 0, 0, 500, 40)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if(typ = "" and PU_Eigenschaft="Typ")set typ to PU_WertendifDrawText(PU_Eigenschaft, s1, 0, b1, 40)if(PU_Eigenschaft="Typ" OR PU_Eigenschaft="Erstellt am")SetTextBold(true)elseSetTextBold(false)endifDrawText(PU_Wert, s2, 1, s4-s2, 40)#BeginTableBreak#BeginTableFooter#BeginGraphicsTextif (HasTable("Protokoll-Gesendet"))PageBreak(true)endif' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Protokoll-Uebersicht'' -----------------------------------------------------------------------------------------' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Protokoll-Gesendet' (XML-Daten)' -----------------------------------------------------------------------------------------#BeginTableHeaderExitTable(not HasTable("Protokoll-Gesendet"))SetCurrentTable("Protokoll-Gesendet")SetArea(60)#include "STYLE Arial 8, fett"DrawText(IfThen(typ = "Zusammenfassende Meldung" OR Firma_FALand = "Östereich" , "Xml_Datei", "Sendeprotokoll"), 0, 0, 500, 40)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"DrawText(PG_Text, s1, 1, s4-s1, 300)#BeginTableBreak#BeginTableFooter#BeginGraphicsTextif (HasTable("Protokoll-Empfangen"))PageBreak(true)endif' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Protokoll-Gesendet'' -----------------------------------------------------------------------------------------' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Protokoll-Empfangen' (Ergebnis)' -----------------------------------------------------------------------------------------#BeginTableHeaderExitTable(not HasTable("Protokoll-Empfangen"))SetCurrentTable("Protokoll-Empfangen")SetArea(60)#include "STYLE Arial 8, fett"DrawText(IfThen(typ = "Zusammenfassende Meldung" OR Firma_FALand = "Östereich" , "Ergebnis", "Empfangsprotokoll"), 0, 0, 500, 40)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"DrawText(PE_Text, s1, 1, s4-s1, 300)#BeginTableBreak#BeginTableFooter' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Protokoll-Empfangen'' -----------------------------------------------------------------------------------------0000011