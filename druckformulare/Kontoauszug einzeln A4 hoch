00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000027Kontoauszug einzeln A4 hoch0000042001000004true000004true00000100000010000030Einzelkonten im Format A4 hoch006898' -----------------------------------------------------------------------------------------'' Formular : Kontoauszug im Format A4 hoch' Historie : 14/08/2007: Initialversion vs' Geändert : 26/08/2008: sts (Ausgabe Seitenumbruch)' Geändert : 09/09/2010: hb  (Korrektur Berechnung Verkerhszahl, Ausgabe Kontonummer in Saldenzeile)' Geändert : 25/01/2011: sts (Datum ohne Jahr)' Geändert : 14.11.2013: sts (Spaltenbreite für Steuersatz angepasst, Kontobezeichnung bei Saldenzeile entfernt)' Geändert : 26.02.2014: sts (Ausgabe für Kontostand "0,00")' Geändert : 27.01.2015: sts (mehrzeilige Ausgabe der Filterinformation)' Geändert : 04.07.2016: sts (Ausgabe Datum mit Jahr, Spalte Nummer entfernt, Einzeilige Ausgabe steuerbar über Konstante)' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text      = "Kontoauszug in " + App_GJWaehrungconst HEAD_HEIGHT as number = 330const EINZEILIG as boolean  = FALSE' Globale Variablen definierendim sumSoll         as numberdim sumHaben        as numberdim sumSaldo        as numberdim newHeight       as number = 0dim konto           as textdim FORMATSALDONULL as text = "###,###,###,###.00\ \S;###,###,###,###..00\ \H;0.00"dim row             as number = 0' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"' Variablen für die Positionen der 8 Spaltendim anzahlSpalten as number = 8dim s1 as number = 0dim s2 as number = 170dim s3 as number = 400dim s4 as number = 740dim s5 as number = 890dim s6 as number = 1095dim s7 as number = 1300dim s8 as number = 1520dim s9 as number = LAYOUTWIDTH' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(KA_Filter, 0, 150, LAYOUTWIDTH, 150)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("Kontoauszug")DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText("Datum", l1, 5, b1, 40)DrawVerticalLine(s2)DrawText("Beleg", l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Buchungstext", l3, 5, b3, 40)DrawVerticalLine(s4)DrawText("Gegen- konto", l4, 5, b4, 80)DrawVerticalLine(s5)DrawText("Betrag", l5, 5, s7-s5, 40)DrawText("Soll", l5, 45, b5, 40)DrawText("Haben", l6, 45, b6, 40)DrawVerticalLine(s7)DrawText("Steuer", l7, 5, b7, 40)DrawVerticalLine(s8)DrawText("Saldo", l8, 5, b8, 40)DrawVerticalLine(s9)'---------------------------------------------------------BeginTableRow-----#BeginTableRowif ( EINZEILIG )SetArea(40)elseSetArea(300, AREA_AUTOSIZE)endif#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 0 )FillAreaVertical(0, LAYOUTWIDTH)endifendifif( KA_Zeilenart = KA_Kopfzeile )set konto to NthField(KA_Text, " ", 1)DrawLine(s1, 0, s9, 0)SetTextSize(10)SetTextBold(true)DrawText(KA_Text, l1, 80, s9-s1, 50)SetTextSize(8)DrawLine(s1, 125, s9, 125)set sumSoll to 0set sumHaben to 0set sumSaldo to 0endifif( KA_Zeilenart = KA_Eröffnungsbuchung OR KA_Zeilenart = KA_Übertragszeile )DrawLine(s1, 0, s9, 0)SetTextBold(true)DrawVerticalLine(s1)DrawText(KA_Text, l1, 5, s9-s5, 40)DrawVerticalLine(s5)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawVerticalLine(s8)set sumSaldo to KA_SaldoDrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)endifif( KA_Zeilenart = KA_Journalzeile )DrawLine(s1, 0, s9, 0)DrawVerticalLine(s1)DrawText(ShortDate(KA_Datum), l1, 5, b1, 35)DrawVerticalLine(s2)DrawText(KA_BelegNr, l2, 5, b2, 160, ALIGN_LEFT)DrawVerticalLine(s3)DrawText(KA_Text, l3, 5, b3, 300)DrawVerticalLine(s4)DrawText(Format(KA_Gegenkonto, FORMATKONTO), l4, 5, b4, 40, ALIGN_RIGHT)DrawVerticalLine(s5)DrawText(Format(KA_BetragSoll, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)set sumSoll to sumSoll + KA_BetragSollDrawVerticalLine(s6)DrawText(Format(KA_BetragHaben, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)set sumHaben to sumHaben + KA_BetragHabenDrawVerticalLine(s7)DrawText(KA_Steuersatz, l7, 5, b7, 160, ALIGN_CENTER)DrawVerticalLine(s8)DrawText(Format(KA_Saldo, User_ListFormat + ";0.00"), l8, 5, b8, 40, ALIGN_RIGHT)set sumSaldo to KA_SaldoDrawVerticalLine(s9)endifPageBreak(KA_FolgendeZeilenart=KA_Kopfzeile)'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(41)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s9, 0)DrawLine(s1, 40, s9, 40)DrawLine(s1, 0, s1, 40)DrawText("Verkehrszahlen/Saldo Konto: " + konto, l1, 5, s5-s1-20, 40, ALIGN_LEFT)DrawLine(s5, 0, s5, 40)DrawText(Format(sumSoll, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawLine(s6, 0, s6, 40)DrawText(Format(sumHaben, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawLine(s7, 0, s7, 40)DrawLine(s8, 0, s8, 40)DrawText(Format(sumSaldo, FORMATSALDONULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawLine(s9, 0, s9, 40)SetTextBold(false)#BeginTableFooterSetArea(41)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s9, 0)DrawLine(s1, 40, s9, 40)DrawVerticalLine(s1)DrawText("Verkehrszahlen/Saldo Konto: " + konto, l1, 5, s5-s1-20, 40, ALIGN_LEFT)DrawVerticalLine(s5)DrawText(Format(sumSoll, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawVerticalLine(s6)DrawText(Format(sumHaben, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawVerticalLine(s7)DrawVerticalLine(s8)DrawText(Format(sumSaldo, FORMATSALDONULL), l8, 5, b8, 40, ALIGN_RIGHT)DrawVerticalLine(s9)SetTextBold(false)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'Kontoauszug'' -----------------------------------------------------------------------------------------0000011