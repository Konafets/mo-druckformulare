00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000039OP-Kontoauszug A4 quer mit Fremdwährung0000042017000004true000004true00000100000010000049OP-Kontoauszug im Format A4 quer mit Fremdwährung006833' -----------------------------------------------------------------------------------------'' Formular : OP-Kontoauszug im Format A4 hoch' Historie : 30/07/2008: Initialversion sts' Geändert : 21.12.2016: hb  (Alternierender Zeilenhintergrund über Schalter "ALT_ZEILENHINTERGRUND" möglich)'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "OP-Kontoauszug in " + App_GJWaehrung + " mit Fremdwährung"' ********************************************************************************' Über die folgenden Konstante lässt sich die Darstellung einer alternierenden' Hintergrundfarbe einstellen (TRUE = Element sichtbar, FALSE = Element nicht sichtbar)const ALT_ZEILENHINTERGRUND as boolean = FALSE' ********************************************************************************' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 quer"' Variablen für die Positionen der 12 Spaltendim anzahlSpalten as number = 12dim s1 as number = 0dim s2 as number = 170dim s3 as number = 380dim s4 as number = 790dim s5 as number = 995dim s6 as number = 1200dim s7 as number = 1405dim s8 as number = 1610dim s9 as number = 1815dim s10 as number = 2020dim s11 as number = 2225dim s12 as number = 2430dim s13 as number = LAYOUTWIDTH' Variablen definierendim row            as number = 0dim summeRechnung  as number = 0dim summeZahlung   as number = 0dim summeMinderung as number = 0dim summeSaldo     as number = 0#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"DrawText(PA_Filter, 0, 150, LAYOUTWIDTH, 50)'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"' -----------------------------------------------------------------------------------------' Beginn der Tabelle 'OPKontoauszug'' -----------------------------------------------------------------------------------------#BeginTableHeaderSetArea(80)#include "STYLE Arial 8, fett"SetTextAlignment(ALIGN_CENTER)SetCurrentTable("OPKontoauszug")DrawLine(s1, 0, s13, 0)DrawVerticalLine(s1)DrawText("Datum", l1, 5, b1, 40, ALIGN_CENTER)DrawVerticalLine(s2)DrawText("Re.-Nr.", l2, 5, b2, 40, ALIGN_CENTER)DrawVerticalLine(s3)DrawText("Text", l3, 5, b3, 40, ALIGN_CENTER)DrawVerticalLine(s4)DrawText(App_GJWaehrung, l4, 5, l8-l4, 40, ALIGN_CENTER)DrawText("Rechnung", l4, 40, b4, 40, ALIGN_CENTER)DrawText("Zahlung", l5, 40, b5, 40, ALIGN_CENTER)DrawText("Minderung", l6, 40, b6, 40, ALIGN_CENTER)DrawText("Saldo", l7, 40, b7, 40, ALIGN_CENTER)DrawVerticalLine(s8)DrawText("Fremdwährung", l8, 5, l12-l8, 40, ALIGN_CENTER)DrawText("Rechnung", l8, 40, b8, 80, ALIGN_CENTER)DrawText("Zahlung", l9, 40, b9, 80, ALIGN_CENTER)DrawText("Minderung", l10, 40, b10, 80, ALIGN_CENTER)DrawText("Saldo", l11, 40, b11, 80, ALIGN_CENTER)DrawVerticalLine(s12)DrawText("Währung", l12, 5, b12, 40, ALIGN_CENTER)DrawVerticalLine(s13)'---------------------------------------------------------BeginTableRow-----#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 8, normal"if (ALT_ZEILENHINTERGRUND)SetFillColor(RGBColor(230, 230, 230))set row to row + 1if ( Mod(row, 2) = 1 )FillAreaVertical(0, LAYOUTWIDTH)endifendifDrawVerticalLine(s1)DrawVerticalLine(s4)DrawVerticalLine(s8)DrawVerticalLine(s13)'---------------------------------------------------------Vortragszeile-----if( PA_Zeilenart = PA_Vortragszeile )SetTextBold(true)DrawText(PA_Text, l1, 5, s4-s1, 40)DrawText(Format(PA_BetragSaldoSW, FORMATBETRAGNULL), l7, 5, b7, 40, ALIGN_RIGHT)DrawLine(s1, 0, s13, 0)'---------------------------------------------------------Positionszeilen---elseDrawVerticalLine(s5)DrawVerticalLine(s6)DrawVerticalLine(s7)if( PA_Zeilenart =  PA_Positionszeile )DrawLine(s1, 0, s13, 0)DrawText(DateToText(PA_Datum), l1, 5, b1, 40, ALIGN_CENTER)DrawText(PA_RechnungsNr, l2, 5, b2, 40, ALIGN_LEFT)DrawText(PA_Text, l3, 5, b3, 190, ALIGN_LEFT)DrawText(Format(PA_BetragRechnungSW, FORMATBETRAGLEER), l4, 5, b4, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragZahlungSW, FORMATBETRAGLEER), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragMinderungSW, FORMATBETRAGLEER), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(IfThen(PA_Waehrung<>App_GJWaehrung, PA_BetragMinderungFW, 0), FORMATBETRAGLEER), l10, 5, b10, 40, ALIGN_RIGHT)DrawText(Format(IfThen(PA_Waehrung<>App_GJWaehrung, PA_BetragSaldoFW, 0), FORMATBETRAGLEER), l11, 5, b11, 40, ALIGN_RIGHT)DrawText(Format(IfThen(PA_Waehrung<>App_GJWaehrung, PA_BetragRechnungFW, 0), FORMATBETRAGLEER), l8, 5, b8, 40, ALIGN_RIGHT)DrawText(Format(IfThen(PA_Waehrung<>App_GJWaehrung, PA_BetragZahlungFW, 0), FORMATBETRAGLEER), l9, 5, b9, 40, ALIGN_RIGHT)DrawVerticalLine(s2)DrawVerticalLine(s3)DrawVerticalLine(s9)DrawVerticalLine(s10)DrawVerticalLine(s11)DrawVerticalLine(s12)elseif( PA_Zeilenart = PA_Summenzeile )DrawLine(s1, 0, s13, 0)SetTextBold(true)DrawText(PA_Text, l1, 5, s4-s1, 50)DrawText(Format(PA_BetragRechnungSW, FORMATBETRAGNULL), l4, 5, b4, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragZahlungSW, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(PA_BetragMinderungSW, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)endifendifDrawText(Format(PA_BetragSaldoSW, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)endifDrawText(IfThen(PA_Waehrung<>App_GJWaehrung, PA_Waehrung, ""), l12, 5, b12, 40, ALIGN_CENTER)set summeRechnung To summeRechnung + PA_BetragRechnungSWset summeZahlung To summeZahlung + PA_BetragZahlungSWset summeMinderung To summeMinderung + PA_BetragMinderungSWset summeSaldo To PA_BetragSaldoSW'-------------------------------------------------------BeginTableBreak---#BeginTableBreakSetArea(42)#include "STYLE Arial 8, fett"DrawLine(s1, 0, s1, 40)DrawLine(s4, 0, s4, 40)DrawLine(s5, 0, s5, 40)DrawLine(s6, 0, s6, 40)DrawLine(s7, 0, s7, 40)DrawLine(s8, 0, s8, 40)DrawLine(s13, 0, s13, 40)DrawLine(s1, 0, s13, 0)DrawLine(s1, 40, s13, 40)SetTextBold(true)DrawText("Zwischensumme:", l1, 5, s4-s1, 50)DrawText(Format(summeRechnung, FORMATBETRAGNULL), l4, 5, b4, 40, ALIGN_RIGHT)DrawText(Format(summeZahlung, FORMATBETRAGNULL), l5, 5, b5, 40, ALIGN_RIGHT)DrawText(Format(summeMinderung, FORMATBETRAGNULL), l6, 5, b6, 40, ALIGN_RIGHT)DrawText(Format(summeSaldo, FORMATBETRAGLEER), l7, 5, b7, 40, ALIGN_RIGHT)#BeginTableFooterSetArea(10)DrawLine(s1, 0, s13, 0)' -----------------------------------------------------------------------------------------' Ende der Tabelle 'OPKontoauszug'' -----------------------------------------------------------------------------------------0000012