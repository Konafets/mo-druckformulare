00068000003000022MonKey Bilanz Formular00001917.2.3 (Build 1726)000003002000009000039ELSTER-Versand E-Bilanz-Zusammenfassung0000042028000004true000004true00000100000010000028Zusammenfassung der E-Bilanz004149' -----------------------------------------------------------------------------------------'' Formular : Zusammenfassung E-Bilanz im Format A4 hoch' Historie : 15.11.2018: Initialversion sts' Geändert :'' -----------------------------------------------------------------------------------------#BeginDocument' Globale Konstanten definierenconst DOCTITEL as text = "ELSTER-Versand (E-Bilanz Zusammenfassung)"' Templates für Randeinstellungen, Kopf- und Fusszeilen#include "TEMPLATE BeginDocument A4 hoch"dim bereich as number = 0dim typ as textdim delta as number = 100' Variablen für die Positionen der 3 Spaltendim firstTime as boolean = truedim anzahlSpalten as number = 3dim s1 as number = 0dim s2 as number = 250dim s3 as number = 500dim s4 as number = LAYOUTWIDTHdim s5 as number = 800#include "TEMPLATE Table"'---------------------------------------------------------BeginHeader--------#BeginHeader#include "TEMPLATE BeginHeader A4"'----------------------------------------------------------BeginFooter--------#BeginFooter#include "TEMPLATE BeginFooter A4"'-----------------------------------------------------------------------------------------' Beginn der Tabelle 'E-Bilanz Zusammenfassung'' -----------------------------------------------------------------------------------------set s1 to 10set s2 to 1000set s3 to LAYOUTWIDTHset anzahlspalten to 2#include "TEMPLATE Table"#BeginTableHeaderExitTable(not HasTable("E-Bilanz Zusammenfassung"))SetCurrentTable("E-Bilanz Zusammenfassung")#BeginTableRowSetArea(300, AREA_AUTOSIZE)#include "STYLE Arial 9, normal"if(EBilanz_Gruppe AND EBilanz_EbeneNr = 1)SetTextBold(true)SetTextSize(10)DrawText(EBilanz_Position, l1, 0, b1, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 0, b2, 50, ALIGN_RIGHT)elseif(EBilanz_Gruppe AND EBilanz_EbeneNr = 2 )SetTextBold(false)SetTextSize(10)DrawText(EBilanz_Position, l1+delta, 20, b1-1*delta, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 20, b2-delta, 50, ALIGN_RIGHT)elseif(EBilanz_Gruppe AND EBilanz_EbeneNr = 3 AND NOT EBilanz_Bilanzergebnis)SetTextBold(true)SetTextSize(8)DrawText(EBilanz_Position, s1+2*delta, 20, b1-2*delta, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 20, b2-2*delta, 40, ALIGN_RIGHT)elseif(EBilanz_Gruppe AND EBilanz_EbeneNr = 4 AND NOT EBilanz_Bilanzergebnis)SetTextBold(false)SetTextSize(8)DrawText(EBilanz_Position, s1+3*delta, 20, b1-3*delta, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 20, b2-3*delta, 40, ALIGN_RIGHT)elseif(EBilanz_Konto)SetTextBold(false)SetTextSize(7)DrawText(EBilanz_Position, s1+4*delta, 0, b1-4*delta, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 0, b2-4*delta, 40, ALIGN_RIGHT)elseif(EBilanz_Gcd)SetTextBold(false)SetTextSize(10)DrawText(EBilanz_Position, l1+delta, 20, b1-1*delta, 300)DrawText(EBilanz_Value, l2, 20, b2-delta, 50, ALIGN_RIGHT)elseif(EBilanz_Bilanzergebnis and EBilanz_Rechtsform = "EU")SetTextBold(true)SetTextSize(7)DrawText(EBilanz_Position, s1+4*delta, 0, b1-4*delta, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 0, b2-4*delta, 40, ALIGN_RIGHT)elseif(EBilanz_Bilanzergebnis and (EBilanz_Rechtsform = "PG" or EBilanz_Rechtsform = "KST"))SetTextBold(true)SetTextSize(8)DrawText(EBilanz_Position, s1+3*delta, 20, b1-3*delta, 300)DrawText(Format(EBilanz_Saldo, FORMATBETRAGLEER), l2, 20, b2-3*delta, 40, ALIGN_RIGHT)endifif ( EBilanz_EbeneNr <> 0 AND EBilanz_FolgendeEbeneNr=1)if (headline = "Bilanz in " + App_GJWaehrung)set headline to "Gewinn- und Verlustrechnung in " + App_GJWaehrungendifif (headline = "Allgemeine Informationen")set headline to "Weitere Informationen"endifPageBreak(true)endifif (EBilanz_FolgenderElementTyp = "GCD" and firstTime)set headline to "Allgemeine Informationen"PageBreak(true)set firstTime to falseendif#BeginTableBreak#BeginTableFooter' -----------------------------------------------------------------------------------------' 'E-Bilanz Zusammenfassung'' -----------------------------------------------------------------------------------------0000011